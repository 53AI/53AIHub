import{an as Ae,ay as X,I as Ie,aX as K,bZ as Le,J as ve,d as ae,bO as we,cj as Pe,ck as Ve,W as ze,V as Se,cl as Be,r as k,cm as Me,M as Xe,c as m,L as me,aG as Ee,e as _e,bA as Y,i as w,s as pe,w as p,n as d,Y as Ye,m as y,B as v,k as e,a0 as be,bv as De,C as Fe,l as I,E as T,ax as He,j as N,F as ee,X as je,Z as We,$,p as qe,t as Ne,cn as Ke,co as Ze,H as Ge,cp as Je,bm as Qe,A as Ue,q as ea,y as aa,bx as ta,a1 as Oe,aS as M,cq as sa,a4 as Re,cr as na,cs as oa,ct as la,az as ra,bw as ye,bC as ke,bD as Ce,aA as ia,Q as ca,cu as ua,cv as da,aa as fa}from"./main-A2Vq01lO.js";import{d as va}from"./enterprise-E8x0ss4L.js";var ma="Expected a function";function fe(l,L,r){var s=!0,o=!0;if(typeof l!="function")throw new TypeError(ma);return Ae(r)&&(s="leading"in r?!!r.leading:s,o="trailing"in r?!!r.trailing:o),va(l,L,{leading:s,maxWait:L,trailing:o})}const pa=(l,L)=>{if(!X||!l||!L)return!1;const r=l.getBoundingClientRect();let s;return L instanceof Element?s=L.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},r.top<s.bottom&&r.bottom>s.top&&r.right>s.left&&r.left<s.right},ga=Ie({urlList:{type:K(Array),default:()=>Le([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:K(String)}}),ha={close:()=>!0,switch:l=>ve(l),rotate:l=>ve(l)},wa=ae({name:"ElImageViewer"}),ba=ae({...wa,props:ga,emits:ha,setup(l,{expose:L,emit:r}){var s;const o=l,g={CONTAIN:{name:"contain",icon:we(Pe)},ORIGINAL:{name:"original",icon:we(Ve)}};let D,F="";const{t:te}=ze(),n=Se("image-viewer"),{nextZIndex:A}=Be(),z=k(),B=k([]),P=Me(),f=k(!0),h=k(o.initialIndex),O=Xe(g.CONTAIN),c=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),se=k((s=o.zIndex)!=null?s:A()),H=m(()=>{const{urlList:a}=o;return a.length<=1}),Z=m(()=>h.value===0),j=m(()=>h.value===o.urlList.length-1),W=m(()=>o.urlList[h.value]),ne=m(()=>[n.e("btn"),n.e("prev"),n.is("disabled",!o.infinite&&Z.value)]),oe=m(()=>[n.e("btn"),n.e("next"),n.is("disabled",!o.infinite&&j.value)]),G=m(()=>{const{scale:a,deg:u,offsetX:i,offsetY:C,enableTransition:E}=c.value;let _=i/a,x=C/a;const q=u*Math.PI/180,ge=Math.cos(q),he=Math.sin(q);_=_*ge+x*he,x=x*ge-i/a*he;const de={transform:`scale(${a}) rotate(${u}deg) translate(${_}px, ${x}px)`,transition:E?"transform .3s":""};return O.value.name===g.CONTAIN.name&&(de.maxWidth=de.maxHeight="100%"),de}),J=m(()=>`${h.value+1} / ${o.urlList.length}`);function V(){U(),D==null||D(),document.body.style.overflow=F,r("close")}function Q(){const a=fe(i=>{switch(i.code){case M.esc:o.closeOnPressEscape&&V();break;case M.space:S();break;case M.left:ce();break;case M.up:R("zoomIn");break;case M.right:ue();break;case M.down:R("zoomOut");break}}),u=fe(i=>{const C=i.deltaY||i.deltaX;R(C<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});P.run(()=>{Y(document,"keydown",a),Y(document,"wheel",u)})}function U(){P.stop()}function le(){f.value=!1}function re(a){f.value=!1,a.target.alt=te("el.image.error")}function t(a){if(f.value||a.button!==0||!z.value)return;c.value.enableTransition=!1;const{offsetX:u,offsetY:i}=c.value,C=a.pageX,E=a.pageY,_=fe(q=>{c.value={...c.value,offsetX:u+q.pageX-C,offsetY:i+q.pageY-E}}),x=Y(document,"mousemove",_);Y(document,"mouseup",()=>{x()}),a.preventDefault()}function b(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function S(){if(f.value)return;const a=sa(g),u=Object.values(g),i=O.value.name,E=(u.findIndex(_=>_.name===i)+1)%a.length;O.value=g[a[E]],b()}function ie(a){const u=o.urlList.length;h.value=(a+u)%u}function ce(){Z.value&&!o.infinite||ie(h.value-1)}function ue(){j.value&&!o.infinite||ie(h.value+1)}function R(a,u={}){if(f.value)return;const{minScale:i,maxScale:C}=o,{zoomRate:E,rotateDeg:_,enableTransition:x}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(a){case"zoomOut":c.value.scale>i&&(c.value.scale=Number.parseFloat((c.value.scale/E).toFixed(3)));break;case"zoomIn":c.value.scale<C&&(c.value.scale=Number.parseFloat((c.value.scale*E).toFixed(3)));break;case"clockwise":c.value.deg+=_,r("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=_,r("rotate",c.value.deg);break}c.value.enableTransition=x}function xe(a){var u;((u=a.detail)==null?void 0:u.focusReason)==="pointer"&&a.preventDefault()}function Te(){o.closeOnPressEscape&&V()}function $e(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}return me(W,()=>{Ee(()=>{const a=B.value[0];a!=null&&a.complete||(f.value=!0)})}),me(h,a=>{b(),r("switch",a)}),_e(()=>{Q(),D=Y("wheel",$e,{passive:!1}),F=document.body.style.overflow,document.body.style.overflow="hidden"}),L({setActiveItem:ie}),(a,u)=>(w(),pe(e(ta),{to:"body",disabled:!a.teleported},{default:p(()=>[d(Ye,{name:"viewer-fade",appear:""},{default:p(()=>[y("div",{ref_key:"wrapper",ref:z,tabindex:-1,class:v(e(n).e("wrapper")),style:be({zIndex:se.value})},[d(e(De),{loop:"",trapped:"","focus-trap-el":z.value,"focus-start-el":"container",onFocusoutPrevented:xe,onReleaseRequested:Te},{default:p(()=>[y("div",{class:v(e(n).e("mask")),onClick:Fe(i=>a.hideOnClickModal&&V(),["self"])},null,10,["onClick"]),I(" CLOSE "),y("span",{class:v([e(n).e("btn"),e(n).e("close")]),onClick:V},[d(e(T),null,{default:p(()=>[d(e(He))]),_:1})],2),I(" ARROW "),e(H)?I("v-if",!0):(w(),N(ee,{key:0},[y("span",{class:v(e(ne)),onClick:ce},[d(e(T),null,{default:p(()=>[d(e(je))]),_:1})],2),y("span",{class:v(e(oe)),onClick:ue},[d(e(T),null,{default:p(()=>[d(e(We))]),_:1})],2)],64)),a.showProgress?(w(),N("div",{key:1,class:v([e(n).e("btn"),e(n).e("progress")])},[$(a.$slots,"progress",{activeIndex:h.value,total:a.urlList.length},()=>[qe(Ne(e(J)),1)])],2)):I("v-if",!0),I(" ACTIONS "),y("div",{class:v([e(n).e("btn"),e(n).e("actions")])},[y("div",{class:v(e(n).e("actions__inner"))},[$(a.$slots,"toolbar",{actions:R,prev:ce,next:ue,reset:S,activeIndex:h.value},()=>[d(e(T),{onClick:i=>R("zoomOut")},{default:p(()=>[d(e(Ke))]),_:1},8,["onClick"]),d(e(T),{onClick:i=>R("zoomIn")},{default:p(()=>[d(e(Ze))]),_:1},8,["onClick"]),y("i",{class:v(e(n).e("actions__divider"))},null,2),d(e(T),{onClick:S},{default:p(()=>[(w(),pe(Ge(e(O).icon)))]),_:1}),y("i",{class:v(e(n).e("actions__divider"))},null,2),d(e(T),{onClick:i=>R("anticlockwise")},{default:p(()=>[d(e(Je))]),_:1},8,["onClick"]),d(e(T),{onClick:i=>R("clockwise")},{default:p(()=>[d(e(Qe))]),_:1},8,["onClick"])])],2)],2),I(" CANVAS "),y("div",{class:v(e(n).e("canvas"))},[(w(!0),N(ee,null,Ue(a.urlList,(i,C)=>ea((w(),N("img",{ref_for:!0,ref:E=>B.value[C]=E,key:i,src:i,style:be(e(G)),class:v(e(n).e("img")),crossorigin:a.crossorigin,onLoad:le,onError:re,onMousedown:t},null,46,["src","crossorigin"])),[[aa,C===h.value]])),128))],2),$(a.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var ya=Oe(ba,[["__file","image-viewer.vue"]]);const ka=Re(ya),Ca=Ie({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:K([String,Object])},previewSrcList:{type:K(Array),default:()=>Le([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:K(String)}}),Ia={load:l=>l instanceof Event,error:l=>l instanceof Event,switch:l=>ve(l),close:()=>!0,show:()=>!0},La=ae({name:"ElImage",inheritAttrs:!1}),za=ae({...La,props:Ca,emits:Ia,setup(l,{expose:L,emit:r}){const s=l,{t:o}=ze(),g=Se("image"),D=na(),F=m(()=>oa(Object.entries(D).filter(([t])=>/^(data-|on[A-Z])/i.test(t)||["id","style"].includes(t)))),te=la({excludeListeners:!0,excludeKeys:m(()=>Object.keys(F.value))}),n=k(),A=k(!1),z=k(!0),B=k(!1),P=k(),f=k(),h=X&&"loading"in HTMLImageElement.prototype;let O;const c=m(()=>[g.e("inner"),H.value&&g.e("preview"),z.value&&g.is("loading")]),se=m(()=>{const{fit:t}=s;return X&&t?{objectFit:t}:{}}),H=m(()=>{const{previewSrcList:t}=s;return ra(t)&&t.length>0}),Z=m(()=>{const{previewSrcList:t,initialIndex:b}=s;let S=b;return b>t.length-1&&(S=0),S}),j=m(()=>s.loading==="eager"?!1:!h&&s.loading==="lazy"||s.lazy),W=()=>{X&&(z.value=!0,A.value=!1,n.value=s.src)};function ne(t){z.value=!1,A.value=!1,r("load",t)}function oe(t){z.value=!1,A.value=!0,r("error",t)}function G(){pa(P.value,f.value)&&(W(),Q())}const J=da(G,200,!0);async function V(){var t;if(!X)return;await Ee();const{scrollContainer:b}=s;ia(b)?f.value=b:ca(b)&&b!==""?f.value=(t=document.querySelector(b))!=null?t:void 0:P.value&&(f.value=ua(P.value)),f.value&&(O=Y(f,"scroll",J),setTimeout(()=>G(),100))}function Q(){!X||!f.value||!J||(O==null||O(),f.value=void 0)}function U(){H.value&&(B.value=!0,r("show"))}function le(){B.value=!1,r("close")}function re(t){r("switch",t)}return me(()=>s.src,()=>{j.value?(z.value=!0,A.value=!1,Q(),V()):W()}),_e(()=>{j.value?V():W()}),L({showPreview:U}),(t,b)=>(w(),N("div",ye({ref_key:"container",ref:P},e(F),{class:[e(g).b(),t.$attrs.class]}),[A.value?$(t.$slots,"error",{key:0},()=>[y("div",{class:v(e(g).e("error"))},Ne(e(o)("el.image.error")),3)]):(w(),N(ee,{key:1},[n.value!==void 0?(w(),N("img",ye({key:0},e(te),{src:n.value,loading:t.loading,style:e(se),class:e(c),crossorigin:t.crossorigin,onClick:U,onLoad:ne,onError:oe}),null,16,["src","loading","crossorigin"])):I("v-if",!0),z.value?(w(),N("div",{key:1,class:v(e(g).e("wrapper"))},[$(t.$slots,"placeholder",{},()=>[y("div",{class:v(e(g).e("placeholder"))},null,2)])],2)):I("v-if",!0)],64)),e(H)?(w(),N(ee,{key:2},[B.value?(w(),pe(e(ka),{key:0,"z-index":t.zIndex,"initial-index":e(Z),infinite:t.infinite,"zoom-rate":t.zoomRate,"min-scale":t.minScale,"max-scale":t.maxScale,"show-progress":t.showProgress,"url-list":t.previewSrcList,crossorigin:t.crossorigin,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:le,onSwitch:re},{progress:p(S=>[$(t.$slots,"progress",ke(Ce(S)))]),toolbar:p(S=>[$(t.$slots,"toolbar",ke(Ce(S)))]),default:p(()=>[t.$slots.viewer?(w(),N("div",{key:0},[$(t.$slots,"viewer")])):I("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):I("v-if",!0)],64)):I("v-if",!0)],16))}});var Sa=Oe(za,[["__file","image.vue"]]);const Na=Re(Sa),Oa=fa("global",{state:()=>({siderVisible:!0,siderCollapsed:!1}),getters:{},actions:{toggleSider(){this.siderVisible=!this.siderVisible,this.siderVisible&&(this.siderCollapsed=!1)},hoverSider(l){this.siderVisible||(this.siderCollapsed=l)}}});export{Na as E,fe as t,Oa as u};
