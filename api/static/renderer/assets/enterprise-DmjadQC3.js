import{ai as c,aj as m,N as h}from"./main-BBgPs3nN.js";const g={current(){return c.get("/api/enterprises/current").catch(m)},get(e){return c.get(`/api/enterprises/${e}`).catch(m)}},r=window.$getPublicPath("/images/default_logo.png"),E=h("enterprise-store",{state:()=>({logo:r,ico:r,display_name:"",language:"zh-cn",copyright:"",keywords:[],description:"",banner_info:{url_list:[],interval:""},template_style_info:{},is_independent:!1,is_enterprise:!1,is_industry:!1}),actions:{initTemplateStyle(){let{theme_color:e,text_color:t,nav_bg_color:o,nav_text_color:n,page_footer_bg_color:s,page_footer_text_color:i}=this.template_style_info;e=e||"#2563eb",t=t||"#333333",o=o||"#ffffff",n=n||"#333333",s=s||"#18191f",i=i||"#f2f2f2",document.documentElement.style.setProperty("--el-color-primary",e),document.documentElement.style.setProperty("--el-color-primary-light-3",e+"cc"),document.documentElement.style.setProperty("--el-color-primary-light-5",e+"aa"),document.documentElement.style.setProperty("--el-color-primary-light-7",e+"99"),document.documentElement.style.setProperty("--el-color-primary-light-8",e+"66"),document.documentElement.style.setProperty("--el-color-primary-light-9",e+"33"),document.documentElement.style.setProperty("--el-text-color-primary",t),document.documentElement.style.setProperty("--el-text-color-regular",t+"cc"),document.documentElement.style.setProperty("--el-text-color-secondary",t+"99"),document.documentElement.style.setProperty("--el-text-color-placeholder",t+"66"),document.documentElement.style.setProperty("--el-color-nav-bg",o),document.documentElement.style.setProperty("--el-color-nav-text",n),document.documentElement.style.setProperty("--el-color-page-footer-bg",s),document.documentElement.style.setProperty("--el-color-page-footer-text",i)},setMetaDescription(e=""){if(this.description=e,!e)return;const t=document.querySelector('meta[name="description"]');if(t)t.setAttribute("content",e);else{const o=document.createElement("meta");o.setAttribute("name","description"),o.setAttribute("content",e),document.head.appendChild(o)}},setMetaKeywords(e=[]){if(this.keywords=e,!e.length)return;const t=document.querySelector('meta[name="keywords"]');if(t)t.setAttribute("content",e.join(", "));else{const o=document.createElement("meta");o.setAttribute("name","keywords"),o.setAttribute("content",e.join(", ")),document.head.appendChild(o)}},setDocumentTitleAndIcon(e,t){document.title=e;const o=document.querySelector('link[rel="icon"]')||document.createElement("link");o.rel="icon",o.href=t||r,document.querySelector('link[rel="icon"]')||document.head.appendChild(o)},setAppLanguage(e){const t=e==="En"?"en":e;this.language=t},saveToStorage(){localStorage.setItem("enterprise",JSON.stringify({logo:this.logo,display_name:this.display_name,language:this.language}))},async loadFromStorage(){const e=localStorage.getItem("enterprise");if(e)try{const t=JSON.parse(e);this.logo=t.logo||r,this.display_name=t.display_name,this.language=t.language,this.setDocumentTitleAndIcon(t.display_name,t.logo),this.setAppLanguage(t.language)}catch(t){console.error("解析localStorage中的企业信息失败",t)}return this},async loadInfo(){try{const e=await g.current(),{display_name:t,logo:o,language:n,copyright:s,ico:i,keywords:p,description:d,banner:y,template_type:u,type:l}=e.data.enterprise;this.logo=o||r,this.ico=i||this.logo||r,this.display_name=t,this.copyright=s,this.description=d||"",this.is_independent=l==="independent",this.is_enterprise=l==="enterprise",this.is_industry=l==="industry",!this.is_independent&&!this.is_enterprise&&!this.is_industry&&(this.is_independent=!0);try{this.keywords=JSON.parse(p||"[]")}catch{this.keywords=[]}try{this.banner_info=JSON.parse(y||"{}")}catch{this.banner_info={url_list:[],interval:""}}try{this.template_style_info=JSON.parse(u||"{}")}catch{this.template_style_info={}}["website","software"].includes(this.template_style_info.style_type)||(this.template_style_info.style_type="website"),window.innerWidth<768&&(this.template_style_info.style_type="software"),this.setAppLanguage(n),this.setDocumentTitleAndIcon(t,this.ico),this.setMetaKeywords(this.keywords),this.setMetaDescription(this.description),this.saveToStorage(),this.initTemplateStyle()}catch(e){console.error("获取企业信息失败",e)}finally{return this}}}});export{E as useEnterpriseStore};
