import{ce as no,cf as Pt,cg as ao,ch as zt,ci as Nt,cj as Bt,ck as Xt,cl as Ke,cm as ro,cn as nt,co as Yt,bv as co,cp as uo,cq as Jt,cr as es,cs as be,ct as po,cu as ho,cv as fo,aU as dt,aw as mo,az as $e,B as K,c1 as pt,aY as we,G as W,c as T,h as H,b as y,d as p,e as P,q,p as L,u as w,w as g,f as m,bd as at,s as D,Y as Q,J as Z,T as vo,a_ as ht,aa as go,r as R,bn as ge,N as Qe,c2 as he,aS as _e,bV as bo,am as ne,b2 as ft,k as U,m as We,t as E,aI as ts,aN as mt,E as se,aK as wo,n as le,o as Se,b1 as yo,cw as _o,cx as Co,cy as ss,cz as os,cA as $o,x as me,cB as So,aT as De,cC as Ft,cD as is,z as xo,aX as Ge,i as Oo,aO as ke,cE as Eo,cF as Io,bs as ce,ay as ko,cG as Le,aP as qe,cH as ls,cI as Vo,aV as Ve,cJ as To,$ as ns,aW as Ce,bP as Mo,bY as Ao,cK as Wo,H as ie,W as de,F as J,K as Ze,a0 as N,aA as ue,cL as Lo,au as fe,cM as Ro,Z as vt,c0 as Ho,av as as,cN as Po,b3 as rs,cO as je,cP as rt,cQ as zo,aZ as No,aG as Bo,cR as Dt,bm as Xo,a1 as ae,M as ve,cS as cs,cT as Re,cU as He,as as gt,a5 as oe,cV as Te,cW as us,cX as ds,cY as Yo,cZ as Fo,c_ as Do,bF as Uo,bi as Ko,A as bt,C as Pe,c$ as ps,d0 as hs,d1 as Me,d2 as ct,d3 as Ut,d4 as fs,ag as Go,a8 as qo}from"./main-rMrzitnj.js";import{e as jo,E as Qo,a as Zo}from"./el-tab-pane-CWT3dWDV.js";import{_ as Jo}from"./header.vue_vue_type_script_setup_true_lang-DPdmbbEj.js";import{useEnterpriseStore as ei}from"./enterprise-KlloCPVp.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{u as wt,_ as ms}from"./browser-setting-aY73Yrll.js";import{i as ti,E as si}from"./index-Bm6Us-tl.js";import{E as oi,a as ii,b as li}from"./el-dropdown-item-BnWnA72a.js";import{d as ni}from"./el-image-viewer-DTkaUA3n.js";import{C as ai}from"./index-DS7QZFHc.js";import{u as ri,E as Kt}from"./upload-GPSY5QUJ.js";import"./index-CKGd0eSL.js";import"./global-CvDIHAI-.js";function ci(e,t,i,s){e.length;for(var l=i+1;l--;)if(t(e[l],l,e))return l;return-1}var ui="__lodash_hash_undefined__";function di(e){return this.__data__.set(e,ui),this}function pi(e){return this.__data__.has(e)}function Je(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new no;++t<i;)this.add(e[t])}Je.prototype.add=Je.prototype.push=di;Je.prototype.has=pi;function hi(e,t){for(var i=-1,s=e==null?0:e.length;++i<s;)if(t(e[i],i,e))return!0;return!1}function fi(e,t){return e.has(t)}var mi=1,vi=2;function vs(e,t,i,s,l,n){var o=i&mi,r=e.length,c=t.length;if(r!=c&&!(o&&c>r))return!1;var u=n.get(e),a=n.get(t);if(u&&a)return u==t&&a==e;var v=-1,h=!0,f=i&vi?new Je:void 0;for(n.set(e,t),n.set(t,e);++v<r;){var I=e[v],_=t[v];if(s)var $=o?s(_,I,v,t,e,n):s(I,_,v,e,t,n);if($!==void 0){if($)continue;h=!1;break}if(f){if(!hi(t,function(S,b){if(!fi(f,b)&&(I===S||l(I,S,i,s,n)))return f.push(b)})){h=!1;break}}else if(!(I===_||l(I,_,i,s,n))){h=!1;break}}return n.delete(e),n.delete(t),h}function gi(e){var t=-1,i=Array(e.size);return e.forEach(function(s,l){i[++t]=[l,s]}),i}function bi(e){var t=-1,i=Array(e.size);return e.forEach(function(s){i[++t]=s}),i}var wi=1,yi=2,_i="[object Boolean]",Ci="[object Date]",$i="[object Error]",Si="[object Map]",xi="[object Number]",Oi="[object RegExp]",Ei="[object Set]",Ii="[object String]",ki="[object Symbol]",Vi="[object ArrayBuffer]",Ti="[object DataView]",Gt=Pt?Pt.prototype:void 0,lt=Gt?Gt.valueOf:void 0;function Mi(e,t,i,s,l,n,o){switch(i){case Ti:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Vi:return!(e.byteLength!=t.byteLength||!n(new zt(e),new zt(t)));case _i:case Ci:case xi:return ao(+e,+t);case $i:return e.name==t.name&&e.message==t.message;case Oi:case Ii:return e==t+"";case Si:var r=gi;case Ei:var c=s&wi;if(r||(r=bi),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;s|=yi,o.set(e,t);var a=vs(r(e),r(t),s,l,n,o);return o.delete(e),a;case ki:if(lt)return lt.call(e)==lt.call(t)}return!1}var Ai=1,Wi=Object.prototype,Li=Wi.hasOwnProperty;function Ri(e,t,i,s,l,n){var o=i&Ai,r=Nt(e),c=r.length,u=Nt(t),a=u.length;if(c!=a&&!o)return!1;for(var v=c;v--;){var h=r[v];if(!(o?h in t:Li.call(t,h)))return!1}var f=n.get(e),I=n.get(t);if(f&&I)return f==t&&I==e;var _=!0;n.set(e,t),n.set(t,e);for(var $=o;++v<c;){h=r[v];var S=e[h],b=t[h];if(s)var V=o?s(b,S,h,t,e,n):s(S,b,h,e,t,n);if(!(V===void 0?S===b||l(S,b,i,s,n):V)){_=!1;break}$||($=h=="constructor")}if(_&&!$){var Y=e.constructor,C=t.constructor;Y!=C&&"constructor"in e&&"constructor"in t&&!(typeof Y=="function"&&Y instanceof Y&&typeof C=="function"&&C instanceof C)&&(_=!1)}return n.delete(e),n.delete(t),_}var Hi=1,qt="[object Arguments]",jt="[object Array]",Ue="[object Object]",Pi=Object.prototype,Qt=Pi.hasOwnProperty;function zi(e,t,i,s,l,n){var o=nt(e),r=nt(t),c=o?jt:Bt(e),u=r?jt:Bt(t);c=c==qt?Ue:c,u=u==qt?Ue:u;var a=c==Ue,v=u==Ue,h=c==u;if(h&&Xt(e)){if(!Xt(t))return!1;o=!0,a=!1}if(h&&!a)return n||(n=new Ke),o||ro(e)?vs(e,t,i,s,l,n):Mi(e,t,c,i,s,l,n);if(!(i&Hi)){var f=a&&Qt.call(e,"__wrapped__"),I=v&&Qt.call(t,"__wrapped__");if(f||I){var _=f?e.value():e,$=I?t.value():t;return n||(n=new Ke),l(_,$,i,s,n)}}return h?(n||(n=new Ke),Ri(e,t,i,s,l,n)):!1}function et(e,t,i,s,l){return e===t?!0:e==null||t==null||!Yt(e)&&!Yt(t)?e!==e&&t!==t:zi(e,t,i,s,et,l)}var Ni=1,Bi=2;function Xi(e,t,i,s){var l=i.length,n=l;if(e==null)return!n;for(e=Object(e);l--;){var o=i[l];if(o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++l<n;){o=i[l];var r=o[0],c=e[r],u=o[1];if(o[2]){if(c===void 0&&!(r in e))return!1}else{var a=new Ke,v;if(!(v===void 0?et(u,c,Ni|Bi,s,a):v))return!1}}return!0}function gs(e){return e===e&&!co(e)}function Yi(e){for(var t=uo(e),i=t.length;i--;){var s=t[i],l=e[s];t[i]=[s,l,gs(l)]}return t}function bs(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function Fi(e){var t=Yi(e);return t.length==1&&t[0][2]?bs(t[0][0],t[0][1]):function(i){return i===e||Xi(i,e,t)}}var Di=1,Ui=2;function Ki(e,t){return Jt(e)&&gs(t)?bs(es(e),t):function(i){var s=be(i,e);return s===void 0&&s===t?po(i,e):et(t,s,Di|Ui)}}function Gi(e){return function(t){return t==null?void 0:t[e]}}function qi(e){return function(t){return ho(t,e)}}function ji(e){return Jt(e)?Gi(es(e)):qi(e)}function Qi(e){return typeof e=="function"?e:e==null?fo:typeof e=="object"?nt(e)?Ki(e[0],e[1]):Fi(e):ji(e)}function Zi(e,t,i){var s=e==null?0:e.length;if(!s)return-1;var l=s-1;return ci(e,Qi(t),l)}function Ae(e,t){return et(e,t)}const ut=dt({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:mo},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Ji={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},el=K({name:"ElTag"}),tl=K({...el,props:ut,emits:Ji,setup(e,{emit:t}){const i=e,s=pt(),l=we("tag"),n=W(()=>{const{type:u,hit:a,effect:v,closable:h,round:f}=i;return[l.b(),l.is("closable",h),l.m(u||"primary"),l.m(s.value),l.m(v),l.is("hit",a),l.is("round",f)]}),o=u=>{t("close",u)},r=u=>{t("click",u)},c=u=>{var a,v,h;(h=(v=(a=u==null?void 0:u.component)==null?void 0:a.subTree)==null?void 0:v.component)!=null&&h.bum&&(u.component.subTree.component.bum=null)};return(u,a)=>u.disableTransitions?(y(),T("span",{key:0,class:L(w(n)),style:Z({backgroundColor:u.color}),onClick:r},[p("span",{class:L(w(l).e("content"))},[q(u.$slots,"default")],2),u.closable?(y(),H(w(Q),{key:0,class:L(w(l).e("close")),onClick:D(o,["stop"])},{default:g(()=>[m(w(at))]),_:1},8,["class","onClick"])):P("v-if",!0)],6)):(y(),H(vo,{key:1,name:`${w(l).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:c},{default:g(()=>[p("span",{class:L(w(n)),style:Z({backgroundColor:u.color}),onClick:r},[p("span",{class:L(w(l).e("content"))},[q(u.$slots,"default")],2),u.closable?(y(),H(w(Q),{key:0,class:L(w(l).e("close")),onClick:D(o,["stop"])},{default:g(()=>[m(w(at))]),_:1},8,["class","onClick"])):P("v-if",!0)],6)]),_:3},8,["name"]))}});var sl=$e(tl,[["__file","tag.vue"]]);const ol=ht(sl);function il(){const e=go(),t=R(0),i=11,s=W(()=>({minWidth:`${Math.max(t.value,i)}px`}));return ge(e,()=>{var n,o;t.value=(o=(n=e.value)==null?void 0:n.getBoundingClientRect().width)!=null?o:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:s}}const ws=Symbol("ElSelectGroup"),tt=Symbol("ElSelect");function ll(e,t){const i=Qe(tt),s=Qe(ws,{disabled:!1}),l=W(()=>a(he(i.props.modelValue),e.value)),n=W(()=>{var f;if(i.props.multiple){const I=he((f=i.props.modelValue)!=null?f:[]);return!l.value&&I.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),o=W(()=>e.label||(_e(e.value)?"":e.value)),r=W(()=>e.value||e.label||""),c=W(()=>e.disabled||t.groupDisabled||n.value),u=ft(),a=(f=[],I)=>{if(_e(e.value)){const _=i.props.valueKey;return f&&f.some($=>bo(be($,_))===be(I,_))}else return f&&f.includes(I)},v=()=>{!e.disabled&&!s.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(u.proxy))},h=f=>{const I=new RegExp(jo(f),"i");t.visible=I.test(o.value)||e.created};return ne(()=>o.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),ne(()=>e.value,(f,I)=>{const{remote:_,valueKey:$}=i.props;if((_?f!==I:!Ae(f,I))&&(i.onOptionDestroy(I,u.proxy),i.onOptionCreate(u.proxy)),!e.created&&!_){if($&&_e(f)&&_e(I)&&f[$]===I[$])return;i.setSelected()}}),ne(()=>s.disabled,()=>{t.groupDisabled=s.disabled},{immediate:!0}),{select:i,currentLabel:o,currentValue:r,itemSelected:l,isDisabled:c,hoverItem:v,updateOption:h}}const nl=K({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=we("select"),i=ts(),s=W(()=>[t.be("dropdown","item"),t.is("disabled",w(r)),t.is("selected",w(o)),t.is("hovering",w(h))]),l=se({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:n,itemSelected:o,isDisabled:r,select:c,hoverItem:u,updateOption:a}=ll(e,l),{visible:v,hover:h}=mt(l),f=ft().proxy;c.onOptionCreate(f),wo(()=>{const _=f.value,{selected:$}=c.states,S=$.some(b=>b.value===f.value);le(()=>{c.states.cachedOptions.get(_)===f&&!S&&c.states.cachedOptions.delete(_)}),c.onOptionDestroy(_,f)});function I(){r.value||c.handleOptionSelect(f)}return{ns:t,id:i,containerKls:s,currentLabel:n,itemSelected:o,isDisabled:r,select:c,hoverItem:u,updateOption:a,visible:v,hover:h,selectOptionClick:I,states:l}}});function al(e,t,i,s,l,n){return U((y(),T("li",{id:e.id,class:L(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:D(e.selectOptionClick,["stop"])},[q(e.$slots,"default",{},()=>[p("span",null,E(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[We,e.visible]])}var yt=$e(nl,[["render",al],["__file","option.vue"]]);const rl=K({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Qe(tt),t=we("select"),i=W(()=>e.props.popperClass),s=W(()=>e.props.multiple),l=W(()=>e.props.fitInputWidth),n=R("");function o(){var r;n.value=`${(r=e.selectRef)==null?void 0:r.offsetWidth}px`}return Se(()=>{o(),ge(e.selectRef,o)}),{ns:t,minWidth:n,popperClass:i,isMultiple:s,isFitInputWidth:l}}});function cl(e,t,i,s,l,n){return y(),T("div",{class:L([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Z({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(y(),T("div",{key:0,class:L(e.ns.be("dropdown","header"))},[q(e.$slots,"header")],2)):P("v-if",!0),q(e.$slots,"default"),e.$slots.footer?(y(),T("div",{key:1,class:L(e.ns.be("dropdown","footer"))},[q(e.$slots,"footer")],2)):P("v-if",!0)],6)}var ul=$e(rl,[["render",cl],["__file","select-dropdown.vue"]]);const dl=(e,t)=>{const{t:i}=yo(),s=ts(),l=we("select"),n=we("input"),o=se({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),r=R(null),c=R(null),u=R(null),a=R(null),v=R(null),h=R(null),f=R(null),I=R(null),_=R(null),$=R(null),S=R(null),{isComposing:b,handleCompositionStart:V,handleCompositionUpdate:Y,handleCompositionEnd:C}=_o({afterComposition:d=>Tt(d)}),{wrapperRef:k,isFocused:O,handleBlur:M}=Co(v,{beforeFocus(){return xe.value},afterFocus(){e.automaticDropdown&&!A.value&&(A.value=!0,o.menuVisibleOnFocus=!0)},beforeBlur(d){var x,z;return((x=u.value)==null?void 0:x.isFocusInsideContent(d))||((z=a.value)==null?void 0:z.isFocusInsideContent(d))},afterBlur(){A.value=!1,o.menuVisibleOnFocus=!1}}),A=R(!1),X=R(),{form:j,formItem:F}=ss(),{inputId:B}=os(e,{formItemContext:F}),{valueOnClear:st,isEmptyValue:re}=$o(e),xe=W(()=>e.disabled||(j==null?void 0:j.disabled)),ot=W(()=>me(e.modelValue)?e.modelValue.length>0:!re(e.modelValue)),$s=W(()=>{var d;return(d=j==null?void 0:j.statusIcon)!=null?d:!1}),Ss=W(()=>e.clearable&&!xe.value&&o.inputHovering&&ot.value),Ct=W(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),xs=W(()=>l.is("reverse",Ct.value&&A.value)),St=W(()=>(F==null?void 0:F.validateState)||""),Os=W(()=>So[St.value]),Es=W(()=>e.remote?300:0),Is=W(()=>e.remote&&!o.inputValue&&o.options.size===0),ks=W(()=>e.loading?e.loadingText||i("el.select.loading"):e.filterable&&o.inputValue&&o.options.size>0&&Oe.value===0?e.noMatchText||i("el.select.noMatch"):o.options.size===0?e.noDataText||i("el.select.noData"):null),Oe=W(()=>ee.value.filter(d=>d.visible).length),ee=W(()=>{const d=Array.from(o.options.values()),x=[];return o.optionValues.forEach(z=>{const G=d.findIndex(te=>te.value===z);G>-1&&x.push(d[G])}),x.length>=d.length?x:d}),Vs=W(()=>Array.from(o.cachedOptions.values())),Ts=W(()=>{const d=ee.value.filter(x=>!x.created).some(x=>x.currentLabel===o.inputValue);return e.filterable&&e.allowCreate&&o.inputValue!==""&&!d}),xt=()=>{e.filterable&&ke(e.filterMethod)||e.filterable&&e.remote&&ke(e.remoteMethod)||ee.value.forEach(d=>{var x;(x=d.updateOption)==null||x.call(d,o.inputValue)})},Ot=pt(),Ms=W(()=>["small"].includes(Ot.value)?"small":"default"),As=W({get(){return A.value&&!Is.value},set(d){A.value=d}}),Ws=W(()=>{if(e.multiple&&!De(e.modelValue))return he(e.modelValue).length===0&&!o.inputValue;const d=me(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||De(d)?!o.inputValue:!0}),Ls=W(()=>{var d;const x=(d=e.placeholder)!=null?d:i("el.select.placeholder");return e.multiple||!ot.value?x:o.selectedLabel}),Rs=W(()=>Ft?null:"mouseenter");ne(()=>e.modelValue,(d,x)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(o.inputValue="",ze("")),Ne(),!Ae(d,x)&&e.validateEvent&&(F==null||F.validate("change").catch(z=>is()))},{flush:"post",deep:!0}),ne(()=>A.value,d=>{d?ze(o.inputValue):(o.inputValue="",o.previousQuery=null,o.isBeforeHide=!0),t("visible-change",d)}),ne(()=>o.options.entries(),()=>{xo&&(Ne(),e.defaultFirstOption&&(e.filterable||e.remote)&&Oe.value&&Et())},{flush:"post"}),ne(()=>o.hoveringIndex,d=>{Ge(d)&&d>-1?X.value=ee.value[d]||{}:X.value={},ee.value.forEach(x=>{x.hover=X.value===x})}),Oo(()=>{o.isBeforeHide||xt()});const ze=d=>{o.previousQuery===d||b.value||(o.previousQuery=d,e.filterable&&ke(e.filterMethod)?e.filterMethod(d):e.filterable&&e.remote&&ke(e.remoteMethod)&&e.remoteMethod(d),e.defaultFirstOption&&(e.filterable||e.remote)&&Oe.value?le(Et):le(Hs))},Et=()=>{const d=ee.value.filter(te=>te.visible&&!te.disabled&&!te.states.groupDisabled),x=d.find(te=>te.created),z=d[0],G=ee.value.map(te=>te.value);o.hoveringIndex=Lt(G,x||z)},Ne=()=>{if(e.multiple)o.selectedLabel="";else{const x=me(e.modelValue)?e.modelValue[0]:e.modelValue,z=It(x);o.selectedLabel=z.currentLabel,o.selected=[z];return}const d=[];De(e.modelValue)||he(e.modelValue).forEach(x=>{d.push(It(x))}),o.selected=d},It=d=>{let x;const z=Eo(d);for(let ye=o.cachedOptions.size-1;ye>=0;ye--){const pe=Vs.value[ye];if(z?be(pe.value,e.valueKey)===be(d,e.valueKey):pe.value===d){x={value:d,currentLabel:pe.currentLabel,get isDisabled(){return pe.isDisabled}};break}}if(x)return x;const G=z?d.label:d??"";return{value:d,currentLabel:G}},Hs=()=>{o.hoveringIndex=ee.value.findIndex(d=>o.selected.some(x=>Ye(x)===Ye(d)))},Ps=()=>{o.selectionWidth=c.value.getBoundingClientRect().width},zs=()=>{o.collapseItemWidth=$.value.getBoundingClientRect().width},it=()=>{var d,x;(x=(d=u.value)==null?void 0:d.updatePopper)==null||x.call(d)},kt=()=>{var d,x;(x=(d=a.value)==null?void 0:d.updatePopper)==null||x.call(d)},Vt=()=>{o.inputValue.length>0&&!A.value&&(A.value=!0),ze(o.inputValue)},Tt=d=>{if(o.inputValue=d.target.value,e.remote)Mt();else return Vt()},Mt=ni(()=>{Vt()},Es.value),Ee=d=>{Ae(e.modelValue,d)||t(Le,d)},Ns=d=>Zi(d,x=>{const z=o.cachedOptions.get(x);return z&&!z.disabled&&!z.states.groupDisabled}),Bs=d=>{if(e.multiple&&d.code!==ko.delete&&d.target.value.length<=0){const x=he(e.modelValue).slice(),z=Ns(x);if(z<0)return;const G=x[z];x.splice(z,1),t(ce,x),Ee(x),t("remove-tag",G)}},Xs=(d,x)=>{const z=o.selected.indexOf(x);if(z>-1&&!xe.value){const G=he(e.modelValue).slice();G.splice(z,1),t(ce,G),Ee(G),t("remove-tag",x.value)}d.stopPropagation(),Xe()},At=d=>{d.stopPropagation();const x=e.multiple?[]:st.value;if(e.multiple)for(const z of o.selected)z.isDisabled&&x.push(z.value);t(ce,x),Ee(x),o.hoveringIndex=-1,A.value=!1,t("clear"),Xe()},Wt=d=>{var x;if(e.multiple){const z=he((x=e.modelValue)!=null?x:[]).slice(),G=Lt(z,d);G>-1?z.splice(G,1):(e.multipleLimit<=0||z.length<e.multipleLimit)&&z.push(d.value),t(ce,z),Ee(z),d.created&&ze(""),e.filterable&&!e.reserveKeyword&&(o.inputValue="")}else t(ce,d.value),Ee(d.value),A.value=!1;Xe(),!A.value&&le(()=>{Be(d)})},Lt=(d=[],x)=>De(x)?-1:_e(x.value)?d.findIndex(z=>Ae(be(z,e.valueKey),Ye(x))):d.indexOf(x.value),Be=d=>{var x,z,G,te,ye;const pe=me(d)?d[0]:d;let Fe=null;if(pe!=null&&pe.value){const Ie=ee.value.filter(lo=>lo.value===pe.value);Ie.length>0&&(Fe=Ie[0].$el)}if(u.value&&Fe){const Ie=(te=(G=(z=(x=u.value)==null?void 0:x.popperRef)==null?void 0:z.contentRef)==null?void 0:G.querySelector)==null?void 0:te.call(G,`.${l.be("dropdown","wrap")}`);Ie&&Io(Ie,Fe)}(ye=S.value)==null||ye.handleScroll()},Ys=d=>{o.options.set(d.value,d),o.cachedOptions.set(d.value,d)},Fs=(d,x)=>{o.options.get(d)===x&&o.options.delete(d)},Ds=W(()=>{var d,x;return(x=(d=u.value)==null?void 0:d.popperRef)==null?void 0:x.contentRef}),Us=()=>{o.isBeforeHide=!1,le(()=>{var d;(d=S.value)==null||d.update(),Be(o.selected)})},Xe=()=>{var d;(d=v.value)==null||d.focus()},Ks=()=>{var d;if(A.value){A.value=!1,le(()=>{var x;return(x=v.value)==null?void 0:x.blur()});return}(d=v.value)==null||d.blur()},Gs=d=>{At(d)},qs=d=>{if(A.value=!1,O.value){const x=new FocusEvent("focus",d);le(()=>M(x))}},js=()=>{o.inputValue.length>0?o.inputValue="":A.value=!1},Rt=()=>{xe.value||(Ft&&(o.inputHovering=!0),o.menuVisibleOnFocus?o.menuVisibleOnFocus=!1:A.value=!A.value)},Qs=()=>{if(!A.value)Rt();else{const d=ee.value[o.hoveringIndex];d&&!d.isDisabled&&Wt(d)}},Ye=d=>_e(d.value)?be(d.value,e.valueKey):d.value,Zs=W(()=>ee.value.filter(d=>d.visible).every(d=>d.isDisabled)),Js=W(()=>e.multiple?e.collapseTags?o.selected.slice(0,e.maxCollapseTags):o.selected:[]),eo=W(()=>e.multiple?e.collapseTags?o.selected.slice(e.maxCollapseTags):[]:[]),Ht=d=>{if(!A.value){A.value=!0;return}if(!(o.options.size===0||Oe.value===0||b.value)&&!Zs.value){d==="next"?(o.hoveringIndex++,o.hoveringIndex===o.options.size&&(o.hoveringIndex=0)):d==="prev"&&(o.hoveringIndex--,o.hoveringIndex<0&&(o.hoveringIndex=o.options.size-1));const x=ee.value[o.hoveringIndex];(x.isDisabled||!x.visible)&&Ht(d),le(()=>Be(X.value))}},to=()=>{if(!c.value)return 0;const d=window.getComputedStyle(c.value);return Number.parseFloat(d.gap||"6px")},so=W(()=>{const d=to();return{maxWidth:`${$.value&&e.maxCollapseTags===1?o.selectionWidth-o.collapseItemWidth-d:o.selectionWidth}px`}}),oo=W(()=>({maxWidth:`${o.selectionWidth}px`})),io=d=>{t("popup-scroll",d)};return ge(c,Ps),ge(I,it),ge(k,it),ge(_,kt),ge($,zs),Se(()=>{Ne()}),{inputId:B,contentId:s,nsSelect:l,nsInput:n,states:o,isFocused:O,expanded:A,optionsArray:ee,hoverOption:X,selectSize:Ot,filteredOptionsCount:Oe,updateTooltip:it,updateTagTooltip:kt,debouncedOnInputChange:Mt,onInput:Tt,deletePrevTag:Bs,deleteTag:Xs,deleteSelected:At,handleOptionSelect:Wt,scrollToOption:Be,hasModelValue:ot,shouldShowPlaceholder:Ws,currentPlaceholder:Ls,mouseEnterEventName:Rs,needStatusIcon:$s,showClose:Ss,iconComponent:Ct,iconReverse:xs,validateState:St,validateIcon:Os,showNewOption:Ts,updateOptions:xt,collapseTagSize:Ms,setSelected:Ne,selectDisabled:xe,emptyText:ks,handleCompositionStart:V,handleCompositionUpdate:Y,handleCompositionEnd:C,onOptionCreate:Ys,onOptionDestroy:Fs,handleMenuEnter:Us,focus:Xe,blur:Ks,handleClearClick:Gs,handleClickOutside:qs,handleEsc:js,toggleMenu:Rt,selectOption:Qs,getValueKey:Ye,navigateOptions:Ht,dropdownMenuVisible:As,showTagList:Js,collapseTagList:eo,popupScroll:io,tagStyle:so,collapseTagStyle:oo,popperRef:Ds,inputRef:v,tooltipRef:u,tagTooltipRef:a,prefixRef:h,suffixRef:f,selectRef:r,wrapperRef:k,selectionRef:c,scrollbarRef:S,menuRef:I,tagMenuRef:_,collapseItemRef:$}};var pl=K({name:"ElOptions",setup(e,{slots:t}){const i=Qe(tt);let s=[];return()=>{var l,n;const o=(l=t.default)==null?void 0:l.call(t),r=[];function c(u){me(u)&&u.forEach(a=>{var v,h,f,I;const _=(v=(a==null?void 0:a.type)||{})==null?void 0:v.name;_==="ElOptionGroup"?c(!qe(a.children)&&!me(a.children)&&ke((h=a.children)==null?void 0:h.default)?(f=a.children)==null?void 0:f.default():a.children):_==="ElOption"?r.push((I=a.props)==null?void 0:I.value):me(a.children)&&c(a.children)})}return o.length&&c((n=o[0])==null?void 0:n.children),Ae(r,s)||(s=r,i&&(i.states.optionValues=r)),o}}});const hl=dt({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Wo,effect:{type:Ve(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Ve(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Ao.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ce,default:Mo},fitInputWidth:Boolean,suffixIcon:{type:Ce,default:ns},tagType:{...ut.type,default:"info"},tagEffect:{...ut.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:Ve(String),values:To,default:"bottom-start"},fallbackPlacements:{type:Ve(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...Vo,...ls(["ariaLabel"])}),Zt="ElSelect",fl=K({name:Zt,componentName:Zt,components:{ElSelectMenu:ul,ElOption:yt,ElOptions:pl,ElTag:ol,ElScrollbar:Ho,ElTooltip:vt,ElIcon:Q},directives:{ClickOutside:ai},props:hl,emits:[ce,Le,"remove-tag","clear","visible-change","focus","blur","popup-scroll"],setup(e,{emit:t}){const i=W(()=>{const{modelValue:c,multiple:u}=e,a=u?[]:void 0;return me(c)?u?c:a:u?a:c}),s=se({...mt(e),modelValue:i}),l=dl(s,t),{calculatorRef:n,inputStyle:o}=il();as(tt,se({props:s,states:l.states,optionsArray:l.optionsArray,handleOptionSelect:l.handleOptionSelect,onOptionCreate:l.onOptionCreate,onOptionDestroy:l.onOptionDestroy,selectRef:l.selectRef,setSelected:l.setSelected}));const r=W(()=>e.multiple?l.states.selected.map(c=>c.currentLabel):l.states.selectedLabel);return{...l,modelValue:i,selectedLabel:r,calculatorRef:n,inputStyle:o}}});function ml(e,t,i,s,l,n){const o=ie("el-tag"),r=ie("el-tooltip"),c=ie("el-icon"),u=ie("el-option"),a=ie("el-options"),v=ie("el-scrollbar"),h=ie("el-select-menu"),f=de("click-outside");return U((y(),T("div",{ref:"selectRef",class:L([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[Ro(e.mouseEnterEventName)]:I=>e.states.inputHovering=!0,onMouseleave:I=>e.states.inputHovering=!1},[m(r,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:I=>e.states.isBeforeHide=!1},{default:g(()=>{var I;return[p("div",{ref:"wrapperRef",class:L([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:D(e.toggleMenu,["prevent"])},[e.$slots.prefix?(y(),T("div",{key:0,ref:"prefixRef",class:L(e.nsSelect.e("prefix"))},[q(e.$slots,"prefix")],2)):P("v-if",!0),p("div",{ref:"selectionRef",class:L([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?q(e.$slots,"tag",{key:0},()=>[(y(!0),T(J,null,Ze(e.showTagList,_=>(y(),T("div",{key:e.getValueKey(_),class:L(e.nsSelect.e("selected-item"))},[m(o,{closable:!e.selectDisabled&&!_.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Z(e.tagStyle),onClose:$=>e.deleteTag($,_)},{default:g(()=>[p("span",{class:L(e.nsSelect.e("tags-text"))},[q(e.$slots,"label",{label:_.currentLabel,value:_.value},()=>[N(E(_.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(y(),H(r,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:g(()=>[p("div",{ref:"collapseItemRef",class:L(e.nsSelect.e("selected-item"))},[m(o,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Z(e.collapseTagStyle)},{default:g(()=>[p("span",{class:L(e.nsSelect.e("tags-text"))}," + "+E(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:g(()=>[p("div",{ref:"tagMenuRef",class:L(e.nsSelect.e("selection"))},[(y(!0),T(J,null,Ze(e.collapseTagList,_=>(y(),T("div",{key:e.getValueKey(_),class:L(e.nsSelect.e("selected-item"))},[m(o,{class:"in-tooltip",closable:!e.selectDisabled&&!_.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:$=>e.deleteTag($,_)},{default:g(()=>[p("span",{class:L(e.nsSelect.e("tags-text"))},[q(e.$slots,"label",{label:_.currentLabel,value:_.value},()=>[N(E(_.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):P("v-if",!0)]):P("v-if",!0),p("div",{class:L([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[U(p("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":_=>e.states.inputValue=_,type:"text",name:e.name,class:L([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Z(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((I=e.hoverOption)==null?void 0:I.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[ue(D(_=>e.navigateOptions("next"),["stop","prevent"]),["down"]),ue(D(_=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),ue(D(e.handleEsc,["stop","prevent"]),["esc"]),ue(D(e.selectOption,["stop","prevent"]),["enter"]),ue(D(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:D(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[Lo,e.states.inputValue]]),e.filterable?(y(),T("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:L(e.nsSelect.e("input-calculator")),textContent:E(e.states.inputValue)},null,10,["textContent"])):P("v-if",!0)],2),e.shouldShowPlaceholder?(y(),T("div",{key:1,class:L([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?q(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[p("span",null,E(e.currentPlaceholder),1)]):(y(),T("span",{key:1},E(e.currentPlaceholder),1))],2)):P("v-if",!0)],2),p("div",{ref:"suffixRef",class:L(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(y(),H(c,{key:0,class:L([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:g(()=>[(y(),H(fe(e.iconComponent)))]),_:1},8,["class"])):P("v-if",!0),e.showClose&&e.clearIcon?(y(),H(c,{key:1,class:L([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:g(()=>[(y(),H(fe(e.clearIcon)))]),_:1},8,["class","onClick"])):P("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(y(),H(c,{key:2,class:L([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:g(()=>[(y(),H(fe(e.validateIcon)))]),_:1},8,["class"])):P("v-if",!0)],2)],10,["onClick"])]}),content:g(()=>[m(h,{ref:"menuRef"},{default:g(()=>[e.$slots.header?(y(),T("div",{key:0,class:L(e.nsSelect.be("dropdown","header")),onClick:D(()=>{},["stop"])},[q(e.$slots,"header")],10,["onClick"])):P("v-if",!0),U(m(v,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:L([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical",onScroll:e.popupScroll},{default:g(()=>[e.showNewOption?(y(),H(u,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):P("v-if",!0),m(a,null,{default:g(()=>[q(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label","onScroll"]),[[We,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(y(),T("div",{key:1,class:L(e.nsSelect.be("dropdown","loading"))},[q(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(y(),T("div",{key:2,class:L(e.nsSelect.be("dropdown","empty"))},[q(e.$slots,"empty",{},()=>[p("span",null,E(e.emptyText),1)])],2)):P("v-if",!0),e.$slots.footer?(y(),T("div",{key:3,class:L(e.nsSelect.be("dropdown","footer")),onClick:D(()=>{},["stop"])},[q(e.$slots,"footer")],10,["onClick"])):P("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[f,e.handleClickOutside,e.popperRef]])}var vl=$e(fl,[["render",ml],["__file","select.vue"]]);const gl=K({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=we("select"),i=R(null),s=ft(),l=R([]);as(ws,se({...mt(e)}));const n=W(()=>l.value.some(u=>u.visible===!0)),o=u=>{var a,v;return((a=u.type)==null?void 0:a.name)==="ElOption"&&!!((v=u.component)!=null&&v.proxy)},r=u=>{const a=he(u),v=[];return a.forEach(h=>{var f,I;o(h)?v.push(h.component.proxy):(f=h.children)!=null&&f.length?v.push(...r(h.children)):(I=h.component)!=null&&I.subTree&&v.push(...r(h.component.subTree))}),v},c=()=>{l.value=r(s.subTree)};return Se(()=>{c()}),Po(i,c,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:n,ns:t}}});function bl(e,t,i,s,l,n){return U((y(),T("ul",{ref:"groupRef",class:L(e.ns.be("group","wrap"))},[p("li",{class:L(e.ns.be("group","title"))},E(e.label),3),p("li",null,[p("ul",{class:L(e.ns.b("group"))},[q(e.$slots,"default")],2)])],2)),[[We,e.visible]])}var ys=$e(gl,[["render",bl],["__file","option-group.vue"]]);const wl=ht(vl,{Option:yt,OptionGroup:ys}),yl=rs(yt);rs(ys);const _l=dt({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:ti},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Ce},activeActionIcon:{type:Ce},activeIcon:{type:Ce},inactiveIcon:{type:Ce},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Ve(Function)},id:String,tabindex:{type:[String,Number]},...ls(["ariaLabel"])}),Cl={[ce]:e=>je(e)||qe(e)||Ge(e),[Le]:e=>je(e)||qe(e)||Ge(e),[rt]:e=>je(e)||qe(e)||Ge(e)},_s="ElSwitch",$l=K({name:_s}),Sl=K({...$l,props:_l,emits:Cl,setup(e,{expose:t,emit:i}){const s=e,{formItem:l}=ss(),n=pt(),o=we("switch"),{inputId:r}=os(s,{formItemContext:l}),c=zo(W(()=>s.loading)),u=R(s.modelValue!==!1),a=R(),v=R(),h=W(()=>[o.b(),o.m(n.value),o.is("disabled",c.value),o.is("checked",S.value)]),f=W(()=>[o.e("label"),o.em("label","left"),o.is("active",!S.value)]),I=W(()=>[o.e("label"),o.em("label","right"),o.is("active",S.value)]),_=W(()=>({width:No(s.width)}));ne(()=>s.modelValue,()=>{u.value=!0});const $=W(()=>u.value?s.modelValue:!1),S=W(()=>$.value===s.activeValue);[s.activeValue,s.inactiveValue].includes($.value)||(i(ce,s.inactiveValue),i(Le,s.inactiveValue),i(rt,s.inactiveValue)),ne(S,C=>{var k;a.value.checked=C,s.validateEvent&&((k=l==null?void 0:l.validate)==null||k.call(l,"change").catch(O=>is()))});const b=()=>{const C=S.value?s.inactiveValue:s.activeValue;i(ce,C),i(Le,C),i(rt,C),le(()=>{a.value.checked=S.value})},V=()=>{if(c.value)return;const{beforeChange:C}=s;if(!C){b();return}const k=C();[Dt(k),je(k)].includes(!0)||Xo(_s,"beforeChange must return type `Promise<boolean>` or `boolean`"),Dt(k)?k.then(M=>{M&&b()}).catch(M=>{}):k&&b()},Y=()=>{var C,k;(k=(C=a.value)==null?void 0:C.focus)==null||k.call(C)};return Se(()=>{a.value.checked=S.value}),t({focus:Y,checked:S}),(C,k)=>(y(),T("div",{class:L(w(h)),onClick:D(V,["prevent"])},[p("input",{id:w(r),ref_key:"input",ref:a,class:L(w(o).e("input")),type:"checkbox",role:"switch","aria-checked":w(S),"aria-disabled":w(c),"aria-label":C.ariaLabel,name:C.name,"true-value":C.activeValue,"false-value":C.inactiveValue,disabled:w(c),tabindex:C.tabindex,onChange:b,onKeydown:ue(V,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!C.inlinePrompt&&(C.inactiveIcon||C.inactiveText)?(y(),T("span",{key:0,class:L(w(f))},[C.inactiveIcon?(y(),H(w(Q),{key:0},{default:g(()=>[(y(),H(fe(C.inactiveIcon)))]),_:1})):P("v-if",!0),!C.inactiveIcon&&C.inactiveText?(y(),T("span",{key:1,"aria-hidden":w(S)},E(C.inactiveText),9,["aria-hidden"])):P("v-if",!0)],2)):P("v-if",!0),p("span",{ref_key:"core",ref:v,class:L(w(o).e("core")),style:Z(w(_))},[C.inlinePrompt?(y(),T("div",{key:0,class:L(w(o).e("inner"))},[C.activeIcon||C.inactiveIcon?(y(),H(w(Q),{key:0,class:L(w(o).is("icon"))},{default:g(()=>[(y(),H(fe(w(S)?C.activeIcon:C.inactiveIcon)))]),_:1},8,["class"])):C.activeText||C.inactiveText?(y(),T("span",{key:1,class:L(w(o).is("text")),"aria-hidden":!w(S)},E(w(S)?C.activeText:C.inactiveText),11,["aria-hidden"])):P("v-if",!0)],2)):P("v-if",!0),p("div",{class:L(w(o).e("action"))},[C.loading?(y(),H(w(Q),{key:0,class:L(w(o).is("loading"))},{default:g(()=>[m(w(Bo))]),_:1},8,["class"])):w(S)?q(C.$slots,"active-action",{key:1},()=>[C.activeActionIcon?(y(),H(w(Q),{key:0},{default:g(()=>[(y(),H(fe(C.activeActionIcon)))]),_:1})):P("v-if",!0)]):w(S)?P("v-if",!0):q(C.$slots,"inactive-action",{key:2},()=>[C.inactiveActionIcon?(y(),H(w(Q),{key:0},{default:g(()=>[(y(),H(fe(C.inactiveActionIcon)))]),_:1})):P("v-if",!0)])],2)],6),!C.inlinePrompt&&(C.activeIcon||C.activeText)?(y(),T("span",{key:1,class:L(w(I))},[C.activeIcon?(y(),H(w(Q),{key:0},{default:g(()=>[(y(),H(fe(C.activeIcon)))]),_:1})):P("v-if",!0),!C.activeIcon&&C.activeText?(y(),T("span",{key:1,"aria-hidden":!w(S)},E(C.activeText),9,["aria-hidden"])):P("v-if",!0)],2)):P("v-if",!0)],10,["onClick"]))}});var xl=$e(Sl,[["__file","switch.vue"]]);const _t=ht(xl),Ol="/images/toolbar.png",El={class:"h-10 flex items-center justify-between px-4 border rounded-md"},Il={class:"flex items-center justify-between py-3 mt-2"},kl={class:"sort-icon cursor-move"},Vl=K({__name:"toolbar",setup(e){const t=wt();return(i,s)=>{const l=_t,n=ae,o=ie("svg-icon"),r=vt,c=Q,u=ve;return y(),T(J,null,[s[6]||(s[6]=p("img",{class:"h-[280px] bg-[#E5ECFF] rounded-lg",src:Ol},null,-1)),s[7]||(s[7]=p("div",{class:"flex items-center justify-between py-3 mt-2"},[p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"启用/禁用")],-1)),p("div",El,[s[2]||(s[2]=p("div",{class:"text-sm text-[#1D1E1F]"},"启用网页工具栏",-1)),m(l,{modelValue:w(t).toolbar_enabled,"onUpdate:modelValue":s[0]||(s[0]=a=>w(t).toolbar_enabled=a)},null,8,["modelValue"])]),w(t).toolbar_enabled?(y(),T(J,{key:0},[p("div",Il,[s[4]||(s[4]=p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"工具栏",-1)),m(n,{type:"primary",plain:"",class:"!border-none"},{default:g(()=>s[3]||(s[3]=[N("系统内置")])),_:1})]),m(ms,{modelValue:w(t).toolbar_menus,"onUpdate:modelValue":s[1]||(s[1]=a=>w(t).toolbar_menus=a),identity:"value",class:"flex flex-col gap-2"},{item:g(({item:a,index:v})=>[m(u,{size:"large",modelValue:a.name,"onUpdate:modelValue":h=>a.name=h},{prefix:g(()=>[p("div",kl,[m(o,{size:"18",name:"drag",class:"cursor-move"})])]),suffix:g(()=>[m(r,{content:"系统内置不可编辑",placement:"top"},{default:g(()=>[m(o,{size:"16",name:"edit",class:"cursor-pointer",onClick:D(h=>i.handleEdit(a),["stop"])},null,8,["onClick"])]),_:2},1024),m(c,{color:"#1D1E1F",class:"ml-2 cursor-pointer",onClick:D(h=>i.handleDel(a,v),["stop"])},{default:g(()=>[m(w(cs))]),_:2},1032,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"])],64)):P("",!0),m(n,{type:"primary",plain:"",class:"!border-none mt-4"},{default:g(()=>s[5]||(s[5]=[N("+添加")])),_:1})],64)}}}),Tl="/images/glider.png",Ml={class:"flex flex-col gap-2"},Al={class:"h-10 flex items-center justify-between px-4 border rounded-md"},Wl={key:0,class:"h-10 flex items-center justify-between px-4 border rounded-md"},Ll={class:"text-sm text-[#1D1E1F]"},Rl={class:"flex items-center justify-between py-3 mt-2"},Hl={class:"sort-icon cursor-move"},Pl={class:"text-xs text-[#9A9A9A]"},zl={class:"flex-center"},Nl=K({__name:"glider",setup(e){const t=wt(),i=R(),s=R(!1),l=R({name:"",value:""}),n=()=>{l.value.name="",l.value.value="",s.value=!0},o=u=>{l.value.name=u.name,l.value.value=u.value,s.value=!0},r=async(u,a)=>{await si.confirm("确认删除吗？"),t.glider_menus.splice(a,1)},c=()=>{i.value.validate(u=>{u&&(t.glider_menus.push(l.value),s.value=!1)})};return(u,a)=>{const v=_t,h=Q,f=ii,I=oi,_=li,$=ae,S=ie("svg-icon"),b=vt,V=ve,Y=He,C=Re,k=gt;return y(),T(J,null,[a[19]||(a[19]=p("img",{class:"h-[160px] bg-[#E5ECFF] rounded-lg",src:Tl},null,-1)),a[20]||(a[20]=p("div",{class:"flex items-center justify-between py-3 mt-2"},[p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"启用/禁用")],-1)),p("div",Ml,[p("div",Al,[a[6]||(a[6]=p("div",{class:"text-sm text-[#1D1E1F]"},"启用划词菜单栏",-1)),m(v,{modelValue:w(t).glider_enabled,"onUpdate:modelValue":a[0]||(a[0]=O=>w(t).glider_enabled=O)},null,8,["modelValue"])]),w(t).glider_enabled?(y(),T("div",Wl,[a[10]||(a[10]=p("div",{class:"text-sm text-[#1D1E1F]"},"唤起方式",-1)),m(_,{trigger:"click"},{dropdown:g(()=>[m(I,null,{default:g(()=>[m(f,null,{default:g(()=>a[8]||(a[8]=[N("划词后立即唤起")])),_:1}),m(f,null,{default:g(()=>a[9]||(a[9]=[N("划词后按快捷键唤起")])),_:1})]),_:1})]),default:g(()=>[p("div",Ll,[a[7]||(a[7]=N(" 划词立即唤起 ")),m(h,null,{default:g(()=>[m(w(ns))]),_:1})])]),_:1})])):P("",!0)]),w(t).glider_enabled?(y(),T(J,{key:0},[p("div",Rl,[a[12]||(a[12]=p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"菜单栏",-1)),m($,{type:"primary",plain:"",class:"!border-none"},{default:g(()=>a[11]||(a[11]=[N("系统内置")])),_:1})]),m(ms,{modelValue:w(t).glider_menus,"onUpdate:modelValue":a[1]||(a[1]=O=>w(t).glider_menus=O),identity:"value",class:"flex flex-col gap-2"},{item:g(({item:O,index:M})=>[m(V,{size:"large",modelValue:O.name,"onUpdate:modelValue":A=>O.name=A},{prefix:g(()=>[p("div",Hl,[m(S,{size:"18",name:"drag",class:"cursor-move"})])]),suffix:g(()=>[m(b,{content:"系统内置不可编辑",placement:"top"},{default:g(()=>[m(S,{size:"16",name:"edit",class:"cursor-pointer",onClick:D(A=>o(O),["stop"])},null,8,["onClick"])]),_:2},1024),m(h,{color:"#1D1E1F",class:"ml-2 cursor-pointer",onClick:D(A=>r(O,M),["stop"])},{default:g(()=>[m(w(cs))]),_:2},1032,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue"]),p("div",null,[m($,{type:"primary",plain:"",class:"!border-none mt-4",onClick:n},{default:g(()=>a[13]||(a[13]=[N("+添加")])),_:1}),m($,{type:"primary",plain:"",class:"!border-none mt-4"},{default:g(()=>a[14]||(a[14]=[N("官方工具库")])),_:1})])],64)):P("",!0),m(k,{modelValue:s.value,"onUpdate:modelValue":a[5]||(a[5]=O=>s.value=O),title:"添加工具",width:"600px"},{footer:g(()=>[p("div",zl,[m($,{type:"primary",onClick:c},{default:g(()=>a[17]||(a[17]=[N("保存")])),_:1}),m($,{type:"default",onClick:a[4]||(a[4]=O=>s.value=!1)},{default:g(()=>a[18]||(a[18]=[N("取消")])),_:1})])]),default:g(()=>[m(C,{ref_key:"formRef",ref:i,model:l.value,"label-position":"top","require-asterisk-position":"right"},{default:g(()=>[m(Y,{label:"工具图标和名称",required:""},{default:g(()=>[m(V,{modelValue:l.value.name,"onUpdate:modelValue":a[2]||(a[2]=O=>l.value.name=O),size:"large",placeholder:"请输入工具名称"},null,8,["modelValue"])]),_:1}),m(Y,{label:"执行Agent",required:""},{default:g(()=>[m(V,{modelValue:l.value.value,"onUpdate:modelValue":a[3]||(a[3]=O=>l.value.value=O),size:"large",placeholder:"请输入工具名称"},null,8,["modelValue"])]),_:1}),m(Y,{label:"执行指令",required:""},{default:g(()=>[p("div",Pl,[a[15]||(a[15]=N("把 ")),a[16]||(a[16]=p("span",{class:"text-[#2563EB]"},"\\{\\{划词内容}}",-1)),N(" 填入到指令内容里，例如：总结以下内容："+E(u.划词内容),1)]),m(V,{class:"mt-2",type:"textarea",rows:5,resize:"none"})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),Bl={class:"border h-[310px] rounded-md flex-center flex-col gap-3"},Xl={class:"text-sm text-[#9A9A9A]"},Yl=K({__name:"about",setup(e){const t=R(""),i=()=>{window.$chat53ai.$updater({type:"check"}).then(s=>{s||oe.success(window.$t("updater.noUpdate"))})};return Se(()=>{window.$chat53ai.$updater({type:"version"}).then(s=>{t.value=s})}),(s,l)=>{const n=ae;return y(),T("div",Bl,[l[0]||(l[0]=p("img",{class:"w-[68px]",src:"https://chat.53ai.com/images/logo-square.png",alt:""},null,-1)),l[1]||(l[1]=p("h2",{class:"text-base text-[#1D1E1F]"},"53AI 魔法菜单",-1)),p("p",Xl,E(s.$t("updater.currentVersion",{version:t.value})),1),m(n,{type:"primary",onClick:i},{default:g(()=>[N(E(s.$t("updater.checkUpdate")),1)]),_:1})])}}}),Fl={class:"h-10 flex items-center justify-between px-4 border rounded-md"},Dl={class:"h-10 flex items-center justify-between px-4 border rounded-md mt-2"},Ul=K({__name:"common",setup(e){const t=wt();return(i,s)=>{const l=_t,n=yl,o=wl,r=ve;return y(),T(J,null,[s[6]||(s[6]=p("div",{class:"flex items-center justify-between pb-3"},[p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"通用设置")],-1)),p("div",Fl,[s[4]||(s[4]=p("div",{class:"text-sm text-[#1D1E1F]"},"开机自动启动",-1)),m(l,{modelValue:w(t).boot_up_enabled,"onUpdate:modelValue":s[0]||(s[0]=c=>w(t).boot_up_enabled=c)},null,8,["modelValue"])]),p("div",Dl,[s[5]||(s[5]=p("div",{class:"text-sm text-[#1D1E1F]"},"设置为默认浏览器",-1)),m(l,{modelValue:w(t).default_browser_enabled,"onUpdate:modelValue":s[1]||(s[1]=c=>w(t).default_browser_enabled=c)},null,8,["modelValue"])]),s[7]||(s[7]=p("div",{class:"flex items-center justify-between py-3 mt-2"},[p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"默认搜索引擎")],-1)),m(o,{modelValue:w(t).default_search_url,"onUpdate:modelValue":s[2]||(s[2]=c=>w(t).default_search_url=c),size:"large"},{default:g(()=>[m(n,{label:"百度",value:"https://www.baidu.com/s?wd=_word_"}),m(n,{label:"百度AI",value:"https://chat.baidu.com/search?word=_word_"})]),_:1},8,["modelValue"]),s[8]||(s[8]=p("div",{class:"flex items-center justify-between py-3 mt-2"},[p("div",{class:"text-[#1D1E1F] text-sm font-semibold"},"新标签页设置")],-1)),m(r,{size:"large",modelValue:w(t).default_tab_url,"onUpdate:modelValue":s[3]||(s[3]=c=>w(t).default_tab_url=c),placeholder:"请填写新标签页url"},null,8,["modelValue"])],64)}}}),Kl=K({__name:"password",props:{hideSubmit:{type:Boolean,default:!1}},emits:["success"],setup(e,{emit:t}){const i=t,s=R(null),l=se({newPassword:"",confirmPassword:""}),n=se({newPassword:[Te()],confirmPassword:[{required:!0,message:window.$t("form.input_placeholder")+window.$t("form.new_password_confirm"),trigger:"blur"},{validator:(r,c,u)=>{c!==l.newPassword?u(new Error(window.$t("form.password_not_match"))):u()},trigger:"blur"}]}),o=()=>s.value.validate().then(async r=>{r&&(console.log("valid"),await Yo.updatePassword({new_password:l.newPassword,confirm_password:l.confirmPassword}).then(()=>{oe.success(window.$t("status.success")),i("success")}))});return(r,c)=>{const u=ds,a=us,v=He,h=ve,f=ae,I=Re,_=ae,$=de("trim"),S=de("debounce");return y(),T(J,null,[m(I,{ref_key:"formRef",ref:s,"label-position":"top",model:l,rules:n},{default:g(()=>[P("",!0),m(v,{label:r.$t("form.new_password"),prop:"newPassword"},{default:g(()=>[U(m(h,{modelValue:l.newPassword,"onUpdate:modelValue":c[0]||(c[0]=b=>l.newPassword=b),type:"password",size:"large","show-password":"",clearable:""},null,8,["modelValue"]),[[$]])]),_:1},8,["label"]),m(v,{label:r.$t("form.new_password_confirm"),prop:"confirmPassword"},{default:g(()=>[U(m(h,{modelValue:l.confirmPassword,"onUpdate:modelValue":c[1]||(c[1]=b=>l.confirmPassword=b),type:"password",size:"large","show-password":"",clearable:""},null,8,["modelValue"]),[[$]])]),_:1},8,["label"])]),_:1},8,["model","rules"]),r.hideSubmit?P("",!0):U((y(),H(_,{key:0,class:"!w-full rounded-3xl mt-5",size:"large",type:"primary",disabled:!l.newPassword.trim()||!l.confirmPassword.trim(),onClick:o},{default:g(()=>[N(E(r.$t("action.update_password")),1)]),_:1},8,["disabled"])),[[S]])],64)}}}),Cs={};Cs.getData=e=>new Promise((t,i)=>{let s={};Gl(e).then(l=>{s.arrayBuffer=l;try{s.orientation=Zl(l)}catch{s.orientation=-1}t(s)}).catch(l=>{i(l)})});function Gl(e){let t=null;return new Promise((i,s)=>{if(e.src)if(/^data\:/i.test(e.src))t=jl(e.src),i(t);else if(/^blob\:/i.test(e.src)){var l=new FileReader;l.onload=function(o){t=o.target.result,i(t)},ql(e.src,function(o){l.readAsArrayBuffer(o)})}else{var n=new XMLHttpRequest;n.onload=function(){if(this.status==200||this.status===0)t=n.response,i(t);else throw"Could not load image";n=null},n.open("GET",e.src,!0),n.responseType="arraybuffer",n.send(null)}else s("img error")})}function ql(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(s){(this.status==200||this.status===0)&&t(this.response)},i.send()}function jl(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/mi)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gmi,"");for(var i=atob(e),s=i.length%2==0?i.length:i.length+1,l=new ArrayBuffer(s),n=new Uint16Array(l),o=0;o<s;o++)n[o]=i.charCodeAt(o);return l}function Ql(e,t,i){var s="",l;for(l=t,i+=t;l<i;l++)s+=String.fromCharCode(e.getUint8(l));return s}function Zl(e){var t=new DataView(e),i=t.byteLength,s,l,n,o,r,c,u,a,v,h;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(v=2;v<i;){if(t.getUint8(v)===255&&t.getUint8(v+1)===225){u=v;break}v++}if(u&&(l=u+4,n=u+10,Ql(t,l,4)==="Exif"&&(c=t.getUint16(n),r=c===18761,(r||c===19789)&&t.getUint16(n+2,r)===42&&(o=t.getUint32(n+4,r),o>=8&&(a=n+o)))),a){for(i=t.getUint16(a,r),h=0;h<i;h++)if(v=a+h*12+2,t.getUint16(v,r)===274){v+=8,s=t.getUint16(v,r);break}}return s}const Jl=(e,t)=>{const i=e.__vccOpts||e;for(const[s,l]of t)i[s]=l;return i},en=K({data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0,imgIsQqualCrop:!1}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:()=>[1,1]},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:()=>10,validator:function(e){return Array.isArray(e)?Number(e[0])>=0&&Number(e[1])>=0:Number(e)>=0}},fillColor:{type:String,default:""}},computed:{cropInfo(){let e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){let t=1;this.high&&!this.full&&(t=window.devicePixelRatio),this.enlarge!==1&!this.full&&(t=Math.abs(Number(this.enlarge))),e.width=e.width*t,e.height=e.height*t,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE(){return!!window.ActiveXObject||"ActiveXObject"in window},passive(){return this.isIE?null:{passive:!1}},isRotateRightOrLeft(){return[1,-1,3,-3].includes(this.rotate)}},watch:{img(){this.checkedImg()},imgs(e){e!==""&&this.reload()},cropW(){this.showPreview()},cropH(){this.showPreview()},cropOffsertX(){this.showPreview()},cropOffsertY(){this.showPreview()},scale(e,t){this.showPreview()},x(){this.showPreview()},y(){this.showPreview()},autoCrop(e){e&&this.goAutoCrop()},autoCropWidth(){this.autoCrop&&this.goAutoCrop()},autoCropHeight(){this.autoCrop&&this.goAutoCrop()},mode(){this.checkedImg()},rotate(){this.showPreview(),this.autoCrop?this.goAutoCrop(this.cropW,this.cropH):(this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion(e){var t=navigator.userAgent.split(" "),i="";let s=0;const l=new RegExp(e,"i");for(var n=0;n<t.length;n++)l.test(t[n])&&(i=t[n]);return i?s=i.split("/")[1].split("."):s=["0","0","0"],s},checkOrientationImage(e,t,i,s){if(this.getVersion("chrome")[0]>=81)t=-1;else if(this.getVersion("safari")[0]>=605){const o=this.getVersion("version");o[0]>13&&o[1]>1&&(t=-1)}else{const o=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(o){let r=o[1];r=r.split("_"),(r[0]>13||r[0]>=13&&r[1]>=4)&&(t=-1)}}let l=document.createElement("canvas"),n=l.getContext("2d");switch(n.save(),t){case 2:l.width=i,l.height=s,n.translate(i,0),n.scale(-1,1);break;case 3:l.width=i,l.height=s,n.translate(i/2,s/2),n.rotate(180*Math.PI/180),n.translate(-i/2,-s/2);break;case 4:l.width=i,l.height=s,n.translate(0,s),n.scale(1,-1);break;case 5:l.height=i,l.width=s,n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:l.width=s,l.height=i,n.translate(s/2,i/2),n.rotate(90*Math.PI/180),n.translate(-i/2,-s/2);break;case 7:l.height=i,l.width=s,n.rotate(.5*Math.PI),n.translate(i,-s),n.scale(-1,1);break;case 8:l.height=i,l.width=s,n.translate(s/2,i/2),n.rotate(-90*Math.PI/180),n.translate(-i/2,-s/2);break;default:l.width=i,l.height=s}n.drawImage(e,0,0,i,s),n.restore(),l.toBlob(o=>{let r=URL.createObjectURL(o);URL.revokeObjectURL(this.imgs),this.imgs=r},"image/"+this.outputType,1)},checkedImg(){if(this.img===null||this.img===""){this.imgs="",this.clearCrop();return}this.loading=!0,this.scale=1,this.rotate=0,this.imgIsQqualCrop=!1,this.clearCrop();let e=new Image;if(e.onload=()=>{if(this.img==="")return this.$emit("img-load",new Error("图片不能为空")),!1;let i=e.width,s=e.height;Cs.getData(e).then(l=>{this.orientation=l.orientation||1;let n=Number(this.maxImgSize);if(!this.orientation&&i<n&s<n){this.imgs=this.img;return}i>n&&(s=s/i*n,i=n),s>n&&(i=i/s*n,s=n),this.checkOrientationImage(e,this.orientation,i,s)}).catch(l=>{this.$emit("img-load","error"),this.$emit("img-load-error",l)})},e.onerror=i=>{this.$emit("img-load","error"),this.$emit("img-load-error",i)},this.img.substr(0,4)!=="data"&&(e.crossOrigin=""),this.isIE){var t=new XMLHttpRequest;t.onload=function(){var i=URL.createObjectURL(this.response);e.src=i},t.open("GET",this.img,!0),t.responseType="blob",t.send()}else e.src=this.img},startMove(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),e.touches.length==2&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale(e){e.preventDefault();let t=this.scale;var i={x:this.touches[0].clientX,y:this.touches[0].clientY},s={x:e.touches[0].clientX,y:e.touches[0].clientY},l={x:this.touches[1].clientX,y:this.touches[1].clientY},n={x:e.touches[1].clientX,y:e.touches[1].clientY},o=Math.sqrt(Math.pow(i.x-l.x,2)+Math.pow(i.y-l.y,2)),r=Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2)),c=r-o,u=1;u=u/this.trueWidth>u/this.trueHeight?u/this.trueHeight:u/this.trueWidth,u=u>.1?.1:u;var a=u*c;if(!this.touchNow){if(this.touchNow=!0,c>0?t+=Math.abs(a):c<0&&t>Math.abs(a)&&(t-=Math.abs(a)),this.touches=e.touches,setTimeout(()=>{this.touchNow=!1},8),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t}},cancelTouchScale(e){window.removeEventListener("touchmove",this.touchScale)},moveImg(e){if(e.preventDefault(),e.touches&&e.touches.length===2)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;let t="clientX"in e?e.clientX:e.touches[0].clientX,i="clientY"in e?e.clientY:e.touches[0].clientY,s,l;s=t-this.moveX,l=i-this.moveY,this.$nextTick(()=>{if(this.centerBox){let n=this.getImgAxis(s,l,this.scale),o=this.getCropAxis(),r=this.trueHeight*this.scale,c=this.trueWidth*this.scale,u,a,v,h;switch(this.rotate){case 1:case-1:case 3:case-3:u=this.cropOffsertX-this.trueWidth*(1-this.scale)/2+(r-c)/2,a=this.cropOffsertY-this.trueHeight*(1-this.scale)/2+(c-r)/2,v=u-r+this.cropW,h=a-c+this.cropH;break;default:u=this.cropOffsertX-this.trueWidth*(1-this.scale)/2,a=this.cropOffsertY-this.trueHeight*(1-this.scale)/2,v=u-c+this.cropW,h=a-r+this.cropH;break}n.x1>=o.x1&&(s=u),n.y1>=o.y1&&(l=a),n.x2<=o.x2&&(s=v),n.y2<=o.y2&&(l=h)}this.x=s,this.y=l,this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})})},leaveImg(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize(e){e.preventDefault();let t=this.scale;var i=e.deltaY||e.wheelDelta,s=navigator.userAgent.indexOf("Firefox");i=s>0?i*30:i,this.isIE&&(i=-i);var l=this.coe;l=l/this.trueWidth>l/this.trueHeight?l/this.trueHeight:l/this.trueWidth;var n=l*i;n<0?t+=Math.abs(n):t>Math.abs(n)&&(t-=Math.abs(n));let o=n<0?"add":"reduce";if(o!==this.coeStatus&&(this.coeStatus=o,this.coe=.2),this.scaling||(this.scalingSet=setTimeout(()=>{this.scaling=!1,this.coe=this.coe+=.01},50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},changeScale(e){let t=this.scale;e=e||1;var i=20;if(i=i/this.trueWidth>i/this.trueHeight?i/this.trueHeight:i/this.trueWidth,e=e*i,e>0?t+=Math.abs(e):t>Math.abs(e)&&(t-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},createCrop(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,i="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick(()=>{var s=t-this.cropX,l=i-this.cropY;if(s>0?(this.cropW=s+this.cropChangeX>this.w?this.w-this.cropChangeX:s,this.cropOffsertX=this.cropChangeX):(this.cropW=this.w-this.cropChangeX+Math.abs(s)>this.w?this.cropChangeX:Math.abs(s),this.cropOffsertX=this.cropChangeX+s>0?this.cropChangeX+s:0),!this.fixed)l>0?(this.cropH=l+this.cropChangeY>this.h?this.h-this.cropChangeY:l,this.cropOffsertY=this.cropChangeY):(this.cropH=this.h-this.cropChangeY+Math.abs(l)>this.h?this.cropChangeY:Math.abs(l),this.cropOffsertY=this.cropChangeY+l>0?this.cropChangeY+l:0);else{var n=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];n+this.cropOffsertY>this.h?(this.cropH=this.h-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],s>0?this.cropOffsertX=this.cropChangeX:this.cropOffsertX=this.cropChangeX-this.cropW):this.cropH=n,this.cropOffsertY=this.cropOffsertY}})},changeCropSize(e,t,i,s,l){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=t,this.canChangeY=i,this.changeCropTypeX=s,this.changeCropTypeY=l,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,i="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;let s=this.w,l=this.h,n=0,o=0;if(this.centerBox){let u=this.getImgAxis(),a=u.x2,v=u.y2;n=u.x1>0?u.x1:0,o=u.y1>0?u.y1:0,s>a&&(s=a),l>v&&(l=v)}const[r,c]=this.checkCropLimitSize();this.$nextTick(()=>{var u=t-this.cropX,a=i-this.cropY;if(this.canChangeX&&(this.changeCropTypeX===1?this.cropOldW-u<r?(this.cropW=r,this.cropOffsertX=this.cropOldW+this.cropChangeX-n-r):this.cropOldW-u>0?(this.cropW=s-this.cropChangeX-u<=s-n?this.cropOldW-u:this.cropOldW+this.cropChangeX-n,this.cropOffsertX=s-this.cropChangeX-u<=s-n?this.cropChangeX+u:n):(this.cropW=Math.abs(u)+this.cropChangeX<=s?Math.abs(u)-this.cropOldW:s-this.cropOldW-this.cropChangeX,this.cropOffsertX=this.cropChangeX+this.cropOldW):this.changeCropTypeX===2&&(this.cropOldW+u<r?this.cropW=r:this.cropOldW+u>0?(this.cropW=this.cropOldW+u+this.cropOffsertX<=s?this.cropOldW+u:s-this.cropOffsertX,this.cropOffsertX=this.cropChangeX):(this.cropW=s-this.cropChangeX+Math.abs(u+this.cropOldW)<=s-n?Math.abs(u+this.cropOldW):this.cropChangeX-n,this.cropOffsertX=s-this.cropChangeX+Math.abs(u+this.cropOldW)<=s-n?this.cropChangeX-Math.abs(u+this.cropOldW):n))),this.canChangeY&&(this.changeCropTypeY===1?this.cropOldH-a<c?(this.cropH=c,this.cropOffsertY=this.cropOldH+this.cropChangeY-o-c):this.cropOldH-a>0?(this.cropH=l-this.cropChangeY-a<=l-o?this.cropOldH-a:this.cropOldH+this.cropChangeY-o,this.cropOffsertY=l-this.cropChangeY-a<=l-o?this.cropChangeY+a:o):(this.cropH=Math.abs(a)+this.cropChangeY<=l?Math.abs(a)-this.cropOldH:l-this.cropOldH-this.cropChangeY,this.cropOffsertY=this.cropChangeY+this.cropOldH):this.changeCropTypeY===2&&(this.cropOldH+a<c?this.cropH=c:this.cropOldH+a>0?(this.cropH=this.cropOldH+a+this.cropOffsertY<=l?this.cropOldH+a:l-this.cropOffsertY,this.cropOffsertY=this.cropChangeY):(this.cropH=l-this.cropChangeY+Math.abs(a+this.cropOldH)<=l-o?Math.abs(a+this.cropOldH):this.cropChangeY-o,this.cropOffsertY=l-this.cropChangeY+Math.abs(a+this.cropOldH)<=l-o?this.cropChangeY-Math.abs(a+this.cropOldH):o))),this.canChangeX&&this.fixed){var v=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];v<c?(this.cropH=c,this.cropW=this.fixedNumber[0]*c/this.fixedNumber[1],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):v+this.cropOffsertY>l?(this.cropH=l-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],this.changeCropTypeX===1&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):this.cropH=v}if(this.canChangeY&&this.fixed){var h=this.cropH/this.fixedNumber[1]*this.fixedNumber[0];h<r?(this.cropW=r,this.cropH=this.fixedNumber[1]*r/this.fixedNumber[0],this.cropOffsertY=this.cropOldH+this.cropChangeY-this.cropH):h+this.cropOffsertX>s?(this.cropW=s-this.cropOffsertX,this.cropH=this.cropW/this.fixedNumber[0]*this.fixedNumber[1]):this.cropW=h}})},checkCropLimitSize(){let{cropW:e,cropH:t,limitMinSize:i}=this,s=new Array;return Array.isArray(i)?s=i:s=[i,i],e=parseFloat(s[0]),t=parseFloat(s[1]),[e,t]},changeCropEnd(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},calculateSize(e,t,i,s,l,n){const o=e/t;let r=l,c=n;return r<i&&(r=i,c=Math.ceil(r/o)),c<s&&(c=s,r=Math.ceil(c*o),r<i&&(r=i,c=Math.ceil(r/o))),r<l&&(r=l,c=Math.ceil(r/o)),c<n&&(c=n,r=Math.ceil(c*o)),{width:r,height:c}},endCrop(){this.cropW===0&&this.cropH===0&&(this.cropping=!1);let[e,t]=this.checkCropLimitSize();const{width:i,height:s}=this.fixed?this.calculateSize(this.fixedNumber[0],this.fixedNumber[1],e,t,this.cropW,this.cropH):{width:e,height:t};i>this.cropW&&(this.cropW=i,this.cropOffsertX+i>this.w&&(this.cropOffsertX=this.w-i)),s>this.cropH&&(this.cropH=s,this.cropOffsertY+s>this.h&&(this.cropOffsertY=this.h-s)),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop(){this.crop=!0},stopCrop(){this.crop=!1},clearCrop(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&e.touches.length===2)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);let t="clientX"in e?e.clientX:e.touches[0].clientX,i="clientY"in e?e.clientY:e.touches[0].clientY,s,l;s=t-this.cropOffsertX,l=i-this.cropOffsertY,this.cropX=s,this.cropY=l,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop(e,t){let i=0,s=0;e&&(e.preventDefault(),i="clientX"in e?e.clientX:e.touches[0].clientX,s="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick(()=>{let l,n,o=i-this.cropX,r=s-this.cropY;if(t&&(o=this.cropOffsertX,r=this.cropOffsertY),o<=0?l=0:o+this.cropW>this.w?l=this.w-this.cropW:l=o,r<=0?n=0:r+this.cropH>this.h?n=this.h-this.cropH:n=r,this.centerBox){let c=this.getImgAxis();l<=c.x1&&(l=c.x1),l+this.cropW>c.x2&&(l=c.x2-this.cropW),n<=c.y1&&(n=c.y1),n+this.cropH>c.y2&&(n=c.y2-this.cropH)}this.cropOffsertX=l,this.cropOffsertY=n,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})})},getImgAxis(e,t,i){e=e||this.x,t=t||this.y,i=i||this.scale;let s={x1:0,x2:0,y1:0,y2:0},l=this.trueWidth*i,n=this.trueHeight*i;switch(this.rotate){case 0:s.x1=e+this.trueWidth*(1-i)/2,s.x2=s.x1+this.trueWidth*i,s.y1=t+this.trueHeight*(1-i)/2,s.y2=s.y1+this.trueHeight*i;break;case 1:case-1:case 3:case-3:s.x1=e+this.trueWidth*(1-i)/2+(l-n)/2,s.x2=s.x1+this.trueHeight*i,s.y1=t+this.trueHeight*(1-i)/2+(n-l)/2,s.y2=s.y1+this.trueWidth*i;break;default:s.x1=e+this.trueWidth*(1-i)/2,s.x2=s.x1+this.trueWidth*i,s.y1=t+this.trueHeight*(1-i)/2,s.y2=s.y1+this.trueHeight*i;break}return s},getCropAxis(){let e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked(e){let t=document.createElement("canvas"),i=t.getContext("2d"),s=new Image,l=this.rotate,n=this.trueWidth,o=this.trueHeight,r=this.cropOffsertX,c=this.cropOffsertY;s.onload=()=>{if(this.cropW!==0){let h=1;this.high&!this.full&&(h=window.devicePixelRatio),this.enlarge!==1&!this.full&&(h=Math.abs(Number(this.enlarge)));let f=this.cropW*h,I=this.cropH*h,_=n*this.scale*h,$=o*this.scale*h,S=(this.x-r+this.trueWidth*(1-this.scale)/2)*h,b=(this.y-c+this.trueHeight*(1-this.scale)/2)*h;switch(v(f,I),i.save(),l){case 0:this.full?(v(f/this.scale,I/this.scale),i.drawImage(s,S/this.scale,b/this.scale,_/this.scale,$/this.scale)):i.drawImage(s,S,b,_,$);break;case 1:case-3:this.full?(v(f/this.scale,I/this.scale),S=S/this.scale+(_/this.scale-$/this.scale)/2,b=b/this.scale+($/this.scale-_/this.scale)/2,i.rotate(l*90*Math.PI/180),i.drawImage(s,b,-S-$/this.scale,_/this.scale,$/this.scale)):(S=S+(_-$)/2,b=b+($-_)/2,i.rotate(l*90*Math.PI/180),i.drawImage(s,b,-S-$,_,$));break;case 2:case-2:this.full?(v(f/this.scale,I/this.scale),i.rotate(l*90*Math.PI/180),S=S/this.scale,b=b/this.scale,i.drawImage(s,-S-_/this.scale,-b-$/this.scale,_/this.scale,$/this.scale)):(i.rotate(l*90*Math.PI/180),i.drawImage(s,-S-_,-b-$,_,$));break;case 3:case-1:this.full?(v(f/this.scale,I/this.scale),S=S/this.scale+(_/this.scale-$/this.scale)/2,b=b/this.scale+($/this.scale-_/this.scale)/2,i.rotate(l*90*Math.PI/180),i.drawImage(s,-b-_/this.scale,S,_/this.scale,$/this.scale)):(S=S+(_-$)/2,b=b+($-_)/2,i.rotate(l*90*Math.PI/180),i.drawImage(s,-b-_,S,_,$));break;default:this.full?(v(f/this.scale,I/this.scale),i.drawImage(s,S/this.scale,b/this.scale,_/this.scale,$/this.scale)):i.drawImage(s,S,b,_,$)}i.restore()}else{let h=n*this.scale,f=o*this.scale;switch(i.save(),l){case 0:v(h,f),i.drawImage(s,0,0,h,f);break;case 1:case-3:v(f,h),i.rotate(l*90*Math.PI/180),i.drawImage(s,0,-f,h,f);break;case 2:case-2:v(h,f),i.rotate(l*90*Math.PI/180),i.drawImage(s,-h,-f,h,f);break;case 3:case-1:v(f,h),i.rotate(l*90*Math.PI/180),i.drawImage(s,-h,0,h,f);break;default:v(h,f),i.drawImage(s,0,0,h,f)}i.restore()}e(t)};var u=this.img.substr(0,4);u!=="data"&&(s.crossOrigin="Anonymous"),s.src=this.imgs;const a=this.fillColor;function v(h,f){t.width=Math.round(h),t.height=Math.round(f),a&&(i.fillStyle=a,i.fillRect(0,0,t.width,t.height))}},getCropData(e){this.getCropChecked(t=>{e(t.toDataURL("image/"+this.outputType,this.outputSize))})},getCropBlob(e){this.getCropChecked(t=>{t.toBlob(i=>e(i),"image/"+this.outputType,this.outputSize)})},showPreview(){if(this.isCanShow)this.isCanShow=!1,setTimeout(()=>{this.isCanShow=!0},16);else return!1;let e=this.cropW,t=this.cropH,i=this.scale;var s={};s.div={width:`${e}px`,height:`${t}px`};let l=(this.x-this.cropOffsertX)/i,n=(this.y-this.cropOffsertY)/i,o=0;s.w=e,s.h=t,s.url=this.imgs,s.img={width:`${this.trueWidth}px`,height:`${this.trueHeight}px`,transform:`scale(${i})translate3d(${l}px, ${n}px, ${o}px)rotateZ(${this.rotate*90}deg)`},s.html=`
      <div class="show-preview" style="width: ${s.w}px; height: ${s.h}px,; overflow: hidden">
        <div style="width: ${e}px; height: ${t}px">
          <img src=${s.url} style="width: ${this.trueWidth}px; height: ${this.trueHeight}px; transform:
          scale(${i})translate3d(${l}px, ${n}px, ${o}px)rotateZ(${this.rotate*90}deg)">
        </div>
      </div>`,this.$emit("real-time",s)},reload(){let e=new Image;e.onload=()=>{this.w=parseFloat(window.getComputedStyle(this.$refs.cropper).width),this.h=parseFloat(window.getComputedStyle(this.$refs.cropper).height),this.trueWidth=e.width,this.trueHeight=e.height,this.original?this.scale=1:this.scale=this.checkedMode(),this.$nextTick(()=>{this.x=-(this.trueWidth-this.trueWidth*this.scale)/2+(this.w-this.trueWidth*this.scale)/2,this.y=-(this.trueHeight-this.trueHeight*this.scale)/2+(this.h-this.trueHeight*this.scale)/2,this.loading=!1,this.autoCrop&&this.goAutoCrop(),this.$emit("img-load","success"),setTimeout(()=>{this.showPreview()},20)})},e.onerror=()=>{this.$emit("img-load","error")},e.src=this.imgs},checkedMode(){let e=1,t=this.trueWidth,i=this.trueHeight;const s=this.mode.split(" ");switch(s[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":t=this.w,e=t/this.trueWidth,i=i*e,i<this.h&&(i=this.h,e=i/this.trueHeight);break;default:try{let l=s[0];if(l.search("px")!==-1){l=l.replace("px",""),t=parseFloat(l);const n=t/this.trueWidth;let o=1,r=s[1];r.search("px")!==-1&&(r=r.replace("px",""),i=parseFloat(r),o=i/this.trueHeight),e=Math.min(n,o)}if(l.search("%")!==-1&&(l=l.replace("%",""),t=parseFloat(l)/100*this.w,e=t/this.trueWidth),s.length===2&&l==="auto"){let n=s[1];n.search("px")!==-1&&(n=n.replace("px",""),i=parseFloat(n),e=i/this.trueHeight),n.search("%")!==-1&&(n=n.replace("%",""),i=parseFloat(n)/100*this.h,e=i/this.trueHeight)}}catch{e=1}}return e},goAutoCrop(e,t){if(this.imgs===""||this.imgs===null)return;this.clearCrop(),this.cropping=!0;let i=this.w,s=this.h;if(this.centerBox){const o=Math.abs(this.rotate)%2>0;let r=(o?this.trueHeight:this.trueWidth)*this.scale,c=(o?this.trueWidth:this.trueHeight)*this.scale;i=r<i?r:i,s=c<s?c:s}var l=e||parseFloat(this.autoCropWidth),n=t||parseFloat(this.autoCropHeight);(l===0||n===0)&&(l=i*.8,n=s*.8),l=l>i?i:l,n=n>s?s:n,this.fixed&&(n=l/this.fixedNumber[0]*this.fixedNumber[1]),n>this.h&&(n=this.h,l=n/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(l,n)},changeCrop(e,t){if(this.centerBox){let i=this.getImgAxis();e>i.x2-i.x1&&(e=i.x2-i.x1,t=e/this.fixedNumber[0]*this.fixedNumber[1]),t>i.y2-i.y1&&(t=i.y2-i.y1,e=t/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=t,this.checkCropLimitSize(),this.$nextTick(()=>{this.cropOffsertX=(this.w-this.cropW)/2,this.cropOffsertY=(this.h-this.cropH)/2,this.centerBox&&this.moveCrop(null,!0)})},refresh(){this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.imgIsQqualCrop=!1,this.clearCrop(),this.$nextTick(()=>{this.checkedImg()})},rotateLeft(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear(){this.rotate=0},checkoutImgAxis(e,t,i){e=e||this.x,t=t||this.y,i=i||this.scale;let s=!0;if(this.centerBox){let l=this.getImgAxis(e,t,i),n=this.getCropAxis();l.x1>=n.x1&&(s=!1),l.x2<=n.x2&&(s=!1),l.y1>=n.y1&&(s=!1),l.y2<=n.y2&&(s=!1),s||this.changeImgScale(l,n,i)}return s},changeImgScale(e,t,i){let s=this.trueWidth,l=this.trueHeight,n=s*i,o=l*i;if(n>=this.cropW&&o>=this.cropH)this.scale=i;else{const r=this.cropW/s,c=this.cropH/l,u=this.cropH<=l*r?r:c;this.scale=u,n=s*u,o=l*u}this.imgIsQqualCrop||(e.x1>=t.x1&&(this.isRotateRightOrLeft?this.x=t.x1-(s-n)/2-(n-o)/2:this.x=t.x1-(s-n)/2),e.x2<=t.x2&&(this.isRotateRightOrLeft?this.x=t.x1-(s-n)/2-(n-o)/2-o+this.cropW:this.x=t.x2-(s-n)/2-n),e.y1>=t.y1&&(this.isRotateRightOrLeft?this.y=t.y1-(l-o)/2-(o-n)/2:this.y=t.y1-(l-o)/2),e.y2<=t.y2&&(this.isRotateRightOrLeft?this.y=t.y2-(l-o)/2-(o-n)/2-n:this.y=t.y2-(l-o)/2-o)),(n<this.cropW||o<this.cropH)&&(this.imgIsQqualCrop=!0)}},mounted(){this.support="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";let e=this;var t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(i,s,l){for(var n=atob(this.toDataURL(s,l).split(",")[1]),o=n.length,r=new Uint8Array(o),c=0;c<o;c++)r[c]=n.charCodeAt(c);i(new Blob([r],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},unmounted(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}}),tn={key:0,class:"cropper-box"},sn=["src"],on={class:"cropper-view-box"},ln=["src"],nn={key:1};function an(e,t,i,s,l,n){return y(),T("div",{class:"vue-cropper",ref:"cropper",onMouseover:t[28]||(t[28]=(...o)=>e.scaleImg&&e.scaleImg(...o)),onMouseout:t[29]||(t[29]=(...o)=>e.cancelScale&&e.cancelScale(...o))},[e.imgs?(y(),T("div",tn,[U(p("div",{class:"cropper-box-canvas",style:Z({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"})},[p("img",{src:e.imgs,alt:"cropper-img",ref:"cropperImg"},null,8,sn)],4),[[We,!e.loading]])])):P("",!0),p("div",{class:L(["cropper-drag-box",{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping}]),onMousedown:t[0]||(t[0]=(...o)=>e.startMove&&e.startMove(...o)),onTouchstart:t[1]||(t[1]=(...o)=>e.startMove&&e.startMove(...o))},null,34),U(p("div",{class:"cropper-crop-box",style:Z({width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"})},[p("span",on,[p("img",{style:Z({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+e.rotate*90+"deg)"}),src:e.imgs,alt:"cropper-img"},null,12,ln)]),p("span",{class:"cropper-face cropper-move",onMousedown:t[2]||(t[2]=(...o)=>e.cropMove&&e.cropMove(...o)),onTouchstart:t[3]||(t[3]=(...o)=>e.cropMove&&e.cropMove(...o))},null,32),e.info?(y(),T("span",{key:0,class:"crop-info",style:Z({top:e.cropInfo.top})},E(e.cropInfo.width)+" × "+E(e.cropInfo.height),5)):P("",!0),e.fixedBox?P("",!0):(y(),T("span",nn,[p("span",{class:"crop-line line-w",onMousedown:t[4]||(t[4]=o=>e.changeCropSize(o,!1,!0,0,1)),onTouchstart:t[5]||(t[5]=o=>e.changeCropSize(o,!1,!0,0,1))},null,32),p("span",{class:"crop-line line-a",onMousedown:t[6]||(t[6]=o=>e.changeCropSize(o,!0,!1,1,0)),onTouchstart:t[7]||(t[7]=o=>e.changeCropSize(o,!0,!1,1,0))},null,32),p("span",{class:"crop-line line-s",onMousedown:t[8]||(t[8]=o=>e.changeCropSize(o,!1,!0,0,2)),onTouchstart:t[9]||(t[9]=o=>e.changeCropSize(o,!1,!0,0,2))},null,32),p("span",{class:"crop-line line-d",onMousedown:t[10]||(t[10]=o=>e.changeCropSize(o,!0,!1,2,0)),onTouchstart:t[11]||(t[11]=o=>e.changeCropSize(o,!0,!1,2,0))},null,32),p("span",{class:"crop-point point1",onMousedown:t[12]||(t[12]=o=>e.changeCropSize(o,!0,!0,1,1)),onTouchstart:t[13]||(t[13]=o=>e.changeCropSize(o,!0,!0,1,1))},null,32),p("span",{class:"crop-point point2",onMousedown:t[14]||(t[14]=o=>e.changeCropSize(o,!1,!0,0,1)),onTouchstart:t[15]||(t[15]=o=>e.changeCropSize(o,!1,!0,0,1))},null,32),p("span",{class:"crop-point point3",onMousedown:t[16]||(t[16]=o=>e.changeCropSize(o,!0,!0,2,1)),onTouchstart:t[17]||(t[17]=o=>e.changeCropSize(o,!0,!0,2,1))},null,32),p("span",{class:"crop-point point4",onMousedown:t[18]||(t[18]=o=>e.changeCropSize(o,!0,!1,1,0)),onTouchstart:t[19]||(t[19]=o=>e.changeCropSize(o,!0,!1,1,0))},null,32),p("span",{class:"crop-point point5",onMousedown:t[20]||(t[20]=o=>e.changeCropSize(o,!0,!1,2,0)),onTouchstart:t[21]||(t[21]=o=>e.changeCropSize(o,!0,!1,2,0))},null,32),p("span",{class:"crop-point point6",onMousedown:t[22]||(t[22]=o=>e.changeCropSize(o,!0,!0,1,2)),onTouchstart:t[23]||(t[23]=o=>e.changeCropSize(o,!0,!0,1,2))},null,32),p("span",{class:"crop-point point7",onMousedown:t[24]||(t[24]=o=>e.changeCropSize(o,!1,!0,0,2)),onTouchstart:t[25]||(t[25]=o=>e.changeCropSize(o,!1,!0,0,2))},null,32),p("span",{class:"crop-point point8",onMousedown:t[26]||(t[26]=o=>e.changeCropSize(o,!0,!0,2,2)),onTouchstart:t[27]||(t[27]=o=>e.changeCropSize(o,!0,!0,2,2))},null,32)]))],4),[[We,e.cropping]])],544)}const rn=Jl(en,[["render",an],["__scopeId","data-v-a742df44"]]),cn={class:"cropper"},un={class:"cropper_left"},dn={class:"reupload_box"},pn={class:"cropper_right"},hn={class:"preview_text"},fn=["src"],mn={class:"dialog-footer"},vn=K({__name:"index",props:{type:{default:"systemLogo"},allowTypeList:{default:()=>["jpg","png","jpeg"]},limitSize:{default:10},fixedNumber:{default:()=>[1,1]},fixedNumberAider:{default:()=>[1,1]},previewWidth:{default:160},title:{default:"图片裁剪"},showWidth:{default:300},showHeight:{default:300},action:{default:"ibos"},uploadAvatar:{type:Boolean,default:!1}},emits:["confirm"],setup(e,{expose:t,emit:i}){const s=e,l=i,n=R(!1),o=se({img:"",autoCrop:!0,autoCropWidth:300,autoCropHeight:300,fixedBox:!1,info:!0,outputSize:1,outputType:"png",canScale:!0,fixed:!0,fixedNumber:[1,1],full:!0,canMove:!1,original:!1,centerBox:!0,infoTrue:!0,accept:"image/jpeg,image/jpg,image/png,image/gif,image/x-icon",fillColor:"transparent"}),r=R({width:"",height:""}),c=R([]),u=R({}),a=R({}),v=R(),h=R(!1),f=O=>{const M=O.name.substring(O.name.lastIndexOf(".")+1);return s.allowTypeList.includes(M)?!0:(oe.error(`仅支持${c.value.join("、")}格式的图片`),!1)},I=O=>{const{limitSize:M}=s,A=O.target.files[0];if(A.size>M*1024*1024)return oe.warning(`图片上传大小不能超过${M}MB`);const X=window.URL||window.webkitURL;f(A)&&(o.img=X.createObjectURL(A),n.value=!0)},_=()=>{a.value.refresh()},$=()=>{a.value.rotateRight()},S=O=>{const M=O||1;a.value.changeScale(M)},b=async O=>{var A;if(h.value)return;if(O==="reupload"){(A=v.value)==null||A.click();return}let M=document.createElement("input");M.type="file",M.accept=o.accept,M.onchange=I,M.click(),await le(),M=null},V=async O=>{try{return(await ri.upload(O)).data}catch{return{}}},Y=(O,M)=>{const A=O.split(","),X=A[0].match(/:(.*?);/)[1],j=atob(A[1]);let F=j.length;const B=new Uint8Array(F);for(;F--;)B[F]=j.charCodeAt(F);return new File([B],M,{type:X})},C=()=>{h.value=!0,a.value.getCropData(async O=>{const M=Y(O,"images.png"),A=await V(M).finally(()=>{h.value=!1}),X=`${Ko}/api/preview/${A.preview_key||""}`;A.url=X,l("confirm",A),n.value=!1})},k=O=>{a.value.getCropData(M=>{u.value.img=M})};return ne(()=>s,()=>{r.value={width:`${s.previewWidth}px`,height:`${s.previewWidth/s.fixedNumber[0]}px`,border:"1px solid #e8e8e8","border-radius":"2px"},c.value=[];for(let O=0;O<s.allowTypeList.length;O++)c.value.push(s.allowTypeList[O].toUpperCase())},{deep:!0,immediate:!0}),t({uploadFile:b,open(O){o.img=O,n.value=!0}}),(O,M)=>{const A=Q,X=ae,j=gt;return y(),H(j,{"model-value":n.value,title:O.$t("common.image_cropper"),width:"550px","close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":"",onClose:M[4]||(M[4]=F=>n.value=!1)},{default:g(()=>[p("div",cn,[p("div",un,[m(w(rn),{ref_key:"cropperRef",ref:a,style:Z({width:`${O.showWidth}px`,height:`${O.showHeight}px`}),img:o.img,info:!0,"info-true":o.infoTrue,"auto-crop":o.autoCrop,"fixed-box":o.fixedBox,"can-move":o.canMove,"can-scale":o.canScale,"fixed-number":O.fixedNumber,fixed:o.fixed,full:o.full,"output-type":o.outputType,"center-box":o.centerBox,"fill-color":o.fillColor,onRealTime:k},null,8,["style","img","info-true","auto-crop","fixed-box","can-move","can-scale","fixed-number","fixed","full","output-type","center-box","fill-color"]),p("div",dn,[p("div",{class:"reupload_text",onClick:M[0]||(M[0]=F=>b("reload"))},E(O.$t("action.reupload")),1),p("div",null,[m(A,{class:"rotate_right",onClick:M[1]||(M[1]=F=>S(1))},{default:g(()=>[m(w(Fo))]),_:1}),m(A,{class:"rotate_right",onClick:M[2]||(M[2]=F=>S(-1))},{default:g(()=>[m(w(Do))]),_:1}),m(A,{class:"rotate_right",onClick:$},{default:g(()=>[m(w(Uo))]),_:1})])])]),p("div",pn,[p("div",hn,E(O.$t("action.preview")),1),p("div",{style:Z(r.value),class:"previewImg"},[p("img",{style:Z(u.value.img),src:u.value.img,alt:""},null,12,fn)],4)])])]),footer:g(()=>[p("span",mn,[m(X,{size:"large",onClick:M[3]||(M[3]=F=>n.value=!1)},{default:g(()=>[N(E(O.$t("action.cancel")),1)]),_:1}),m(X,{size:"large",type:"",onClick:_},{default:g(()=>[N(E(O.$t("action.reset")),1)]),_:1}),m(X,{size:"large",type:"primary",loading:h.value,onClick:C},{default:g(()=>[N(E(O.$t("action.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["model-value","title"])}}}),gn=bt(vn,[["__scopeId","data-v-89500571"]]),bn={key:0,class:"text-base pl-3 border-ltext-[#9A9A9A] cursor-not-allowed"},wn={key:1,class:"text-base pl-3 border-l text-[#2563EB]"},yn={class:"flex justify-end mt-7.5"},_n=K({__name:"email",emits:["success","close"],setup(e,{expose:t,emit:i}){const s=i,l=Pe(),{sendEmailCode:n,emailCodeRule:o,emailCodeCount:r}=ps(),c=R(),u=W(()=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a.email)),a=se({email:"",verify_code:""}),v=W(()=>({email:[hs()],verify_code:[o]})),h=R(!1),f=()=>{u.value&&(h.value=!0,n(a.email).finally(()=>{h.value=!1}))},I=()=>{s("close")},_=()=>{var S;return(S=c.value)==null?void 0:S.validate().then(async b=>{if(b){console.log("valid");try{await l.getUserInfo();const V=l.info.user_id;await Me.verifyEmailcode({email:a.email,code:a.verify_code},V),l.info.email?oe.success(window.$t("profile.bind")+window.$t("status.success")):oe.success(window.$t("profile.change")+window.$t("status.success")),s("success")}catch{}}})};return t({resetForm:()=>{var S;a.email="",a.verify_code="",(S=c.value)==null||S.resetFields()}}),(S,b)=>{const V=ve,Y=He,C=ae,k=Re,O=de("trim");return y(),H(k,{ref_key:"formRef",ref:c,"label-position":"top",model:a,rules:v.value,"validate-on-rule-change":!0,onKeyup:ue(_,["enter"])},{default:g(()=>[m(Y,{label:S.$t("form.new_email"),prop:"email"},{default:g(()=>[U(m(V,{modelValue:a.email,"onUpdate:modelValue":b[0]||(b[0]=M=>a.email=M),size:"large",class:"input_style",placeholder:S.$t("form.input_placeholder")+S.$t("form.email"),clearable:""},null,8,["modelValue","placeholder"]),[[O]])]),_:1},8,["label"]),m(Y,{label:S.$t("form.verify_code"),prop:"verify_code"},{default:g(()=>[U((y(),H(V,{modelValue:a.verify_code,"onUpdate:modelValue":b[1]||(b[1]=M=>a.verify_code=M),size:"large",class:"input_style",placeholder:S.$t("form.input_placeholder")+S.$t("form.verify_code")},{suffix:g(()=>[m(C,{disabled:h.value||!!w(r),onClick:D(f,["stop"]),class:"!bg-[#f5f5f5] border-0 pr-0"},{default:g(()=>[w(r)?(y(),T("div",bn,E(w(r))+"s ",1)):(y(),T("div",wn,E(S.$t("form.get_verify_code")),1))]),_:1},8,["disabled"])]),_:1},8,["modelValue","placeholder"])),[[O]])]),_:1},8,["label"]),p("div",yn,[m(C,{class:"w-24 h-9",onClick:I},{default:g(()=>[N(E(S.$t("action.cancel")),1)]),_:1}),m(C,{type:"primary",onClick:_,class:"w-24 h-9"},{default:g(()=>[N(E(S.$t("action.ok")),1)]),_:1})])]),_:1},8,["model","rules"])}}}),Cn={class:"mb-2"},$n={key:0,class:"text-base pl-3 border-ltext-[#9A9A9A] cursor-not-allowed"},Sn={key:1,class:"text-base pl-3 border-l text-[#2563EB]"},xn={key:0,class:"text-base pl-3 border-ltext-[#9A9A9A] cursor-not-allowed"},On={key:1,class:"text-base pl-3 border-l text-[#2563EB]"},En=K({__name:"resetPassword",emits:["success"],setup(e,{expose:t,emit:i}){const s=i,l=Pe(),{emailCodeRule:n,sendEmailCode:o,emailCodeCount:r}=ps(),{sendcode:c,codeRule:u,codeCount:a}=ct(),v=R(),h=se({verify_code:"",new_password:"",confirm_password:""}),f=R("email_verify");l.info.email||(f.value="mobile_verify");const I=W(()=>({username:[f.value==="email_verify"?hs():fs()],new_password:[Te()],confirm_password:[Te(),Ut(h,"new_password")],verify_code:[f.value==="email_verify"?n:u]})),_=R(!1),$=()=>{f.value==="email_verify"?o(l.info.email):c(l.info.mobile),a||r?_.value=!0:_.value=!1},S=()=>{var C;return(C=v.value)==null?void 0:C.validate().then(async k=>{if(k){console.log("valid");try{f.value==="email_verify"?await l.reset_password({email:l.info.email,verify_code:h.verify_code,new_password:h.new_password,confirm_password:h.confirm_password}):(await Me.verifycode({mobile:l.info.mobile,verifycode:h.verify_code,type:"1"}),await l.reset_password({mobile:l.info.mobile,verify_code:h.verify_code,new_password:h.new_password,confirm_password:h.confirm_password})),oe.success(window.$t("status.update_success")),s("success"),V()}catch{oe.error()}}})},b=()=>{V()},V=()=>{h.verify_code="",h.new_password="",h.confirm_password="",Y()},Y=()=>{v.value&&v.value.clearValidate()};return t({resetForm:V}),(C,k)=>{const O=ds,M=us,A=ae,X=ve,j=He,F=Re,B=de("trim"),st=de("debounce");return y(),T(J,null,[p("div",Cn,[p("h3",null,E(C.$t("form.reset_password_method")),1),m(M,{modelValue:f.value,"onUpdate:modelValue":k[0]||(k[0]=re=>f.value=re),onChange:b},{default:g(()=>[m(O,{value:"email_verify",size:"large",disabled:!w(l).info.email},{default:g(()=>[N(E(C.$t("form.email_verify")),1)]),_:1},8,["disabled"]),m(O,{value:"mobile_verify",size:"large",disabled:!w(l).info.mobile},{default:g(()=>[N(E(C.$t("form.mobile_verify")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),m(F,{ref_key:"formRef",ref:v,"label-position":"top",model:h,rules:I.value,class:"mt-4",onKeyup:ue(S,["enter"])},{default:g(()=>[m(j,{label:C.$t("form.verify_code"),prop:"verify_code",rules:[f.value==="email_verify"?w(n):w(u)]},{default:g(()=>[U((y(),H(X,{modelValue:h.verify_code,"onUpdate:modelValue":k[1]||(k[1]=re=>h.verify_code=re),size:"large",class:"input_style",placeholder:C.$t("form.input_placeholder")+C.$t("form.verify_code")},{suffix:g(()=>[f.value==="mobile_verify"?(y(),H(A,{key:0,disabled:_.value,onClick:D($,["stop"]),class:"!bg-[#f5f5f5] border-0 pr-0"},{default:g(()=>[w(a)?(y(),T("div",$n,E(w(a))+"s ",1)):(y(),T("div",Sn,E(C.$t("form.get_verify_code")),1))]),_:1},8,["disabled"])):(y(),H(A,{key:1,disabled:_.value,onClick:D($,["stop"]),class:"!bg-[#f5f5f5] border-0 pr-0"},{default:g(()=>[w(r)?(y(),T("div",xn,E(w(r))+"s ",1)):(y(),T("div",On,E(C.$t("form.get_verify_code")),1))]),_:1},8,["disabled"]))]),_:1},8,["modelValue","placeholder"])),[[B]])]),_:1},8,["label","rules"]),m(j,{label:C.$t("form.new_password"),prop:"new_password",rules:[w(Te)()]},{default:g(()=>[U(m(X,{modelValue:h.new_password,"onUpdate:modelValue":k[2]||(k[2]=re=>h.new_password=re),"show-password":"",size:"large",class:"input_style",placeholder:C.$t("form.new_password_placeholder")},null,8,["modelValue","placeholder"]),[[B]])]),_:1},8,["label","rules"]),m(j,{label:C.$t("form.new_password_confirm"),prop:"confirm_password",rules:[w(Te)(),w(Ut)(h,"new_password")]},{default:g(()=>[U(m(X,{modelValue:h.confirm_password,"onUpdate:modelValue":k[3]||(k[3]=re=>h.confirm_password=re),"show-password":"",size:"large",class:"input_style",placeholder:C.$t("form.new_password_confirm_placeholder")},null,8,["modelValue","placeholder"]),[[B]])]),_:1},8,["label","rules"]),U((y(),H(A,{type:"primary",onClick:S,round:"",class:"w-full mt-3 !h-10"},{default:g(()=>[N(E(C.$t("action.update_password")),1)]),_:1})),[[st]])]),_:1},8,["model","rules"])],64)}}}),In={key:0,class:"text-base pl-3 border-ltext-[#9A9A9A] cursor-not-allowed"},kn={key:1,class:"text-base pl-3 border-l text-[#2563EB]"},Vn={key:0,class:"text-base pl-3 border-ltext-[#9A9A9A] cursor-not-allowed"},Tn={key:1,class:"text-base pl-3 border-l text-[#2563EB]"},Mn={class:"flex justify-end mt-7.5"},An=K({__name:"changeMobile",emits:["success","close"],setup(e,{expose:t,emit:i}){const s=i,l=Pe(),{sendcode:n,codeRule:o,codeCount:r}=ct(),{sendcode:c,codeRule:u,codeCount:a}=ct(),v=R(),h=W(()=>/^1[3-9]\d{9}$/.test(f.new_mobile)),f=se({old_code:"",new_mobile:"",new_code:""}),I=se({new_mobile:[fs()],old_code:[o],new_code:[u]}),_=R(!1),$=R(!1),S=()=>{n(l.info.mobile),r?_.value=!0:_.value=!1},b=()=>{h.value&&(c(f.new_mobile),a?$.value=!0:$.value=!1)},V=()=>{f.new_code="",f.old_code="",f.new_mobile="",s("close")};t({resetForm:()=>{var k;f.new_code="",f.old_code="",f.new_mobile="",(k=v.value)==null||k.resetFields()}});const C=()=>{var k;return(k=v.value)==null?void 0:k.validate().then(async O=>{if(O){console.log("valid");try{await l.getUserInfo();const M=l.info.user_id;l.info.mobile?(await Me.verifycode({mobile:l.info.mobile,verifycode:f.old_code,type:"1"}),await Me.verifycode({mobile:f.new_mobile,verifycode:f.new_code,type:"1"}),await l.change_mobile({new_code:f.new_code,new_mobile:f.new_mobile,old_code:f.old_code},M),oe.success(window.$t("profile.change")+window.$t("status.success"))):(await Me.verifycode({mobile:f.new_mobile,verifycode:f.new_code,type:"1"}),await l.change_mobile({new_code:f.new_code,new_mobile:f.new_mobile},M),oe.success(window.$t("profile.bind")+window.$t("status.success"))),f.new_code="",f.old_code="",f.new_mobile="",s("success")}catch{}}})};return(k,O)=>{const M=ae,A=ve,X=He,j=Re,F=de("trim");return y(),H(j,{ref_key:"formRef",ref:v,"label-position":"top",model:f,rules:I,"validate-on-rule-change":!0,onKeyup:ue(C,["enter"])},{default:g(()=>[w(l).info.mobile?(y(),H(X,{key:0,prop:"old_code"},{default:g(()=>[U((y(),H(A,{modelValue:f.old_code,"onUpdate:modelValue":O[0]||(O[0]=B=>f.old_code=B),size:"large",class:"input_style",placeholder:k.$t("form.input_placeholder")+k.$t("form.verify_code")},{suffix:g(()=>[m(M,{disabled:_.value,onClick:D(S,["stop"]),class:"!bg-[#f5f5f5] border-0 pr-0"},{default:g(()=>[w(r)?(y(),T("div",In,E(w(r))+"s ",1)):(y(),T("div",kn,E(k.$t("form.get_verify_code")),1))]),_:1},8,["disabled"])]),_:1},8,["modelValue","placeholder"])),[[F]])]),_:1})):P("",!0),m(X,{label:w(l).info.mobile?k.$t("form.new_mobile"):k.$t("form.mobile"),prop:"new_mobile"},{default:g(()=>[U(m(A,{modelValue:f.new_mobile,"onUpdate:modelValue":O[1]||(O[1]=B=>f.new_mobile=B),size:"large",class:"input_style",placeholder:w(l).info.mobile?k.$t("form.input_placeholder")+k.$t("form.new_mobile"):k.$t("form.input_placeholder")+k.$t("form.mobile"),clearable:""},null,8,["modelValue","placeholder"]),[[F]])]),_:1},8,["label"]),m(X,{label:k.$t("form.verify_code"),prop:"new_code"},{default:g(()=>[U((y(),H(A,{modelValue:f.new_code,"onUpdate:modelValue":O[2]||(O[2]=B=>f.new_code=B),size:"large",class:"input_style",placeholder:k.$t("form.input_placeholder")+k.$t("form.verify_code")},{suffix:g(()=>[m(M,{disabled:$.value,onClick:D(b,["stop"]),class:"!bg-[#f5f5f5] border-0 pr-0"},{default:g(()=>[w(a)?(y(),T("div",Vn,E(w(a))+"s ",1)):(y(),T("div",Tn,E(k.$t("form.get_verify_code")),1))]),_:1},8,["disabled"])]),_:1},8,["modelValue","placeholder"])),[[F]])]),_:1},8,["label"]),p("div",Mn,[m(M,{class:"w-24 h-9",onClick:V},{default:g(()=>[N(E(k.$t("action.cancel")),1)]),_:1}),m(M,{type:"primary",onClick:C,class:"w-24 h-9"},{default:g(()=>[N(E(k.$t("action.ok")),1)]),_:1})])]),_:1},8,["model","rules"])}}}),Wn={class:"text-primary font-semibold"},Ln={class:"flex-1 w-0"},Rn={class:"text-primary font-semibold"},Hn={class:"text-sm text-secondary mt-1 flex items-center gap-1"},Pn={class:"text-primary font-semibold mt-6"},zn={class:"flex flex-col mt-4 bg-[#F7F7F7] rounded-lg box-border overflow-hidden"},Nn={class:"p-4 box-border flex items-center gap-2.5 account-item"},Bn=["src"],Xn={class:"flex-none text-base text-primary"},Yn={class:"flex-1 w-0 text-sm text-placeholder invisible md:visible"},Fn={class:"p-4 box-border flex items-center gap-2.5 account-item"},Dn=["src"],Un={class:"flex-1 w-0 text-base text-primary"},Kn={class:"p-4 box-border flex items-center gap-2.5 account-item"},Gn=["src"],qn={class:"flex-none text-base text-primary"},jn={class:"flex-1 w-0 text-sm text-placeholder invisible md:visible"},Qn={class:"p-4 box-border flex items-center gap-2.5 account-item"},Zn=["src"],Jn={class:"flex-none text-base text-primary"},ea={class:"flex-1 w-0 text-sm text-placeholder invisible md:visible"},ta={class:"p-4 box-border flex items-center gap-2.5 account-item"},sa=["src"],oa={class:"flex-none text-base text-primary"},ia={class:"flex-1 w-0 text-sm text-placeholder invisible md:visible"},la={class:"text-primary font-semibold mt-6"},na={class:"flex flex-col gap-4 mt-4"},aa={class:"h-[110px] px-6 rounded-lg flex items-center bg-[#F8F8F9]"},ra={class:"flex-1"},ca={class:"text-base text-primary flex items-center gap-2"},ua={class:"text-sm text-regular"},da={class:""},pa={class:"w-[73px] text-[#182B50] text-opacity-80"},ha={class:"absolute bottom-0 left-0 right-0 h-5 flex justify-center items-center bg-[#000000] bg-opacity-60 text-white text-opacity-80 text-xs"},fa={class:"mt-6"},ma={class:"w-[73px] text-[#182B50] text-opacity-80"},va={key:0,class:"mb-4"},ga=K({__name:"userinfo",setup(e){const t=Pe(),i=R(),s=R(),l=R(),n=R(),o=R(!1),r=R(!1),c=R(!1),u=R(!1),a=()=>{var b,V,Y,C,k,O;(V=(b=l.value)==null?void 0:b.resetForm)==null||V.call(b),(C=(Y=s.value)==null?void 0:Y.resetForm)==null||C.call(Y),(O=(k=n.value)==null?void 0:k.resetForm)==null||O.call(k)},v=se({nickname:"",avatar:""}),h=()=>{v.avatar=t.info.avatar,v.nickname=t.info.nickname,o.value=!0},f=()=>{i.value.uploadFile()},I=b=>{v.avatar=b.url},_=()=>t.update(v).then(()=>{o.value=!1,oe.success($t("status.updated"))}),$=()=>{t.getUserInfo(),r.value=!1},S=()=>{t.getUserInfo(),u=!1};return(b,V)=>{const Y=Kt,C=Q,k=ae,O=ie("svg-icon"),M=Kt,A=ve,X=gt,j=de("trim"),F=de("debounce");return y(),T(J,null,[p("h1",Wn,E(b.$t("profile.info")),1),p("div",{class:"flex items-center gap-2 w-full p-4 box-border cursor-pointer mt-4 rounded-lg overflow-hidden bg-[#F7F7F7]",onClick:h},[m(Y,{class:"flex-none",size:48,src:w(t).info.avatar,style:{"--el-avatar-bg-color":"transparent"}},null,8,["src"]),p("div",Ln,[p("div",Rn,E(w(t).info.nickname),1),p("p",Hn,E(w(t).info.mobile||"- -"),1)]),m(C,{class:"text-regular",size:"16"},{default:g(()=>[m(w(Go))]),_:1})]),p("h1",Pn,E(b.$t("profile.bind_accounts")),1),p("div",zn,[p("div",Nn,[p("img",{class:"size-6",src:b.$getPublicPath("/images/profile/mobile.png"),alt:""},null,8,Bn),p("div",Xn,E(b.$t("profile.bind_mobile")),1),p("div",Yn,E(w(t).info.mobile||b.$t("profile.unbind_account")),1),m(k,{type:"info",class:"border-none !text-[#586D9A]",link:"",plain:"",onClick:V[0]||(V[0]=B=>u.value=!0)},{default:g(()=>[N(E(w(t).info.mobile?b.$t("profile.change"):b.$t("profile.bind")),1)]),_:1})]),p("div",Fn,[p("img",{class:"size-6",src:b.$getPublicPath("/images/profile/password.png"),alt:""},null,8,Dn),p("div",Un,E(b.$t("profile.login_password")),1),m(k,{type:"info",class:"!border-none !text-[#586D9A] !bg-transparent",link:"",plain:"",onClick:V[1]||(V[1]=B=>c.value=!0)},{default:g(()=>[N(E(b.$t("form.change")),1)]),_:1})]),p("div",Kn,[p("img",{class:"size-6",src:b.$getPublicPath("/images/profile/email.png"),alt:""},null,8,Gn),p("div",qn,E(b.$t("profile.bind_email")),1),p("div",jn,E(w(t).info.email||b.$t("profile.unbind_account")),1),m(k,{type:"info",class:"border-none !text-[#586D9A]",link:"",plain:"",onClick:V[2]||(V[2]=B=>r.value=!0)},{default:g(()=>[N(E(w(t).info.email?b.$t("profile.change"):b.$t("profile.bind")),1)]),_:1})]),p("div",Qn,[p("img",{class:"size-6",src:b.$getPublicPath("/images/profile/wechat.png"),alt:""},null,8,Zn),p("div",Jn,E(b.$t("profile.bind_wechat")),1),p("div",ea,E(w(t).info.wechatid||b.$t("profile.unbind_account")),1),m(k,{type:"info",class:"border-none text-placeholder-important",link:"",plain:"",disabled:""},{default:g(()=>[N(E(b.$t("profile.bind")),1)]),_:1})]),p("div",ta,[p("img",{class:"size-6",src:b.$getPublicPath("/images/profile/google.png"),alt:""},null,8,sa),p("div",oa,E(b.$t("profile.bind_google")),1),p("div",ia,E(w(t).info.wechatid||b.$t("profile.unbind_account")),1),m(k,{type:"info",class:"border-none text-placeholder-important",link:"",plain:"",disabled:""},{default:g(()=>[N(E(b.$t("profile.bind")),1)]),_:1})])]),p("h1",la,E(b.$t("profile.logined_devices")),1),p("div",na,[p("div",aa,[p("div",ra,[p("div",ca,[m(O,{name:"network"}),V[12]||(V[12]=N(" WindowsChrome 网页版 "))]),V[13]||(V[13]=p("div",{class:"text-sm text-secondary ml-6 mt-1"},"2025年3月22日上午10点51分",-1))]),p("div",ua,E(b.$t("profile.used_devices")),1)])]),m(X,{modelValue:o.value,"onUpdate:modelValue":V[5]||(V[5]=B=>o.value=B),class:"update-user-dialog",title:b.$t("action.edit")+b.$t("profile.info"),width:"500"},{footer:g(()=>[m(k,{size:"large",onClick:V[4]||(V[4]=B=>o.value=!1)},{default:g(()=>[N(E(b.$t("action.cancel")),1)]),_:1}),U((y(),H(k,{size:"large",type:"primary",disabled:!v.nickname.trim(),onClick:_},{default:g(()=>[N(E(b.$t("action.confirm")),1)]),_:1},8,["disabled"])),[[F]])]),default:g(()=>[p("div",da,[p("div",pa,E(b.$t("form.avatar")),1),p("div",{class:"mt-3 relative rounded-full w-[60px] h-[60px] overflow-hidden cursor-pointer",onClick:f},[m(M,{style:{"--el-avatar-size":"60px"},src:v.avatar},null,8,["src"]),p("div",ha,E(b.$t("form.change")),1)])]),p("div",fa,[p("div",ma,E(b.$t("form.nickname")),1),U(m(A,{modelValue:v.nickname,"onUpdate:modelValue":V[3]||(V[3]=B=>v.nickname=B),size:"large",class:"mt-3 flex-1",maxlength:"15","show-word-limit":""},null,8,["modelValue"]),[[j]])]),m(gn,{ref_key:"corpperRef",ref:i,"upload-avatar":!0,"limit-size":2,onConfirm:I},null,512)]),_:1},8,["modelValue","title"]),m(X,{modelValue:u.value,"onUpdate:modelValue":V[7]||(V[7]=B=>u.value=B),class:"update-user-dialog",title:w(t).info.mobile?b.$t("profile.change")+b.$t("form.mobile"):b.$t("profile.bind")+b.$t("form.mobile"),width:"500",onClose:a},{default:g(()=>[w(t).info.mobile?(y(),T("div",va,E(b.$t("form.verify_old_mobile")+w(t).info.mobile),1)):P("",!0),m(An,{ref_key:"mobileRef",ref:s,onSuccess:S,onClose:V[6]||(V[6]=B=>u.value=!1)},null,512)]),_:1},8,["modelValue","title"]),m(X,{modelValue:c.value,"onUpdate:modelValue":V[9]||(V[9]=B=>c.value=B),class:"update-user-dialog",title:b.$t("profile.change_password"),width:"500",onClose:a},{default:g(()=>[m(En,{ref_key:"passwordRef",ref:l,onSuccess:V[8]||(V[8]=B=>c.value=!1)},null,512)]),_:1},8,["modelValue","title"]),m(X,{modelValue:r.value,"onUpdate:modelValue":V[11]||(V[11]=B=>r.value=B),class:"update-user-dialog",title:w(t).info.email?b.$t("profile.change")+b.$t("form.email"):b.$t("profile.bind_email"),width:"500",onClose:a},{default:g(()=>[m(_n,{ref_key:"emailRef",ref:n,onSuccess:$,onClose:V[10]||(V[10]=B=>r.value=!1)},null,512)]),_:1},8,["modelValue","title"])],64)}}}),ba=bt(ga,[["__scopeId","data-v-a3b05c41"]]),wa={class:"h-full bg-white"},ya={class:"text-base text-primary font-bold line-clamp-1 max-md:flex-1 max-md:text-center"},_a={class:"hidden w-[250px] max-md:w-full flex-none py-5 bg-white"},Ca={class:"h-15 flex items-center gap-2 px-6 mb-2 text-primary max-md:hidden"},$a={class:"text-[22px] max-md:text-lg"},Sa={class:"flex flex-col py-2 gap-1 max-md:hidden"},xa=["onClick"],Oa={class:"text-sm"},Ea={class:"flex-1 w-full md:w-4/5 lg:w-3/5 max-w-[600px] mx-auto box-border flex flex-col"},Ia={class:"flex-1 py-4 px-3 md:p-6 bg-[#FFFFFF] box-border overflow-y-auto"},ka={class:"text-sm"},Va=K({__name:"index",props:{type:{default:"glider"}},setup(e){const t=Pe(),i=ei(),s=e,l=qo(),n=W(()=>[{label:"划词菜单栏",value:"glider",icon:"mouse",visible:t.is_login&&window.$isElectron},{label:"网页工具栏",value:"toolbar",icon:"web",visible:t.is_login&&window.$isElectron},{label:"通用设置",value:"common",icon:"setting2",visible:window.$isElectron},{label:window.$t("profile.info"),value:"userinfo",icon:"person",visible:t.is_login},{label:window.$t("profile.change_password"),value:"password",icon:"lock",visible:t.is_login},{label:"关于",value:"about",icon:"info",visible:window.$isElectron}]),o=W(()=>i.template_style_info.style_type==="website"),r=R(""),c=a=>{r.value=a.value},u=()=>{t.logout(),oe.success(window.$t("status.logout_success"))};return Se(()=>{const a=n.value.filter(h=>h.visible).map(h=>h.value),v=s.type||l.query.type||"userinfo";r.value=a.includes(v)?v:a[0],i.loadInfo()}),(a,v)=>{const h=Q,f=ie("svg-icon"),I=Zo,_=Qo;return y(),T("div",wa,[m(Jo,{sticky:"",back:!1,hideUser:"",siderButton:!o.value},{before_suffix:g(()=>[p("div",ya,E(a.$t("action.setting")),1)]),after_suffix:g(()=>[m(h,{class:"text-primary cursor-pointer",size:"18",onClick:v[0]||(v[0]=$=>a.$router.back())},{default:g(()=>[m(w(at))]),_:1})]),_:1},8,["siderButton"]),p("div",_a,[p("div",Ca,[m(f,{size:"16",name:"setting"}),p("span",$a,E(a.$t("action.setting")),1)]),p("div",Sa,[(y(!0),T(J,null,Ze(n.value,$=>(y(),T(J,{key:$.value},[$.visible?(y(),T("div",{key:0,class:L(["h-10 flex items-center gap-3 px-6 cursor-pointer hover-bg-primary-light-9 hover-text-theme max-md:flex-1",[r.value===$.value?"text-theme bg-primary-light-9":"text-regular"]]),onClick:S=>c($)},[m(f,{size:"16",name:$.icon||"setting"},null,8,["name"]),p("span",Oa,E($.label),1)],10,xa)):P("",!0)],64))),128))]),m(_,{class:"index-tabs md:!hidden mx-4",modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=$=>r.value=$)},{default:g(()=>[(y(!0),T(J,null,Ze(n.value,$=>(y(),T(J,{key:$.value},[$.visible?(y(),H(I,{key:0,label:$.label,name:$.value},null,8,["label","name"])):P("",!0)],64))),128))]),_:1},8,["modelValue"])]),p("div",Ea,[p("div",Ia,[r.value==="userinfo"?(y(),H(ba,{key:0})):r.value==="password"?(y(),H(Kl,{key:1})):r.value==="toolbar"?(y(),H(Vl,{key:2})):r.value==="glider"?(y(),H(Nl,{key:3})):r.value==="about"?(y(),H(Yl,{key:4})):r.value==="common"?(y(),H(Ul,{key:5})):P("",!0),r.value==="userinfo"?(y(),T("div",{key:6,class:"h-11 mt-8 flex items-center justify-center bg-[#F8F8F9] gap-2 px-6 mb-2 rounded text-[#F84E55] cursor-pointer",onClick:u},[p("span",ka,E(a.$t("action.logout")),1)])):P("",!0)])])])}}}),Da=bt(Va,[["__scopeId","data-v-13c3dd34"]]);export{Da as default};
