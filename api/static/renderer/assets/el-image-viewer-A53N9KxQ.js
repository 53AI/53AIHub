import{bu as Fe,bv as se,bw as Ve,z as Z,aX as ge,aU as Te,aV as ee,bl as _e,az as Se,B as oe,aF as we,bx as De,by as Xe,b1 as xe,aY as Ne,bz as Ye,r as T,bA as He,aa as We,G as w,am as pe,o as Oe,bB as J,h as be,b as I,w as k,f as p,T as je,d as z,I as ke,p as y,u as t,aD as Ke,e as O,c as M,q as H,s as qe,Y,bd as Ge,F as re,X as Ue,ag as Ze,a0 as Je,t as Re,bC as Qe,bD as et,au as tt,bE as at,bF as nt,J as st,k as rt,m as ot,be as it,ay as U,bG as lt,n as $e,a_ as Ae,bH as ut,bI as ct,bJ as dt,x as ft,b6 as Ie,b7 as Ce,bK as Ee,y as vt,aP as mt,bL as gt,bM as pt}from"./main-BBgPs3nN.js";var bt=/\s/;function ht(e){for(var l=e.length;l--&&bt.test(e.charAt(l)););return l}var yt=/^\s+/;function wt(e){return e&&e.slice(0,ht(e)+1).replace(yt,"")}var Le=NaN,kt=/^[-+]0x[0-9a-f]+$/i,It=/^0b[01]+$/i,Ct=/^0o[0-7]+$/i,Et=parseInt;function ze(e){if(typeof e=="number")return e;if(Fe(e))return Le;if(se(e)){var l=typeof e.valueOf=="function"?e.valueOf():e;e=se(l)?l+"":l}if(typeof e!="string")return e===0?e:+e;e=wt(e);var s=It.test(e);return s||Ct.test(e)?Et(e.slice(2),s?2:8):kt.test(e)?Le:+e}var ve=function(){return Ve.Date.now()},Lt="Expected a function",zt=Math.max,Tt=Math.min;function _t(e,l,s){var r,i,f,C,v,_,o=0,R=!1,b=!1,$=!0;if(typeof e!="function")throw new TypeError(Lt);l=ze(l)||0,se(s)&&(R=!!s.leading,b="maxWait"in s,f=b?zt(ze(s.maxWait)||0,l):f,$="trailing"in s?!!s.trailing:$);function S(u){var E=r,V=i;return r=i=void 0,o=u,C=e.apply(V,E),C}function m(u){return o=u,v=setTimeout(c,l),R?S(u):C}function h(u){var E=u-_,V=u-o,j=l-E;return b?Tt(j,f-V):j}function x(u){var E=u-_,V=u-o;return _===void 0||E>=l||E<0||b&&V>=f}function c(){var u=ve();if(x(u))return q(u);v=setTimeout(c,h(u))}function q(u){return v=void 0,$&&r?S(u):(r=i=void 0,C)}function W(){v!==void 0&&clearTimeout(v),o=0,r=_=i=v=void 0}function G(){return v===void 0?C:q(ve())}function F(){var u=ve(),E=x(u);if(r=arguments,i=this,_=u,E){if(v===void 0)return m(_);if(b)return clearTimeout(v),v=setTimeout(c,l),S(_)}return v===void 0&&(v=setTimeout(c,l)),C}return F.cancel=W,F.flush=G,F}var St="Expected a function";function me(e,l,s){var r=!0,i=!0;if(typeof e!="function")throw new TypeError(St);return se(s)&&(r="leading"in s?!!s.leading:r,i="trailing"in s?!!s.trailing:i),_t(e,l,{leading:r,maxWait:l,trailing:i})}const xt=(e,l)=>{if(!Z||!e||!l)return!1;const s=e.getBoundingClientRect();let r;return l instanceof Element?r=l.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<r.bottom&&s.bottom>r.top&&s.right>r.left&&s.left<r.right},Nt=Te({urlList:{type:ee(Array),default:()=>_e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:ee(String)}}),Ot={close:()=>!0,switch:e=>ge(e),rotate:e=>ge(e)},Rt=oe({name:"ElImageViewer"}),$t=oe({...Rt,props:Nt,emits:Ot,setup(e,{expose:l,emit:s}){var r;const i=e,f={CONTAIN:{name:"contain",icon:we(Xe)},ORIGINAL:{name:"original",icon:we(De)}};let C,v="";const{t:_}=xe(),o=Ne("image-viewer"),{nextZIndex:R}=Ye(),b=T(),$=T([]),S=He(),m=T(!0),h=T(i.initialIndex),x=We(f.CONTAIN),c=T({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),q=T((r=i.zIndex)!=null?r:R()),W=w(()=>{const{urlList:a}=i;return a.length<=1}),G=w(()=>h.value===0),F=w(()=>h.value===i.urlList.length-1),u=w(()=>i.urlList[h.value]),E=w(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!i.infinite&&G.value)]),V=w(()=>[o.e("btn"),o.e("next"),o.is("disabled",!i.infinite&&F.value)]),j=w(()=>{const{scale:a,deg:g,offsetX:d,offsetY:N,enableTransition:P}=c.value;let B=d/a,X=N/a;const Q=g*Math.PI/180,he=Math.cos(Q),ye=Math.sin(Q);B=B*he+X*ye,X=X*he-d/a*ye;const fe={transform:`scale(${a}) rotate(${g}deg) translate(${B}px, ${X}px)`,transition:P?"transform .3s":""};return x.value.name===f.CONTAIN.name&&(fe.maxWidth=fe.maxHeight="100%"),fe}),te=w(()=>`${h.value+1} / ${i.urlList.length}`);function K(){ne(),C==null||C(),document.body.style.overflow=v,s("close")}function ae(){const a=me(d=>{switch(d.code){case U.esc:i.closeOnPressEscape&&K();break;case U.space:A();break;case U.left:ce();break;case U.up:D("zoomIn");break;case U.right:de();break;case U.down:D("zoomOut");break}}),g=me(d=>{const N=d.deltaY||d.deltaX;D(N<0?"zoomIn":"zoomOut",{zoomRate:i.zoomRate,enableTransition:!1})});S.run(()=>{J(document,"keydown",a),J(document,"wheel",g)})}function ne(){S.stop()}function ie(){m.value=!1}function le(a){m.value=!1,a.target.alt=_("el.image.error")}function n(a){if(m.value||a.button!==0||!b.value)return;c.value.enableTransition=!1;const{offsetX:g,offsetY:d}=c.value,N=a.pageX,P=a.pageY,B=me(Q=>{c.value={...c.value,offsetX:g+Q.pageX-N,offsetY:d+Q.pageY-P}}),X=J(document,"mousemove",B);J(document,"mouseup",()=>{X()}),a.preventDefault()}function L(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function A(){if(m.value)return;const a=lt(f),g=Object.values(f),d=x.value.name,P=(g.findIndex(B=>B.name===d)+1)%a.length;x.value=f[a[P]],L()}function ue(a){const g=i.urlList.length;h.value=(a+g)%g}function ce(){G.value&&!i.infinite||ue(h.value-1)}function de(){F.value&&!i.infinite||ue(h.value+1)}function D(a,g={}){if(m.value)return;const{minScale:d,maxScale:N}=i,{zoomRate:P,rotateDeg:B,enableTransition:X}={zoomRate:i.zoomRate,rotateDeg:90,enableTransition:!0,...g};switch(a){case"zoomOut":c.value.scale>d&&(c.value.scale=Number.parseFloat((c.value.scale/P).toFixed(3)));break;case"zoomIn":c.value.scale<N&&(c.value.scale=Number.parseFloat((c.value.scale*P).toFixed(3)));break;case"clockwise":c.value.deg+=B,s("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=B,s("rotate",c.value.deg);break}c.value.enableTransition=X}function Pe(a){var g;((g=a.detail)==null?void 0:g.focusReason)==="pointer"&&a.preventDefault()}function Be(){i.closeOnPressEscape&&K()}function Me(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}return pe(u,()=>{$e(()=>{const a=$.value[0];a!=null&&a.complete||(m.value=!0)})}),pe(h,a=>{L(),s("switch",a)}),Oe(()=>{ae(),C=J("wheel",Me,{passive:!1}),v=document.body.style.overflow,document.body.style.overflow="hidden"}),l({setActiveItem:ue}),(a,g)=>(I(),be(t(it),{to:"body",disabled:!a.teleported},{default:k(()=>[p(je,{name:"viewer-fade",appear:""},{default:k(()=>[z("div",{ref_key:"wrapper",ref:b,tabindex:-1,class:y(t(o).e("wrapper")),style:ke({zIndex:q.value})},[p(t(Ke),{loop:"",trapped:"","focus-trap-el":b.value,"focus-start-el":"container",onFocusoutPrevented:Pe,onReleaseRequested:Be},{default:k(()=>[z("div",{class:y(t(o).e("mask")),onClick:qe(d=>a.hideOnClickModal&&K(),["self"])},null,10,["onClick"]),O(" CLOSE "),z("span",{class:y([t(o).e("btn"),t(o).e("close")]),onClick:K},[p(t(Y),null,{default:k(()=>[p(t(Ge))]),_:1})],2),O(" ARROW "),t(W)?O("v-if",!0):(I(),M(re,{key:0},[z("span",{class:y(t(E)),onClick:ce},[p(t(Y),null,{default:k(()=>[p(t(Ue))]),_:1})],2),z("span",{class:y(t(V)),onClick:de},[p(t(Y),null,{default:k(()=>[p(t(Ze))]),_:1})],2)],64)),a.showProgress?(I(),M("div",{key:1,class:y([t(o).e("btn"),t(o).e("progress")])},[H(a.$slots,"progress",{activeIndex:h.value,total:a.urlList.length},()=>[Je(Re(t(te)),1)])],2)):O("v-if",!0),O(" ACTIONS "),z("div",{class:y([t(o).e("btn"),t(o).e("actions")])},[z("div",{class:y(t(o).e("actions__inner"))},[H(a.$slots,"toolbar",{actions:D,prev:ce,next:de,reset:A,activeIndex:h.value},()=>[p(t(Y),{onClick:d=>D("zoomOut")},{default:k(()=>[p(t(Qe))]),_:1},8,["onClick"]),p(t(Y),{onClick:d=>D("zoomIn")},{default:k(()=>[p(t(et))]),_:1},8,["onClick"]),z("i",{class:y(t(o).e("actions__divider"))},null,2),p(t(Y),{onClick:A},{default:k(()=>[(I(),be(tt(t(x).icon)))]),_:1}),z("i",{class:y(t(o).e("actions__divider"))},null,2),p(t(Y),{onClick:d=>D("anticlockwise")},{default:k(()=>[p(t(at))]),_:1},8,["onClick"]),p(t(Y),{onClick:d=>D("clockwise")},{default:k(()=>[p(t(nt))]),_:1},8,["onClick"])])],2)],2),O(" CANVAS "),z("div",{class:y(t(o).e("canvas"))},[(I(!0),M(re,null,st(a.urlList,(d,N)=>rt((I(),M("img",{ref_for:!0,ref:P=>$.value[N]=P,key:d,src:d,style:ke(t(j)),class:y(t(o).e("img")),crossorigin:a.crossorigin,onLoad:ie,onError:le,onMousedown:n},null,46,["src","crossorigin"])),[[ot,N===h.value]])),128))],2),H(a.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var At=Se($t,[["__file","image-viewer.vue"]]);const Pt=Ae(At),Bt=Te({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ee([String,Object])},previewSrcList:{type:ee(Array),default:()=>_e([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:ee(String)}}),Mt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>ge(e),close:()=>!0,show:()=>!0},Ft=oe({name:"ElImage",inheritAttrs:!1}),Vt=oe({...Ft,props:Bt,emits:Mt,setup(e,{expose:l,emit:s}){const r=e,{t:i}=xe(),f=Ne("image"),C=ut(),v=w(()=>ct(Object.entries(C).filter(([n])=>/^(data-|on[A-Z])/i.test(n)||["id","style"].includes(n)))),_=dt({excludeListeners:!0,excludeKeys:w(()=>Object.keys(v.value))}),o=T(),R=T(!1),b=T(!0),$=T(!1),S=T(),m=T(),h=Z&&"loading"in HTMLImageElement.prototype;let x;const c=w(()=>[f.e("inner"),W.value&&f.e("preview"),b.value&&f.is("loading")]),q=w(()=>{const{fit:n}=r;return Z&&n?{objectFit:n}:{}}),W=w(()=>{const{previewSrcList:n}=r;return ft(n)&&n.length>0}),G=w(()=>{const{previewSrcList:n,initialIndex:L}=r;let A=L;return L>n.length-1&&(A=0),A}),F=w(()=>r.loading==="eager"?!1:!h&&r.loading==="lazy"||r.lazy),u=()=>{Z&&(b.value=!0,R.value=!1,o.value=r.src)};function E(n){b.value=!1,R.value=!1,s("load",n)}function V(n){b.value=!1,R.value=!0,s("error",n)}function j(){xt(S.value,m.value)&&(u(),ae())}const te=pt(j,200,!0);async function K(){var n;if(!Z)return;await $e();const{scrollContainer:L}=r;vt(L)?m.value=L:mt(L)&&L!==""?m.value=(n=document.querySelector(L))!=null?n:void 0:S.value&&(m.value=gt(S.value)),m.value&&(x=J(m,"scroll",te),setTimeout(()=>j(),100))}function ae(){!Z||!m.value||!te||(x==null||x(),m.value=void 0)}function ne(){W.value&&($.value=!0,s("show"))}function ie(){$.value=!1,s("close")}function le(n){s("switch",n)}return pe(()=>r.src,()=>{F.value?(b.value=!0,R.value=!1,ae(),K()):u()}),Oe(()=>{F.value?K():u()}),l({showPreview:ne}),(n,L)=>(I(),M("div",Ie({ref_key:"container",ref:S},t(v),{class:[t(f).b(),n.$attrs.class]}),[R.value?H(n.$slots,"error",{key:0},()=>[z("div",{class:y(t(f).e("error"))},Re(t(i)("el.image.error")),3)]):(I(),M(re,{key:1},[o.value!==void 0?(I(),M("img",Ie({key:0},t(_),{src:o.value,loading:n.loading,style:t(q),class:t(c),crossorigin:n.crossorigin,onClick:ne,onLoad:E,onError:V}),null,16,["src","loading","crossorigin"])):O("v-if",!0),b.value?(I(),M("div",{key:1,class:y(t(f).e("wrapper"))},[H(n.$slots,"placeholder",{},()=>[z("div",{class:y(t(f).e("placeholder"))},null,2)])],2)):O("v-if",!0)],64)),t(W)?(I(),M(re,{key:2},[$.value?(I(),be(t(Pt),{key:0,"z-index":n.zIndex,"initial-index":t(G),infinite:n.infinite,"zoom-rate":n.zoomRate,"min-scale":n.minScale,"max-scale":n.maxScale,"show-progress":n.showProgress,"url-list":n.previewSrcList,crossorigin:n.crossorigin,"hide-on-click-modal":n.hideOnClickModal,teleported:n.previewTeleported,"close-on-press-escape":n.closeOnPressEscape,onClose:ie,onSwitch:le},{progress:k(A=>[H(n.$slots,"progress",Ce(Ee(A)))]),toolbar:k(A=>[H(n.$slots,"toolbar",Ce(Ee(A)))]),default:k(()=>[n.$slots.viewer?(I(),M("div",{key:0},[H(n.$slots,"viewer")])):O("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):O("v-if",!0)],64)):O("v-if",!0)],16))}});var Dt=Se(Vt,[["__file","image.vue"]]);const Yt=Ae(Dt);export{Yt as E,_t as d,me as t};
