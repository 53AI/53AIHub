import{aU as Ae,aV as te,az as Me,B as K,aY as Qe,G as z,bN as Pe,bO as et,bP as tt,bQ as st,bd as Ue,aO as Re,aP as ae,c as v,b as i,e as A,p as F,u as o,d as s,I as G,q as be,t as D,h as N,w as S,au as we,Y as le,a_ as ot,aW as nt,aE as at,r as I,aH as ze,o as pe,bB as lt,k as X,F as Y,m as ce,s as Q,f as g,bR as it,T as rt,bS as dt,ay as ve,z as ct,ac as ge,y as Se,aT as ut,aQ as Ie,bT as pt,N as Be,an as Ne,_ as he,aa as ft,br as vt,aG as bt,W as ye,C as Oe,n as oe,a as gt,X as ht,ag as mt,bF as wt,aA as yt,L as _t,J as ee,a0 as ne,ar as kt,a1 as We,H as xt,A as $t,am as Ct,V as Ft,Z as Et,a5 as Tt,bU as De}from"./main-BkqrklTl.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{u as _e,_ as zt}from"./browser-setting-CSmEtH2O.js";import{b as St,E as It,a as Dt}from"./el-dropdown-item-Ca9Z_2s8.js";import{E as Le}from"./index-DIDA4GZy.js";const Lt=Ae({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:n=>n>=0&&n<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:te(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:te([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:te(Function),default:n=>`${n}%`}}),At=K({name:"ElProgress"}),Mt=K({...At,props:Lt,setup(n){const e=n,r={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=Qe("progress"),p=z(()=>{const t={width:`${e.percentage}%`,animationDuration:`${e.duration}s`},L=O(e.percentage);return L.includes("gradient")?t.background=L:t.backgroundColor=L,t}),$=z(()=>(e.strokeWidth/e.width*100).toFixed(1)),x=z(()=>["circle","dashboard"].includes(e.type)?Number.parseInt(`${50-Number.parseFloat($.value)/2}`,10):0),m=z(()=>{const t=x.value,L=e.type==="dashboard";return`
          M 50 50
          m 0 ${L?"":"-"}${t}
          a ${t} ${t} 0 1 1 0 ${L?"-":""}${t*2}
          a ${t} ${t} 0 1 1 0 ${L?"":"-"}${t*2}
          `}),l=z(()=>2*Math.PI*x.value),c=z(()=>e.type==="dashboard"?.75:1),_=z(()=>`${-1*l.value*(1-c.value)/2}px`),k=z(()=>({strokeDasharray:`${l.value*c.value}px, ${l.value}px`,strokeDashoffset:_.value})),f=z(()=>({strokeDasharray:`${l.value*c.value*(e.percentage/100)}px, ${l.value}px`,strokeDashoffset:_.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),y=z(()=>{let t;return e.color?t=O(e.percentage):t=r[e.status]||r.default,t}),M=z(()=>e.status==="warning"?Pe:e.type==="line"?e.status==="success"?et:tt:e.status==="success"?st:Ue),U=z(()=>e.type==="line"?12+e.strokeWidth*.4:e.width*.111111+2),B=z(()=>e.format(e.percentage));function R(t){const L=100/t.length;return t.map((H,q)=>ae(H)?{color:H,percentage:(q+1)*L}:H).sort((H,q)=>H.percentage-q.percentage)}const O=t=>{var L;const{color:W}=e;if(Re(W))return W(t);if(ae(W))return W;{const H=R(W);for(const q of H)if(q.percentage>t)return q.color;return(L=H[H.length-1])==null?void 0:L.color}};return(t,L)=>(i(),v("div",{class:F([o(a).b(),o(a).m(t.type),o(a).is(t.status),{[o(a).m("without-text")]:!t.showText,[o(a).m("text-inside")]:t.textInside}]),role:"progressbar","aria-valuenow":t.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[t.type==="line"?(i(),v("div",{key:0,class:F(o(a).b("bar"))},[s("div",{class:F(o(a).be("bar","outer")),style:G({height:`${t.strokeWidth}px`})},[s("div",{class:F([o(a).be("bar","inner"),{[o(a).bem("bar","inner","indeterminate")]:t.indeterminate},{[o(a).bem("bar","inner","striped")]:t.striped},{[o(a).bem("bar","inner","striped-flow")]:t.stripedFlow}]),style:G(o(p))},[(t.showText||t.$slots.default)&&t.textInside?(i(),v("div",{key:0,class:F(o(a).be("bar","innerText"))},[be(t.$slots,"default",{percentage:t.percentage},()=>[s("span",null,D(o(B)),1)])],2)):A("v-if",!0)],6)],6)],2)):(i(),v("div",{key:1,class:F(o(a).b("circle")),style:G({height:`${t.width}px`,width:`${t.width}px`})},[(i(),v("svg",{viewBox:"0 0 100 100"},[s("path",{class:F(o(a).be("circle","track")),d:o(m),stroke:`var(${o(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":t.strokeLinecap,"stroke-width":o($),fill:"none",style:G(o(k))},null,14,["d","stroke","stroke-linecap","stroke-width"]),s("path",{class:F(o(a).be("circle","path")),d:o(m),stroke:o(y),fill:"none",opacity:t.percentage?1:0,"stroke-linecap":t.strokeLinecap,"stroke-width":o($),style:G(o(f))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(t.showText||t.$slots.default)&&!t.textInside?(i(),v("div",{key:2,class:F(o(a).e("text")),style:G({fontSize:`${o(U)}px`})},[be(t.$slots,"default",{percentage:t.percentage},()=>[t.status?(i(),N(o(le),{key:1},{default:S(()=>[(i(),N(we(o(M))))]),_:1})):(i(),v("span",{key:0},D(o(B)),1))])],6)):A("v-if",!0)],10,["aria-valuenow"]))}});var Pt=Me(Mt,[["__file","progress.vue"]]);const Ut=ot(Pt),Ve=["success","info","warning","error"],Rt=Ae({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:nt},id:{type:String,default:""},message:{type:te([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:te(Function),default:()=>{}},onClose:{type:te(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...Ve,""],default:""},zIndex:Number}),Bt={destroy:()=>!0},Nt=K({name:"ElNotification"}),Ot=K({...Nt,props:Rt,emits:Bt,setup(n,{expose:e}){const r=n,{ns:a,zIndex:p}=at("notification"),{nextZIndex:$,currentZIndex:x}=p,{Close:m}=it,l=I(!1);let c;const _=z(()=>{const t=r.type;return t&&ze[r.type]?a.m(t):""}),k=z(()=>r.type&&ze[r.type]||r.icon),f=z(()=>r.position.endsWith("right")?"right":"left"),y=z(()=>r.position.startsWith("top")?"top":"bottom"),M=z(()=>{var t;return{[y.value]:`${r.offset}px`,zIndex:(t=r.zIndex)!=null?t:x.value}});function U(){r.duration>0&&({stop:c}=dt(()=>{l.value&&R()},r.duration))}function B(){c==null||c()}function R(){l.value=!1}function O({code:t}){t===ve.delete||t===ve.backspace?B():t===ve.esc?l.value&&R():U()}return pe(()=>{U(),$(),l.value=!0}),lt(document,"keydown",O),e({visible:l,close:R}),(t,L)=>(i(),N(rt,{name:o(a).b("fade"),onBeforeLeave:t.onClose,onAfterLeave:W=>t.$emit("destroy"),persisted:""},{default:S(()=>[X(s("div",{id:t.id,class:F([o(a).b(),t.customClass,o(f)]),style:G(o(M)),role:"alert",onMouseenter:B,onMouseleave:U,onClick:t.onClick},[o(k)?(i(),N(o(le),{key:0,class:F([o(a).e("icon"),o(_)])},{default:S(()=>[(i(),N(we(o(k))))]),_:1},8,["class"])):A("v-if",!0),s("div",{class:F(o(a).e("group"))},[s("h2",{class:F(o(a).e("title")),textContent:D(t.title)},null,10,["textContent"]),X(s("div",{class:F(o(a).e("content")),style:G(t.title?void 0:{margin:0})},[be(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(i(),v(Y,{key:1},[A(" Caution here, message could've been compromised, never use user's input as message "),s("p",{innerHTML:t.message},null,8,["innerHTML"])],2112)):(i(),v("p",{key:0},D(t.message),1))])],6),[[ce,t.message]]),t.showClose?(i(),N(o(le),{key:0,class:F(o(a).e("closeBtn")),onClick:Q(R,["stop"])},{default:S(()=>[g(o(m))]),_:1},8,["class","onClick"])):A("v-if",!0)],2)],46,["id","onClick"]),[[ce,l.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Wt=Me(Ot,[["__file","notification.vue"]]);const ue={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},me=16;let Vt=1;const se=function(n={},e){if(!ct)return{close:()=>{}};(ae(n)||ge(n))&&(n={message:n});const r=n.position||"top-right";let a=n.offset||0;ue[r].forEach(({vm:_})=>{var k;a+=(((k=_.el)==null?void 0:k.offsetHeight)||0)+me}),a+=me;const p=`notification_${Vt++}`,$=n.onClose,x={...n,offset:a,id:p,onClose:()=>{Ht(p,r,$)}};let m=document.body;Se(n.appendTo)?m=n.appendTo:ae(n.appendTo)&&(m=document.querySelector(n.appendTo)),Se(m)||(m=document.body);const l=document.createElement("div"),c=g(Wt,x,Re(x.message)?x.message:ge(x.message)?()=>x.message:null);return c.appContext=ut(e)?se._context:e,c.props.onDestroy=()=>{Ie(null,l)},Ie(c,l),ue[r].push({vm:c}),m.appendChild(l.firstElementChild),{close:()=>{c.component.exposed.visible.value=!1}}};Ve.forEach(n=>{se[n]=(e={},r)=>((ae(e)||ge(e))&&(e={message:e}),se({...e,type:n},r))});function Ht(n,e,r){const a=ue[e],p=a.findIndex(({vm:c})=>{var _;return((_=c.component)==null?void 0:_.props.id)===n});if(p===-1)return;const{vm:$}=a[p];if(!$)return;r==null||r($);const x=$.el.offsetHeight,m=e.split("-")[0];a.splice(p,1);const l=a.length;if(!(l<1))for(let c=p;c<l;c++){const{el:_,component:k}=a[c].vm,f=Number.parseInt(_.style[m],10)-x-me;k.props.offset=f}}function qt(){for(const n of Object.values(ue))n.forEach(({vm:e})=>{e.component.exposed.visible.value=!1})}se.closeAll=qt;se._context=null;const Jt=pt(se,"$notify"),jt="/images/blank.png",ke=Be("tabs",{state:()=>({tabs:[],activeId:0}),getters:{activeTab:n=>n.tabs.find(e=>e.id===n.activeId),MAIN_URL:()=>location.origin+location.pathname},actions:{pureAddTab(n){return{defaultUrl:"",loading:"none",type:"browser",id:Math.random()*1e17,title:"",url:"",closable:!0,ability:!0,timestamp:Date.now(),icon:window.$chat53ai.getPublicPath("/images/blank.png"),component:n.type==="page"?ft():"",browsers:n.type==="multibrowser"?[]:"",render:!0,webview:null,...n}},addTab(n,e=!0){const r=this.pureAddTab(n);if(this.tabs.some(a=>a.id===r.id)){this.setActive(r.id);return}return this.tabs.push(r),e&&(this.activeId=r.id),r},addChildTab(n,e){var a;const r=this.tabs.findIndex(p=>p.id===n);r>-1&&((a=this.tabs[r].browsers)==null||a.push(this.pureAddTab({...e,width:null})))},closeTab(n){var e;this.tabs=this.tabs.filter(r=>r.id!==n),this.activeId===n&&(this.activeId=((e=this.tabs[this.tabs.length-1])==null?void 0:e.id)||0)},updateTab(n,e){const r=this.tabs.findIndex(a=>a.id===n);r>-1&&(this.tabs[r]={...this.tabs[r],...e})},refreshTab(n){const e=this.tabs.find(r=>r.id===n);e&&(e.webview?e.webview.reload():(e.render=!1,setTimeout(()=>{e.render=!0},200)))},updateChildTab(n,e,r){const a=n.browsers.findIndex(p=>p.id===e);a>-1&&(n.browsers[a]={...n.browsers[a],...r})},setActive(n){this.tabs.some(e=>e.id===n)&&(this.activeId=n)},activeSetting(){this.addTab({id:"setting",title:window.$t("action.setting"),closable:!0,ability:!1,icon:window.$chat53ai.getPublicPath("/images/setting.png"),type:"page",component:Ne(()=>he(()=>import("./index-BLoEAvJR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])))},!0)}}}),Gt=["data-index","onClick","draggable","onDragstart","onDragend"],Xt={class:"flex items-center gap-2 overflow-hidden flex-grow"},Yt=["src"],Zt=["onClick"],Kt={key:2,class:"absolute left-0 right-0 -bottom-1.5 h-1.5 bg-white"},Qt=K({__name:"GNBTabs",setup(n){const e=ke(),r=_e(),a=I(),p=z({get:()=>e.activeId,set:l=>e.setActive(l)}),$=()=>{e.addTab({title:window.$t("browser.newTab"),closable:!0,url:"",defaultUrl:r.default_tab_url})},x=(l,c)=>{l.dataTransfer&&(l.dataTransfer.setData("text/plain",JSON.stringify({id:c.id,title:c.title,url:c.url||c.defaultUrl})),l.dataTransfer.effectAllowed="copy")},m=(l,c)=>{var R;const _=window.innerWidth,k=window.innerHeight,f=l.clientX,y=l.clientY,M=(R=a.value)==null?void 0:R.$el,U=f<=0||y<=0||f>=_||y>=k,B=M?!M.contains(document.elementFromPoint(f,y)):!1;U||B?(console.log("元素被拖放到浏览器外部",{item:c,position:{x:f,y}}),window.$chat53ai.$win({type:"new-window",data:{title:c.title,url:encodeURIComponent(c.url||c.defaultUrl)}}),e.closeTab(c.id)):console.log("元素在浏览器内部拖放完成")};return pe(()=>{}),(l,c)=>{const _=le,k=ye("svg-icon");return i(),N(zt,{class:"flex items-center gap-1.5 drag py-1.5 px-2",identity:"id",ref_key:"sortableRef",ref:a,props:{handle:".sort-icon",filter:".filtered",animation:150,onMove:function(f){const y=""+f.related.dataset.index;return!(y==="0"||y==="-1")}},modelValue:o(e).tabs,"onUpdate:modelValue":c[0]||(c[0]=f=>o(e).tabs=f)},{item:S(({item:f,index:y})=>[s("div",{class:F(["flex-1 h-7 flex items-center gap-2 px-2 rounded-md max-w-50 min-w-[28px] cursor-pointer relative select-none no-drag group",[p.value===f.id?"bg-[#FFFFFF] text-[#1D1E1F] rounded-b-none":"text-[#182B50] hover:bg-[#CCD0D5]"]]),"data-index":y,onClick:M=>o(e).setActive(f.id),draggable:!["index","setting"].includes(f.id),onDragstart:M=>x(M,f),onDragend:M=>m(M,f)},[s("div",Xt,[s("div",{class:F(["size-4 flex-center overflow-hidden transition-all duration-300",[["index"].includes(f.id)?"filtered":"sort-icon"]])},[f.loading==="loading"?(i(),N(_,{key:0,class:"animate-spin",size:"14"},{default:S(()=>[g(o(bt))]),_:1})):f.icon?(i(),v("img",{key:1,class:"size-4",src:f.icon},null,8,Yt)):(i(),N(k,{key:2,name:"tab",color:"#666666"}))],2),s("div",{class:F(["text-xs text-#182B50 flex-1 truncate overflow-hidden transition-all duration-300",[["index"].includes(f.id)?"filtered":"sort-icon"]])},D(f.title),3)]),f.closable?(i(),v("div",{key:0,class:"size-4 flex-center rounded-full hover:bg-[#DDDDDE] shrink-0",onClick:Q(M=>o(e).closeTab(f.id),["stop"])}," × ",8,Zt)):A("",!0),y>0?(i(),v("div",{key:1,class:F(["absolute -left-[4px] top-1.5 w-0.5 h-4 bg-[#CECECE] group-hover:bg-[#F0F0F0] group-hover:z-10",[p.value===f.id?"bg-[#F0F0F0] z-10":""]])},null,2)):A("",!0),s("div",{class:F(["absolute -right-[4px] top-1.5 w-0.5 h-4 bg-[#CECECE] group-hover:bg-[#F0F0F0] group-hover:z-10",[p.value===f.id?"bg-[#F0F0F0] z-10":""]])},null,2),p.value===f.id?(i(),v("div",Kt,c[1]||(c[1]=[s("div",{class:"absolute -left-2 bottom-0 size-2 bg-[#fff] overflow-hidden"},[s("div",{class:"absolute right-0 bottom-0 size-4 bg-[#F0F0F0] rounded-full"})],-1),s("div",{class:"absolute -right-2 bottom-0 size-2 bg-[#fff] overflow-hidden"},[s("div",{class:"absolute left-0 bottom-0 size-4 bg-[#F0F0F0] rounded-full"})],-1)]))):A("",!0)],42,Gt)]),footer:S(()=>[s("div",{class:"flex-none size-7 flex-center cursor-pointer rounded-full hover:bg-[#A8C7FA] no-drag filtered","data-index":"-1",onClick:$},[g(_,{color:"#474747",size:"14"},{default:S(()=>[g(o(vt))]),_:1})])]),_:1},8,["props","modelValue"])}}}),es={class:"flex flex-col bg-white"},ts={key:0,class:"flex items-center gap-2 px-4 py-1.5 border-b"},ss={class:"flex items-center gap-0.5"},os={class:"flex-1"},ns=["src"],as={class:"text-sm text-[#1D1E1F] truncate"},ls=["onClick"],is=["src"],rs={class:"text-sm text-[#1D1E1F] truncate"},ds=["onClick"],cs={class:"text-sm text-[#1D1E1F] truncate"},us={class:"text-[#177CDD]"},ps={key:0,class:"flex items-center gap-1 relative"},fs={class:"text-sm text-[#1D1E1F]"},vs={class:"text-sm text-[#1D1E1F]"},bs={class:"size-8 flex-center rounded cursor-pointer hover:bg-[#f0f0f0]"},gs={class:"flex-1 flex overflow-hidden"},hs={class:"flex-1 relative"},ms=["src","preload"],ws={key:1,class:"absolute inset-0 flex items-center justify-center bg-white"},ys={class:"text-center"},_s={class:"text-lg font-semibold text-gray-800"},ks={key:2,class:"absolute inset-0 bg-[#F5F5F5]"},xs={key:0,class:"flex-none w-[420px] p-5 border-l overflow-hidden relative"},$s=K({__name:"Browser",props:{tab:{default:()=>({})},parent:{default:null}},setup(n){const e=n,r=()=>window.$chat53ai.getPreloadPath(),a=Ne(()=>he(()=>import("./index-oRsP0abO.js"),__vite__mapDeps([21,1,2,15,16,22,23,12]))),p=async()=>{const{Readability:d}=await he(()=>import("./index-B49t2MBk.js").then(b=>b.i),__vite__mapDeps([24,22]));return d},$=Oe(),x=ke(),m=_e(),l=I(null),c=I(!1),_=I(!1),k=I(!1),f=I(!1),y=I(!1),M=I(""),U=I(!1),B=I(""),R=I([]),O=z(()=>!l.value||e.tab.loading!=="completed"?!1:l.value.canGoBack()),t=z(()=>!l.value||e.tab.loading!=="completed"?!1:l.value.canGoForward()),L=z(()=>m.toolbar_menus.slice(2)),W=I([{name:"百度AI+",value:"baiduai+",url:"https://chat.baidu.com/search?word="},{name:"纳米搜索",value:"n",url:"https://www.n.cn/?q="},{name:"秘塔",value:"metaso",url:"https://metaso.cn/?q="},{name:"Perplexity",value:"perplexity",url:"https://perplexity.ai/search?q="}]),H=I([{name:"百度",url:"https://www.baidu.com"},{name:"AI知识库|大模型知识库|智能体开发|53AI",url:"https://www.53ai.com"}]);let q=!1;const fe=()=>{_.value=!0,ie()},ie=()=>{c.value=!0},re=()=>{setTimeout(()=>{if(q){q=!1;return}c.value=!1,_.value=!1},200)},w=()=>{q=!0},u=()=>{O.value&&l.value&&l.value.goBack()},E=()=>{t.value&&l.value&&l.value.goForward()},T=()=>{l.value&&l.value.reload()},V=(d={})=>{e.parent?x.updateChildTab(e.parent,e.tab.id,d):x.updateTab(e.tab.id,d)},j=d=>{try{return new URL(d),!0}catch{return/^(https?:\/\/)?[\w-]+(\.[\w-]+)+[\w\-.,@?^=%&:/~+#]*$/.test(d)}},C=d=>{let b=d.trim();if(b)j(b)?/^https?:\/\//i.test(b)||(b="https://"+b):b=m.default_search_url.replace("_word_",encodeURIComponent(b));else return;e.tab.defaultUrl?(V({url:b,loading:"loading"}),oe(()=>{l.value.loadURL(b)})):(V({defaultUrl:b,loading:"loading"}),oe(()=>{Ce()})),re()},qe=async()=>await l.value.executeJavaScript(`
    (function() {
      return document.documentElement.innerHTML; // 提取可见文本
    })()
  `),Je=d=>{const h=new DOMParser().parseFromString(d,"text/html");return h.querySelectorAll("a").forEach(J=>{try{const Z=J.getAttribute("href")||"";if(e.tab.url&&!Z.startsWith("http")){const de=new URL(e.tab.url);J.href=new URL(Z,de).href}J.target="_blank",J.rel="noopener noreferrer"}catch{}}),h.body.innerHTML},xe=async()=>{try{U.value=!0;const d=await qe(),b=document.implementation.createHTMLDocument("");b.documentElement.innerHTML=d;const h=await p(),J=new h(b).parse();if(!J)throw U.value=!1,new Error("Failed to parse content");B.value=Je(`<h1 class="reader-title">${J.title}</h1>${J.content}`),oe(()=>{U.value=!1})}catch(d){console.error("Content processing failed:",d)}},$e=async()=>{!l.value||e.tab.loading!=="completed"||(k.value=!0,f.value=!0,oe(()=>{xe()}))},je=()=>{if(e.tab.loading==="completed"){if(y.value){y.value=!1;return}y.value=!0,xe()}},Ge=d=>{switch(console.log(d),d){case"setting":x.activeSetting();break;default:$e();break}},Ce=()=>{if(Fe(),l.value){x.updateTab(e.tab.id,{webview:l.value});let d=!1;const b={"did-start-loading":()=>{d=!1,y.value=!1,B.value="",V({loading:"loading"})},"did-stop-loading":()=>{if(!d){const h=l.value.getURL();V({loading:"completed",url:h})}},"did-navigate":h=>{const J=h.url;V({url:m.default_tab_url===J?"":J,loading:d?"error":"completed"})},"did-navigate-in-page":h=>{V({url:h.url})},"will-navigate":h=>{V({url:h.url,loading:"loading"})},"page-title-updated":h=>{e.tab.ability&&V({title:h.title})},"page-favicon-updated":h=>{e.tab.ability&&V({icon:h.favicons[0]||""})},"did-fail-load":h=>{h.isMainFrame&&(d=!0,M.value=`加载失败: ${h.errorDescription}`,console.log(h),V({loading:"error"}))},"dom-ready":()=>{},"new-window":h=>{x.addTab({url:h.url})},"console-message":h=>{console.log("Webview console:",h.message)}};Object.keys(b).forEach(h=>{l.value.addEventListener(h,b[h]),R.value.push({event:h,handler:b[h]})})}},Fe=()=>{l.value&&(R.value.forEach(d=>{l.value.removeEventListener(d.event,d.handler)}),R.value=[])},Ee=d=>{const{type:b,from:h}=d.data;h==="chat53ai_extension"&&b==="close"&&(f.value=!1)};return pe(()=>{oe(()=>{Ce()}),window.addEventListener("message",Ee)}),gt(()=>{window.removeEventListener("message",Ee),Fe()}),(d,b)=>{const h=le,J=_t,Z=ye("svg-icon"),de=Dt,Xe=It,Ye=St,Ze=We,Ke=xt;return i(),v("div",es,[d.tab.ability?(i(),v("div",ts,[s("div",ss,[s("div",{class:F(["size-[34px] flex-center rounded-full",[O.value?"cursor-pointer hover:bg-[#F2F2F2]":"cursor-not-allowed"]]),onClick:u},[g(h,{color:O.value?"#666666":"#CCCCCC"},{default:S(()=>[g(o(ht))]),_:1},8,["color"])],2),s("div",{class:F(["size-[34px] flex-center rounded-full",[t.value?"cursor-pointer hover:bg-[#F2F2F2]":"cursor-not-allowed"]]),onClick:E},[g(h,{color:t.value?"#666666":"#CCCCCC"},{default:S(()=>[g(o(mt))]),_:1},8,["color"])],2),s("div",{class:"size-[34px] flex-center rounded-full hover:bg-[#F2F2F2] cursor-pointer",onClick:T},[g(h,{color:"#666666"},{default:S(()=>[g(o(wt))]),_:1})])]),s("div",os,[s("div",{class:F(["relative h-full bg-white px-3",[d.tab.url&&c.value&&_.value?"shadow":""]])},[g(J,{modelValue:d.tab.url,"onUpdate:modelValue":b[0]||(b[0]=P=>d.tab.url=P),style:{"--el-border-radius-base":"50px","--el-input-bg-color":"#edf2fa","--el-input-border-color":"none","--el-input-height":"32px","--el-color-primary":"#0b57d0","--el-input-hover-border-color":"transparent"},class:"url-input",disabled:!d.tab.closable,placeholder:d.$t("browser.search_placeholder"),autocomplete:"false",onFocus:ie,onBlur:re,onInput:fe,onKeydown:b[1]||(b[1]=yt(P=>C(d.tab.url),["enter"]))},{prefix:S(()=>[s("div",{class:"size-6 rounded-full bg-white ml-1 overflow-hidden",style:G({"background-image":`url(${d.tab.title===d.$t("browser.newTab")?"https://www.baidu.com/favicon.ico":d.tab.icon})`,"background-size":"70%","background-repeat":"no-repeat","background-position":"center"}),alt:""},null,4)]),_:1},8,["modelValue","disabled","placeholder"]),d.tab.url&&c.value&&_.value?(i(),v("div",{key:0,class:"absolute left-0 right-0 z-10 py-4 bg-white px-3 shadow rounded-b",onClick:w},[j(d.tab.url)?(i(),v("div",{key:0,class:"h-9 px-4 mb-4 flex items-center gap-3 rounded-full cursor-pointer hover:bg-[#F2F2F2]",onClick:b[2]||(b[2]=Q(P=>C(d.tab.url),["stop"]))},[s("img",{class:"size-4",src:j(d.tab.url)?"https://chat.53ai.com/images/toolbox/website.png":"https://www.baidu.com/favicon.ico"},null,8,ns),s("div",as,D(d.tab.url),1)])):A("",!0),b[6]||(b[6]=s("div",{class:"text-sm text-[#9A9A9A] px-4 mb-2"},"问答搜索",-1)),(i(!0),v(Y,null,ee(W.value,P=>(i(),v("div",{key:P.value,class:"h-9 px-4 mt-1 flex items-center gap-3 rounded-full cursor-pointer hover:bg-[#F2F2F2]",onClick:Q(Te=>C(P.url+d.tab.url),["stop"])},[s("img",{class:"size-4",src:`https://chat.53ai.com/images/toolbox/${P.value}.png`},null,8,is),s("div",rs,D(d.tab.url),1)],8,ls))),128)),b[7]||(b[7]=s("div",{class:"text-sm text-[#9A9A9A] px-4 mt-4 mb-2"},"历史记录",-1)),(i(!0),v(Y,null,ee(H.value,P=>(i(),v("div",{key:P.value,class:"h-9 px-4 mt-1 flex items-center gap-3 rounded-full cursor-pointer hover:bg-[#F2F2F2]",onClick:Q(Te=>C(P.url),["stop"])},[b[5]||(b[5]=s("div",{class:"size-4"},null,-1)),s("div",cs,[ne(D(P.name)+"-",1),s("span",us,D(P.url),1)])],8,ds))),128))])):A("",!0)],2)]),o(m).toolbar_enabled&&d.tab.closable&&o($).is_login&&(!d.parent||d.parent&&d.parent.browsers.length===1)?(i(),v("div",ps,[s("div",{class:"h-8 px-2 rounded-full flex-center gap-1 bg-[#F5F5F5] cursor-pointer hover:bg-[#dbdbdb]",onClick:je},[g(Z,{name:"clean"}),s("span",fs,D(d.$t("browser.knowledge_clean")),1)]),(i(!0),v(Y,null,ee(o(m).toolbar_menus.slice(0,2),P=>(i(),v("div",{key:P.value,class:F(["h-8 px-2 rounded-full flex-center gap-1 bg-[#F5F5F5] hover:bg-[#dbdbdb]",[d.tab.loading==="completed"?"cursor-pointer":"opacity-50 cursor-not-allowed"]]),onClick:b[3]||(b[3]=Te=>$e())},[g(Z,{name:"setting",size:"16"}),s("span",vs,D(P.name),1)],2))),128)),L.value.length?(i(),N(Ye,{key:0,trigger:"click",onCommand:Ge},{dropdown:S(()=>[g(Xe,null,{default:S(()=>[(i(!0),v(Y,null,ee(L.value,P=>(i(),N(de,{key:P.value,command:P.value,disabled:d.tab.loading!=="completed"},{default:S(()=>[g(Z,{class:"mr-2",name:"setting",size:"16"}),ne(" "+D(P.name),1)]),_:2},1032,["command","disabled"]))),128)),g(de,{divided:"",command:"setting"},{default:S(()=>[g(Z,{class:"mr-2",name:"setting",size:"16"}),ne(" "+D(d.$t("action.setting")),1)]),_:1})]),_:1})]),default:S(()=>[s("div",bs,[g(h,{size:"14"},{default:S(()=>[g(o(kt))]),_:1})])]),_:1})):A("",!0)])):A("",!0)])):A("",!0),s("div",gs,[X((i(),v("div",hs,[d.tab.defaultUrl?(i(),v("webview",{key:0,ref_key:"webviewRef",ref:l,src:d.tab.defaultUrl,style:{height:"100%"},nodeintegration:"",allowpopups:"",preload:r(),webpreferences:"contextIsolation=no"},null,8,ms)):A("",!0),d.tab.loading==="error"?(i(),v("div",ws,[s("div",ys,[g(h,{class:"text-red-500 text-4xl mb-2"},{default:S(()=>[g(o(Pe))]),_:1}),s("p",_s,D(M.value),1),g(Ze,{class:"mt-4",type:"primary",onClick:T},{default:S(()=>[ne(D(d.$t("browser.reload")),1)]),_:1})])])):A("",!0),y.value?(i(),v("div",ks,[g(o(a),{content:B.value},null,8,["content"])])):A("",!0)])),[[Ke,U.value]]),k.value?X((i(),v("div",xs,[s("div",{class:"absolute right-1 top-1 cursor-pointer",onClick:b[4]||(b[4]=Q(P=>f.value=!1,["stop"]))},[g(h,null,{default:S(()=>[g(o(Ue))]),_:1})]),b[8]||(b[8]=s("div",{class:"h-full border rounded overflow-y-auto"},null,-1))],512)),[[ce,f.value]]):A("",!0)])])}}}),He=$t($s,[["__scopeId","data-v-fa648e40"]]),Cs={key:0,class:"absolute inset-0"},Fs=["onMousedown"],Es=K({__name:"MultiBrowser",props:{tab:{default:()=>({})}},setup(n){const e=I(null),r=I(!1),a=I(-1),p=I(null),$=I(0),x=(c,_,k)=>{c.preventDefault(),r.value=!0,a.value=_,p.value=k,$.value=c.clientX,document.body.style.cursor="col-resize",document.addEventListener("mousemove",m),document.addEventListener("mouseup",l)},m=c=>{if(!r.value||!p.value)return;c.preventDefault(),console.log(c);const _=c.clientX-$.value,k=e.value;if(!k)return;const f=k.offsetWidth,y=p.value.browsers,M=y[a.value],U=y[a.value+1],B=M.width||100/y.length,R=U.width||100/y.length,O=_/f*100,t=20,L=Math.min(Math.max(B+O,t),100-t),W=Math.min(Math.max(R-O,t),100-t);M.width=L,U.width=W,$.value=c.clientX},l=()=>{r.value=!1,a.value=-1,p.value=null,document.body.style.cursor="",window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",l)};return(c,_)=>(i(),v("div",{class:F(["h-full flex relative",{"select-none":r.value}]),ref_key:"containerRef",ref:e},[(i(!0),v(Y,null,ee(c.tab.browsers,(k,f)=>(i(),v(Y,{key:k.id},[g(He,{class:"flex-1",style:G({flexBasis:k.width?k.width+"%":"0%"}),parent:c.tab,tab:k},null,8,["style","parent","tab"]),r.value?(i(),v("div",Cs)):A("",!0),f<c.tab.browsers.length-1?(i(),v("div",{key:1,class:"w-1 hover:bg-blue-400 cursor-col-resize relative z-10",onMousedown:y=>x(y,f,c.tab)},null,40,Fs)):A("",!0)],64))),128))],2))}}),Ts=Be("user",{state:()=>({isLoggedIn:!1,eid:0,loginkey:"",accesstoken:"",userInfo:{},enteriseinfo:{}}),getters:{},actions:{login(n){this.isLoggedIn=!0,this.eid=n.eid,this.loginkey=n.loginkey,this.userInfo=n.userInfo,this.enteriseinfo=n.enteriseinfo,this.accesstoken=n.accesstoken},logout(){this.isLoggedIn=!1,this.eid=0,this.loginkey="",this.accesstoken="",this.userInfo={},this.enteriseinfo={}}}}),zs={class:"w-screen h-screen flex flex-col bg-[#F0F0F0]"},Ss={class:"h-10 flex items-center gap-3"},Is={class:"flex items-center gap-2 px-4 py-2 mt-2"},Ds=["src"],Ls={class:"flex-1 text-sm text-[#1D1E1F] truncate"},As={class:"flex items-center gap-2 px-3 py-2 border-t"},Ms={class:"h-8 flex-1 flex items-center gap-3 px-3"},Ps={class:"text-[#1D1E1F] text-sm"},Us={class:"flex items-center gap-2"},Rs={class:"flex flex-col gap-2 px-3 py-2 border-t"},Bs={class:"size-4 flex-center"},Ns={class:"size-4 flex-center"},Os={class:"text-[#1D1E1F] text-sm"},Ws={class:"size-4 flex-center"},Vs={class:"text-[#1D1E1F] text-sm"},Hs={class:"flex flex-col gap-2 px-3 py-2 border-t"},qs={class:"h-8 flex items-center gap-1 px-2 rounded-full text-[#474747] bg-[#E6E6E6] cursor-pointer nodrag"},Js=["src"],js={class:"flex no-drag"},eo=K({__name:"index",setup(n){const e=Ts(),r=_e(),a=Oe(),p=ke(),$=I(!1),x=I(!1),m=I(null),l=I(0),c=z(()=>a.info.avatar||window.$chat53ai.getPublicPath("/images/default_avatar.png")),_=z(()=>{const w=[...p.tabs];return w.sort((u,E)=>u.timestamp>E.timestamp?-1:1),w}),k=()=>({minimize:()=>window.$chat53ai.$win({type:"minimize"}),close:()=>window.$chat53ai.$win({type:"close"}),toggleMaximize:()=>{$.value=!$.value,window.$chat53ai.$win({type:$.value?"maximize":"restore"})}}),{minimize:f,close:y,toggleMaximize:M}=k(),U=w=>{window.$chat53ai.$win({type:"setPosition",data:{position:w}})},B=()=>{x.value=!x.value,window.$chat53ai.$win({type:"setAlwaysOnTop",data:{alwaysOnTop:x.value}})},R=()=>{window.$chat53ai.$win({type:"test",data:{}})},O=()=>{p.activeSetting()},t=(w=!0)=>{if(p.addTab({id:"main",title:"AI导航",closable:!1,ability:!1,icon:window.$chat53ai.getPublicPath("/images/home.png"),defaultUrl:p.MAIN_URL},!0),w){const u=p.tabs.find(E=>E.id==="main");u&&u.webview&&u.webview.send("agenthub:service",{type:"login"})}},L=()=>{p.closeTab("setting"),p.refreshTab("main"),p.updateTab("main",{title:"AI导航"}),a.logout(),window.$chat53ai.$win({type:"clearSession",data:{url:p.MAIN_URL}})},W=()=>{window.$chat53ai.$win({type:"setting",data:JSON.stringify({...r.$state})})},H=()=>{m.value=Jt({title:window.$t("updater.downloading"),message:()=>De("div",{class:"flex flex-col gap-2",percentage:l},[De(Ut,{percentage:l.value,format:w=>`${w}%`})]),duration:0,showClose:!1,position:"bottom-right",onClose:()=>{m.value=null}})},q=(w,u,E={})=>{p.addTab({id:w,title:"",icon:u+"/favicon.ico",ability:!1,closable:!0,defaultUrl:u,...E})},fe=async()=>{m.value||(l.value=0,await Le.confirm(window.$t("updater.newVersion"),window.$t("updater.newVersionTitle")),window.$chat53ai.$updater({type:"download"}))},ie=async()=>{m.value&&(m.value.close(),m.value=null,l.value=0),await Le.confirm(window.$t("updater.completed"),window.$t("updater.completedTitle")),window.$chat53ai.$updater({type:"restart"})},re=()=>{window.$chat53ai.$on("win:service",(w,{type:u,data:E}={})=>{switch(console.log(u,E,"成功"),u){case"login":e.login(JSON.parse(E)),W();break;case"agenthub_login":a.updateInfo(JSON.parse(E)),p.updateTab("main",{title:"首页"});break;case"agenthub_logout":L();break;case"setting":r.$patch(JSON.parse(E));break;case"new-window":p.addTab({url:E.url,defaultUrl:E.url});break;case"new-tab":const T=JSON.parse(E);if(T.urls.length===1)p.addTab({title:T.title,type:"browser",closable:T.closable===void 0?!0:T.closable,ability:T.ability===void 0?!0:T.ability,defaultUrl:T.urls[0]});else{const V=p.addTab({title:T.title,type:"multibrowser"});T.urls.forEach(j=>{p.addChildTab(V.id,{defaultUrl:j})})}break;case"maximize":$.value=!0;break;case"unmaximize":$.value=!1;break;case"glider:setting":O();break;case"glider:forbid":r.glider_enabled=!1;break}}),window.$chat53ai.$on("glider:service",(w,{type:u,data:E}={})=>{console.log(u,E,"成功")}),window.$chat53ai.$on("updater:service",(w,{type:u,data:E}={})=>{switch(console.log(u,E,"成功"),u){case"available":fe();break;case"progress":l.value=Math.floor(E.percent),m.value||H();break;case"error":m.value&&(m.value.close(),m.value=null),Tt.error(E);break;case"downloaded":ie();break}})};return Ct(r.$state,(w,u)=>{console.log("settingStore 发生变化:",w,u),W()},{deep:!0}),pe(()=>{const w=new URLSearchParams(location.search);w.get("window")==="main"?t(!1):p.addTab({title:window.$t("browser.newTab"),closable:!0,defaultUrl:decodeURIComponent(w.get("url")||"")}),re()}),(w,u)=>{const E=We,T=ye("svg-icon"),V=Et,j=Ft("tooltip");return i(),v("div",zs,[s("div",Ss,[g(Qt,{class:"flex-1 overflow-hidden"}),g(V,{effect:"light",placement:"bottom-end","popper-class":"!p-0 w-[300px]"},{content:S(()=>[s("div",Is,[s("img",{class:"flex-none w-10 h-10 rounded-full",src:c.value},null,8,Ds),s("div",Ls,D(o(a).info.nickname||w.$t("browser.not_logged_in")),1),o(a).is_login?A("",!0):(i(),N(E,{key:0,type:"primary",onClick:u[0]||(u[0]=C=>t(!0))},{default:S(()=>[ne(D(w.$t("browser.login")),1)]),_:1}))]),s("div",As,[s("div",Ms,[u[9]||(u[9]=s("img",{src:jt,alt:"",class:"w-4 h-4"},null,-1)),s("span",Ps,D(w.$t("browser.window_position")),1)]),s("div",Us,[X((i(),v("div",{class:"size-6 flex-center rounded bg-[#F0EFEF] cursor-pointer",onClick:u[1]||(u[1]=C=>U("left"))},[g(T,{name:"justify-left"})])),[[j,{content:w.$t("browser.leftWindow")}]]),X((i(),v("div",{class:"size-6 flex-center rounded bg-[#F0EFEF] cursor-pointer",onClick:u[2]||(u[2]=C=>U("center"))},[g(T,{name:"justify-center"})])),[[j,{content:w.$t("browser.centerWindow")}]]),X((i(),v("div",{class:"size-6 flex-center rounded bg-[#F0EFEF] cursor-pointer",onClick:u[3]||(u[3]=C=>U("right"))},[g(T,{name:"justify-right"})])),[[j,{content:w.$t("browser.rightWindow")}]]),u[10]||(u[10]=s("div",{class:"h-[14px] border-r"},null,-1)),X((i(),v("div",{class:"size-6 flex-center rounded bg-[#F0EFEF] cursor-pointer",onClick:B},[g(T,{name:"top",color:x.value?"#1D1E1F":"#C4C4C4"},null,8,["color"])])),[[j,{content:w.$t("browser.alwaysOnTop")}]])])]),s("div",Rs,[s("div",{class:"h-8 flex items-center gap-3 px-3 rounded cursor-pointer hover:bg-[#F0EFEF]",onClick:R},[s("div",Bs,[g(T,{size:"16",name:"setting"})]),u[11]||(u[11]=s("span",{class:"text-[#1D1E1F] text-sm"},D("调试"),-1))]),s("div",{class:"h-8 flex items-center gap-3 px-3 rounded cursor-pointer hover:bg-[#F0EFEF]",onClick:O},[s("div",Ns,[g(T,{size:"16",name:"setting"})]),s("span",Os,D(w.$t("action.setting")),1)]),o(a).is_login?(i(),v("div",{key:0,class:"h-8 flex items-center gap-3 px-3 rounded cursor-pointer hover:bg-[#F0EFEF]",onClick:L},[s("div",Ws,[g(T,{size:"14",name:"quit"})]),s("span",Vs,D(w.$t("login.quit")),1)])):A("",!0)]),s("div",Hs,[s("div",{class:"h-8 flex items-center gap-3 px-3 rounded cursor-pointer hover:bg-[#F0EFEF]",onClick:u[4]||(u[4]=C=>q("53ai_offical","https://www.53ai.com/",{title:"53AI"}))},u[12]||(u[12]=[s("div",{class:"size-4 flex-center"},[s("img",{src:"https://www.53ai.com/favicon.ico",class:"size-4"})],-1),s("span",{class:"text-[#1D1E1F] text-sm"},D("53AI"),-1)])),s("div",{class:"h-8 flex items-center gap-3 px-3 rounded cursor-pointer hover:bg-[#F0EFEF]",onClick:u[5]||(u[5]=C=>q("53ai_studio","http://chatrc.53ai.com/",{title:"53AI Studio"}))},u[13]||(u[13]=[s("div",{class:"size-4 flex-center"},[s("img",{src:"https://chat.53ai.com/favicon.ico",class:"size-4"})],-1),s("span",{class:"text-[#1D1E1F] text-sm"},D("53AI Studio"),-1)]))])]),default:S(()=>[s("div",qs,[s("img",{class:"size-6 rounded-full",src:c.value,alt:""},null,8,Js),g(T,{name:"down",size:"18"})])]),_:1}),s("nav",js,[s("div",{class:"size-10 flex-center cursor-pointer text-[#333333] hover:bg-[#C6CCD1]",onClick:u[6]||(u[6]=(...C)=>o(f)&&o(f)(...C))},[g(T,{name:"mini",size:"14"})]),s("div",{class:"size-10 flex-center cursor-pointer text-[#333333] hover:bg-[#C6CCD1]",onClick:u[7]||(u[7]=(...C)=>o(M)&&o(M)(...C))},[g(T,{name:$.value?"zoom-in":"zoom-out",size:"14"},null,8,["name"])]),s("div",{class:"size-10 flex-center cursor-pointer text-[#333333] hover:bg-[#C6CCD1]",onClick:u[8]||(u[8]=(...C)=>o(y)&&o(y)(...C))},[g(T,{name:"close",size:"14"})])])]),(i(!0),v(Y,null,ee(_.value,C=>X((i(),v("div",{class:"flex-1 rounded-t-lg overflow-hidden",key:C.id},[C.render?C.type==="browser"?(i(),N(He,{key:1,class:"h-full",tab:C},null,8,["tab"])):C.type==="page"?(i(),N(we(C.component),{key:2})):C.type==="multibrowser"?(i(),N(Es,{key:3,tab:C},null,8,["tab"])):A("",!0):(i(),v(Y,{key:0},[],64))])),[[ce,C.id===o(p).activeId]])),128))])}}});export{eo as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-BLoEAvJR.js","assets/main-BkqrklTl.js","assets/main-BvCzSCAK.css","assets/el-tab-pane-BrDfsG7z.js","assets/index-1x5IBe2-.js","assets/el-tab-pane-BMLBX8qJ.css","assets/header.vue_vue_type_script_setup_true_lang-BGwydLJB.js","assets/el-tooltip-l0sNRNKZ.js","assets/el-image-viewer-BGyL1NfI.js","assets/el-image-viewer-DG_2v4dI.css","assets/enterprise-DwbAl3jb.js","assets/global-DJriCW9S.js","assets/el-popper-BQQS4pqe.css","assets/browser-setting-CSmEtH2O.js","assets/index-DIDA4GZy.js","assets/el-dropdown-item-Ca9Z_2s8.js","assets/el-dropdown-item-CnPF8_aM.css","assets/index-BAhamOcb.js","assets/upload-CLzFaZGY.js","assets/upload-Ca9gIz_i.css","assets/index-CFvZT9Dd.css","assets/index-oRsP0abO.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/index-BVAaFgvl.css","assets/index-B49t2MBk.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
