import{cA as M,an as b,cB as C,a8 as A,a9 as I,aa as D}from"./main-A2Vq01lO.js";var W=/\s/;function J(e){for(var t=e.length;t--&&W.test(e.charAt(t)););return t}var $=/^\s+/;function q(e){return e&&e.slice(0,J(e)+1).replace($,"")}var P=NaN,B=/^[-+]0x[0-9a-f]+$/i,F=/^0b[01]+$/i,j=/^0o[0-7]+$/i,R=parseInt;function k(e){if(typeof e=="number")return e;if(M(e))return P;if(b(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=b(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=q(e);var n=F.test(e);return n||j.test(e)?R(e.slice(2),n?2:8):B.test(e)?P:+e}var S=function(){return C.Date.now()},K="Expected a function",U=Math.max,z=Math.min;function X(e,t,n){var i,a,s,l,o,c,u=0,p=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(K);t=k(t)||0,b(n)&&(p=!!n.leading,f="maxWait"in n,s=f?U(k(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function _(r){var m=i,y=a;return i=a=void 0,u=r,l=e.apply(y,m),l}function O(r){return u=r,o=setTimeout(g,t),p?_(r):l}function L(r){var m=r-c,y=r-u,v=t-m;return f?z(v,s-y):v}function x(r){var m=r-c,y=r-u;return c===void 0||m>=t||m<0||f&&y>=s}function g(){var r=S();if(x(r))return T(r);o=setTimeout(g,L(r))}function T(r){return o=void 0,h&&i?_(r):(i=a=void 0,l)}function N(){o!==void 0&&clearTimeout(o),u=0,i=c=a=o=void 0}function w(){return o===void 0?l:T(S())}function E(){var r=S(),m=x(r);if(i=arguments,a=this,c=r,m){if(o===void 0)return O(c);if(f)return clearTimeout(o),o=setTimeout(g,t),_(c)}return o===void 0&&(o=setTimeout(g,t)),l}return E.cancel=N,E.flush=w,E}const G={current(){return A.get("/api/enterprises/current").catch(I)},get(e){return A.get(`/api/enterprises/${e}`).catch(I)}},d=window.$getPublicPath("/images/default_logo.png"),Q=D("enterprise-store",{state:()=>({logo:d,ico:d,display_name:"",language:"zh-cn",copyright:"",keywords:[],description:"",banner_info:{url_list:[],interval:""},template_style_info:{}}),actions:{initTemplateStyle(){let{theme_color:e,text_color:t,nav_bg_color:n,nav_text_color:i,page_footer_bg_color:a,page_footer_text_color:s}=this.template_style_info;e=e||"#2563eb",t=t||"#333333",n=n||"#ffffff",i=i||"#333333",a=a||"#18191f",s=s||"#f2f2f2",document.documentElement.style.setProperty("--el-color-primary",e),document.documentElement.style.setProperty("--el-color-primary-light-3",e+"cc"),document.documentElement.style.setProperty("--el-color-primary-light-5",e+"aa"),document.documentElement.style.setProperty("--el-color-primary-light-7",e+"99"),document.documentElement.style.setProperty("--el-color-primary-light-8",e+"66"),document.documentElement.style.setProperty("--el-color-primary-light-9",e+"33"),document.documentElement.style.setProperty("--el-text-color-primary",t),document.documentElement.style.setProperty("--el-text-color-regular",t+"cc"),document.documentElement.style.setProperty("--el-text-color-secondary",t+"99"),document.documentElement.style.setProperty("--el-text-color-placeholder",t+"66"),document.documentElement.style.setProperty("--el-color-nav-bg",n),document.documentElement.style.setProperty("--el-color-nav-text",i),document.documentElement.style.setProperty("--el-color-page-footer-bg",a),document.documentElement.style.setProperty("--el-color-page-footer-text",s)},setMetaDescription(e=""){if(this.description=e,!e)return;const t=document.querySelector('meta[name="description"]');if(t)t.setAttribute("content",e);else{const n=document.createElement("meta");n.setAttribute("name","description"),n.setAttribute("content",e),document.head.appendChild(n)}},setMetaKeywords(e=[]){if(this.keywords=e,!e.length)return;const t=document.querySelector('meta[name="keywords"]');if(t)t.setAttribute("content",e.join(", "));else{const n=document.createElement("meta");n.setAttribute("name","keywords"),n.setAttribute("content",e.join(", ")),document.head.appendChild(n)}},setDocumentTitleAndIcon(e,t){document.title=e;const n=document.querySelector('link[rel="icon"]')||document.createElement("link");n.rel="icon",n.href=t||d,document.querySelector('link[rel="icon"]')||document.head.appendChild(n)},setAppLanguage(e){const t=e==="En"?"en":e;this.language=t},saveToStorage(){localStorage.setItem("enterprise",JSON.stringify({logo:this.logo,display_name:this.display_name,language:this.language}))},async loadFromStorage(){const e=localStorage.getItem("enterprise");if(e)try{const t=JSON.parse(e);this.logo=t.logo||d,this.display_name=t.display_name,this.language=t.language,this.setDocumentTitleAndIcon(t.display_name,t.logo),this.setAppLanguage(t.language)}catch(t){console.error("解析localStorage中的企业信息失败",t)}return this},async loadInfo(){try{const e=await G.current(),{display_name:t,logo:n,language:i,copyright:a,ico:s,keywords:l,description:o,banner:c,template_type:u}=e.data.enterprise;this.logo=n||d,this.ico=s||this.logo||d,this.display_name=t,this.copyright=a,this.description=o||"";try{this.keywords=JSON.parse(l||"[]")}catch{this.keywords=[]}try{this.banner_info=JSON.parse(c||"{}")}catch{this.banner_info={url_list:[],interval:""}}try{this.template_style_info=JSON.parse(u||"{}")}catch{this.template_style_info={}}this.setAppLanguage(i),this.setDocumentTitleAndIcon(t,this.ico),this.setMetaKeywords(this.keywords),this.setMetaDescription(this.description),this.saveToStorage(),this.initTemplateStyle()}catch(e){console.error("获取企业信息失败",e)}finally{return this}}}});export{X as d,k as t,Q as u};
