import{bL as Bo,an as Ee,bM as Mo,ak as se,B as X,ba as Lo,bm as Ro,P as B,r as O,al as Te,ao as so,bN as Fo,ap as ao,i as G,b as w,j as m,f,T as Ne,R as p,h as ne,bO as lo,aH as ro,d as y,aV as be,$ as ie,c as D,e as J,n as L,aq as j,t as U,a3 as ge,aI as Pe,v as Ie,aP as Oo,ar as io,a_ as W,o as De,b1 as ze,b9 as me,av as ee,bP as te,bd as he,bQ as Ao,az as ke,aG as No,E as R,aW as Po,aX as Do,aw as zo,bR as je,bS as Vo,aQ as q,bT as Ko,bU as co,ah as uo,bV as Uo,bD as po,a0 as Be,bk as Ho,bW as Go,am as Se,b2 as fo,Y as fe,aj as pe,K as ve,bX as mo,bY as qe,D as Le,bZ as Jo,bc as vo,b_ as We,Z as $e,F as oe,b$ as Yo,W as Ve,a6 as jo,M as ye,aB as Re,c0 as Xe,c1 as Ze,c2 as qo,c3 as Wo,c4 as Xo,a5 as Zo,c5 as Fe,a9 as Ke,p as Qo,y as go,c6 as _o,c7 as Qe,ac as ho,m as xe,b7 as xo,O as en,N as we,V as on,L as Oe,br as nn,G as tn,c8 as eo,c9 as sn,S as an,_ as ln,ca as rn,a2 as cn,U as dn}from"./main-aAIm056l.js";import{_ as un}from"./main-header.vue_vue_type_script_setup_true_lang-RV1Mzk-t.js";import{E as pn}from"./el-scrollbar-CRdGezmP.js";import{E as fn}from"./el-empty-D6EjX5es.js";import{i as mn,E as vn,u as gn}from"./upload-x30JhNMy.js";import{E as _n,a as hn}from"./el-tab-pane-BztERYO7.js";import{u as bo,c as bn}from"./conversation-YNrc7lkp.js";import"./el-image-viewer-D-9gw56f.js";import"./debounce-UTQm1j_w.js";import"./el-loading-CP_lVFA8.js";import"./enterprise-D8ZxfHL9.js";import"./global-BKHxfx8f.js";import"./strings-oHfTK6PU.js";import"./index-BdiUoNw0.js";const yn=Ee({...Mo,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),wn=Bo,Cn=X({name:"ElDrawer",inheritAttrs:!1}),En=X({...Cn,props:yn,emits:wn,setup(e,{expose:o}){const i=e,l=Lo();Ro({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},B(()=>!!l.title));const d=O(),a=O(),u=Te("drawer"),{t:v}=so(),{afterEnter:h,afterLeave:t,beforeLeave:s,visible:b,rendered:A,titleId:r,bodyId:_,zIndex:C,onModalClick:T,onOpenAutoFocus:P,onCloseAutoFocus:N,onFocusoutPrevented:M,onCloseRequested:F,handleClose:z}=Fo(i,d),V=B(()=>i.direction==="rtl"||i.direction==="ltr"),H=B(()=>ao(i.size));return o({handleClose:z,afterEnter:h,afterLeave:t}),($,n)=>(w(),G(p(Oo),{to:$.appendTo,disabled:$.appendTo!=="body"?!1:!$.appendToBody},{default:m(()=>[f(Ne,{name:p(u).b("fade"),onAfterEnter:p(h),onAfterLeave:p(t),onBeforeLeave:p(s),persisted:""},{default:m(()=>[ne(f(p(lo),{mask:$.modal,"overlay-class":$.modalClass,"z-index":p(C),onClick:p(T)},{default:m(()=>[f(p(ro),{loop:"",trapped:p(b),"focus-trap-el":d.value,"focus-start-el":a.value,onFocusAfterTrapped:p(P),onFocusAfterReleased:p(N),onFocusoutPrevented:p(M),onReleaseRequested:p(F)},{default:m(()=>[y("div",be({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":$.title||void 0,"aria-labelledby":$.title?void 0:p(r),"aria-describedby":p(_)},$.$attrs,{class:[p(u).b(),$.direction,p(b)&&"open"],style:p(V)?"width: "+p(H):"height: "+p(H),role:"dialog",onClick:ie(()=>{},["stop"])}),[y("span",{ref_key:"focusStartRef",ref:a,class:L(p(u).e("sr-focus")),tabindex:"-1"},null,2),$.withHeader?(w(),D("header",{key:0,class:L([p(u).e("header"),$.headerClass])},[$.$slots.title?j($.$slots,"title",{key:1},()=>[J(" DEPRECATED SLOT ")]):j($.$slots,"header",{key:0,close:p(z),titleId:p(r),titleClass:p(u).e("title")},()=>[$.$slots.title?J("v-if",!0):(w(),D("span",{key:0,id:p(r),role:"heading","aria-level":$.headerAriaLevel,class:L(p(u).e("title"))},U($.title),11,["id","aria-level"]))]),$.showClose?(w(),D("button",{key:2,"aria-label":p(v)("el.drawer.close"),class:L(p(u).e("close-btn")),type:"button",onClick:p(z)},[f(p(ge),{class:L(p(u).e("close"))},{default:m(()=>[f(p(Pe))]),_:1},8,["class"])],10,["aria-label","onClick"])):J("v-if",!0)],2)):J("v-if",!0),p(A)?(w(),D("div",{key:1,id:p(_),class:L([p(u).e("body"),$.bodyClass])},[j($.$slots,"default")],10,["id"])):J("v-if",!0),$.$slots.footer?(w(),D("div",{key:2,class:L([p(u).e("footer"),$.footerClass])},[j($.$slots,"footer")],2)):J("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Ie,p(b)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var $n=se(En,[["__file","drawer.vue"]]);const In=io($n),kn=X({inheritAttrs:!1});function Sn(e,o,i,l,d,a){return j(e.$slots,"default")}var Tn=se(kn,[["render",Sn],["__file","collection.vue"]]);const Bn=X({name:"ElCollectionItem",inheritAttrs:!1});function Mn(e,o,i,l,d,a){return j(e.$slots,"default")}var Ln=se(Bn,[["render",Mn],["__file","collection-item.vue"]]);const yo="data-el-collection-item",wo=e=>{const o=`El${e}Collection`,i=`${o}Item`,l=Symbol(o),d=Symbol(i),a={...Tn,name:o,setup(){const v=O(),h=new Map;me(l,{itemMap:h,getItems:()=>{const s=p(v);if(!s)return[];const b=Array.from(s.querySelectorAll(`[${yo}]`));return[...h.values()].sort((r,_)=>b.indexOf(r.ref)-b.indexOf(_.ref))},collectionRef:v})}},u={...Ln,name:i,setup(v,{attrs:h}){const t=O(),s=W(l,void 0);me(d,{collectionItemRef:t}),De(()=>{const b=p(t);b&&s.itemMap.set(b,{ref:b,...h})}),ze(()=>{const b=p(t);s.itemMap.delete(b)})}};return{COLLECTION_INJECTION_KEY:l,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:a,ElCollectionItem:u}},Rn=Ee({style:{type:ee([String,Array,Object])},currentTabId:{type:ee(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:ee(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Fn,ElCollectionItem:On,COLLECTION_INJECTION_KEY:Ue,COLLECTION_ITEM_INJECTION_KEY:An}=wo("RovingFocusGroup"),He=Symbol("elRovingFocusGroup"),Co=Symbol("elRovingFocusGroupItem"),Nn={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Pn=(e,o)=>e,Dn=(e,o,i)=>{const l=Pn(e.code);return Nn[l]},zn=(e,o)=>e.map((i,l)=>e[(l+o)%e.length]),Ge=e=>{const{activeElement:o}=document;for(const i of e)if(i===o||(i.focus(),o!==document.activeElement))return},oo="currentTabIdChange",no="rovingFocusGroup.entryFocus",Vn={bubbles:!1,cancelable:!0},Kn=X({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:Rn,emits:[oo,"entryFocus"],setup(e,{emit:o}){var i;const l=O((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=O(!1),a=O(!1),u=O(),{getItems:v}=W(Ue,void 0),h=B(()=>[{outline:"none"},e.style]),t=C=>{o(oo,C)},s=()=>{d.value=!0},b=te(C=>{var T;(T=e.onMousedown)==null||T.call(e,C)},()=>{a.value=!0}),A=te(C=>{var T;(T=e.onFocus)==null||T.call(e,C)},C=>{const T=!p(a),{target:P,currentTarget:N}=C;if(P===N&&T&&!p(d)){const M=new Event(no,Vn);if(N==null||N.dispatchEvent(M),!M.defaultPrevented){const F=v().filter(n=>n.focusable),z=F.find(n=>n.active),V=F.find(n=>n.id===p(l)),$=[z,V,...F].filter(Boolean).map(n=>n.ref);Ge($)}}a.value=!1}),r=te(C=>{var T;(T=e.onBlur)==null||T.call(e,C)},()=>{d.value=!1}),_=(...C)=>{o("entryFocus",...C)};me(He,{currentTabbedId:Ao(l),loop:he(e,"loop"),tabIndex:B(()=>p(d)?-1:0),rovingFocusGroupRef:u,rovingFocusGroupRootStyle:h,orientation:he(e,"orientation"),dir:he(e,"dir"),onItemFocus:t,onItemShiftTab:s,onBlur:r,onFocus:A,onMousedown:b}),ke(()=>e.currentTabId,C=>{l.value=C??null}),No(u,no,_)}});function Un(e,o,i,l,d,a){return j(e.$slots,"default")}var Hn=se(Kn,[["render",Un],["__file","roving-focus-group-impl.vue"]]);const Gn=X({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Fn,ElRovingFocusGroupImpl:Hn}});function Jn(e,o,i,l,d,a){const u=R("el-roving-focus-group-impl"),v=R("el-focus-group-collection");return w(),G(v,null,{default:m(()=>[f(u,Po(Do(e.$attrs)),{default:m(()=>[j(e.$slots,"default")]),_:3},16)]),_:3})}var Yn=se(Gn,[["render",Jn],["__file","roving-focus-group.vue"]]);const jn=Ee({trigger:Ko.trigger,triggerKeys:{type:ee(Array),default:()=>[q.enter,q.numpadEnter,q.space,q.down]},effect:{...je.effect,default:"light"},type:{type:ee(String)},placement:{type:ee(String),default:"bottom"},popperOptions:{type:ee(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:ee([Number,String]),default:0},maxHeight:{type:ee([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,values:Vo,default:"menu"},buttonProps:{type:ee(Object)},teleported:je.teleported,persistent:{type:Boolean,default:!0}}),Eo=Ee({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:zo}}),qn=Ee({onKeydown:{type:ee(Function)}}),Wn=[q.down,q.pageDown,q.home],$o=[q.up,q.pageUp,q.end],Xn=[...Wn,...$o],{ElCollection:Zn,ElCollectionItem:Qn,COLLECTION_INJECTION_KEY:xn,COLLECTION_ITEM_INJECTION_KEY:et}=wo("Dropdown"),Me=Symbol("elDropdown"),{ButtonGroup:ot}=Be,nt=X({name:"ElDropdown",components:{ElButton:Be,ElButtonGroup:ot,ElScrollbar:pn,ElDropdownCollection:Zn,ElTooltip:po,ElRovingFocusGroup:Yn,ElOnlyChild:Uo,ElIcon:ge,ArrowDown:uo},props:jn,emits:["visible-change","click","command"],setup(e,{emit:o}){const i=fo(),l=Te("dropdown"),{t:d}=so(),a=O(),u=O(),v=O(),h=O(),t=O(null),s=O(null),b=O(!1),A=B(()=>({maxHeight:ao(e.maxHeight)})),r=B(()=>[l.m(F.value)]),_=B(()=>Go(e.trigger)),C=Se().value,T=B(()=>e.id||C);ke([a,_],([c,S],[k])=>{var Q,Y,x;(Q=k==null?void 0:k.$el)!=null&&Q.removeEventListener&&k.$el.removeEventListener("pointerenter",V),(Y=c==null?void 0:c.$el)!=null&&Y.removeEventListener&&c.$el.removeEventListener("pointerenter",V),(x=c==null?void 0:c.$el)!=null&&x.addEventListener&&S.includes("hover")&&c.$el.addEventListener("pointerenter",V)},{immediate:!0}),ze(()=>{var c,S;(S=(c=a.value)==null?void 0:c.$el)!=null&&S.removeEventListener&&a.value.$el.removeEventListener("pointerenter",V)});function P(){N()}function N(){var c;(c=v.value)==null||c.onClose()}function M(){var c;(c=v.value)==null||c.onOpen()}const F=Ho();function z(...c){o("command",...c)}function V(){var c,S;(S=(c=a.value)==null?void 0:c.$el)==null||S.focus()}function H(){}function $(){const c=p(h);_.value.includes("hover")&&(c==null||c.focus()),s.value=null}function n(c){s.value=c}function g(c){b.value||(c.preventDefault(),c.stopImmediatePropagation())}function E(){o("visible-change",!0)}function I(c){var S;(c==null?void 0:c.type)==="keydown"&&((S=h.value)==null||S.focus())}function K(){o("visible-change",!1)}return me(Me,{contentRef:h,role:B(()=>e.role),triggerId:T,isUsingKeyboard:b,onItemEnter:H,onItemLeave:$}),me("elDropdown",{instance:i,dropdownSize:F,handleClick:P,commandHandler:z,trigger:he(e,"trigger"),hideOnClick:he(e,"hideOnClick")}),{t:d,ns:l,scrollbar:t,wrapStyle:A,dropdownTriggerKls:r,dropdownSize:F,triggerId:T,currentTabId:s,handleCurrentTabIdChange:n,handlerMainButtonClick:c=>{o("click",c)},handleEntryFocus:g,handleClose:N,handleOpen:M,handleBeforeShowTooltip:E,handleShowTooltip:I,handleBeforeHideTooltip:K,onFocusAfterTrapped:c=>{var S,k;c.preventDefault(),(k=(S=h.value)==null?void 0:S.focus)==null||k.call(S,{preventScroll:!0})},popperRef:v,contentRef:h,triggeringElementRef:a,referenceElementRef:u}}});function tt(e,o,i,l,d,a){var u;const v=R("el-dropdown-collection"),h=R("el-roving-focus-group"),t=R("el-scrollbar"),s=R("el-only-child"),b=R("el-tooltip"),A=R("el-button"),r=R("arrow-down"),_=R("el-icon"),C=R("el-button-group");return w(),D("div",{class:L([e.ns.b(),e.ns.is("disabled",e.disabled)])},[f(b,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(u=e.referenceElementRef)==null?void 0:u.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:e.persistent,onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},co({content:m(()=>[f(t,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:m(()=>[f(h,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:m(()=>[f(v,null,{default:m(()=>[j(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:m(()=>[f(s,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:m(()=>[j(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","persistent","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(w(),G(C,{key:0},{default:m(()=>[f(A,be({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:m(()=>[j(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),f(A,be({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:m(()=>[f(_,{class:L(e.ns.e("icon"))},{default:m(()=>[f(r)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):J("v-if",!0)],2)}var st=se(nt,[["render",tt],["__file","dropdown.vue"]]);const at=X({components:{ElRovingFocusCollectionItem:On},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:o}){const{currentTabbedId:i,loop:l,onItemFocus:d,onItemShiftTab:a}=W(He,void 0),{getItems:u}=W(Ue,void 0),v=Se(),h=O(),t=te(r=>{o("mousedown",r)},r=>{e.focusable?d(p(v)):r.preventDefault()}),s=te(r=>{o("focus",r)},()=>{d(p(v))}),b=te(r=>{o("keydown",r)},r=>{const{code:_,shiftKey:C,target:T,currentTarget:P}=r;if(_===q.tab&&C){a();return}if(T!==P)return;const N=Dn(r);if(N){r.preventDefault();let F=u().filter(z=>z.focusable).map(z=>z.ref);switch(N){case"last":{F.reverse();break}case"prev":case"next":{N==="prev"&&F.reverse();const z=F.indexOf(P);F=l.value?zn(F,z+1):F.slice(z+1);break}}fe(()=>{Ge(F)})}}),A=B(()=>i.value===p(v));return me(Co,{rovingFocusGroupItemRef:h,tabIndex:B(()=>p(A)?0:-1),handleMousedown:t,handleFocus:s,handleKeydown:b}),{id:v,handleKeydown:b,handleFocus:s,handleMousedown:t}}});function lt(e,o,i,l,d,a){const u=R("el-roving-focus-collection-item");return w(),G(u,{id:e.id,focusable:e.focusable,active:e.active},{default:m(()=>[j(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var rt=se(at,[["render",lt],["__file","roving-focus-item.vue"]]);const it=X({name:"DropdownItemImpl",components:{ElIcon:ge},props:Eo,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:o}){const i=Te("dropdown"),{role:l}=W(Me,void 0),{collectionItemRef:d}=W(et,void 0),{collectionItemRef:a}=W(An,void 0),{rovingFocusGroupItemRef:u,tabIndex:v,handleFocus:h,handleKeydown:t,handleMousedown:s}=W(Co,void 0),b=mo(d,a,u),A=B(()=>l.value==="menu"?"menuitem":l.value==="navigation"?"link":"button"),r=te(_=>{if([q.enter,q.numpadEnter,q.space].includes(_.code))return _.preventDefault(),_.stopImmediatePropagation(),o("clickimpl",_),!0},t);return{ns:i,itemRef:b,dataset:{[yo]:""},role:A,tabIndex:v,handleFocus:h,handleKeydown:r,handleMousedown:s}}});function ct(e,o,i,l,d,a){const u=R("el-icon");return w(),D(ve,null,[e.divided?(w(),D("li",{key:0,role:"separator",class:L(e.ns.bem("menu","item","divided"))},null,2)):J("v-if",!0),y("li",be({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:v=>e.$emit("clickimpl",v),onFocus:e.handleFocus,onKeydown:ie(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:v=>e.$emit("pointermove",v),onPointerleave:v=>e.$emit("pointerleave",v)}),[e.icon?(w(),G(u,{key:0},{default:m(()=>[(w(),G(pe(e.icon)))]),_:1})):J("v-if",!0),j(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var dt=se(it,[["render",ct],["__file","dropdown-item-impl.vue"]]);const Io=()=>{const e=W("elDropdown",{}),o=B(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:o}},ut=X({name:"ElDropdownItem",components:{ElDropdownCollectionItem:Qn,ElRovingFocusItem:rt,ElDropdownItemImpl:dt},inheritAttrs:!1,props:Eo,emits:["pointermove","pointerleave","click"],setup(e,{emit:o,attrs:i}){const{elDropdown:l}=Io(),d=fo(),a=O(null),u=B(()=>{var r,_;return(_=(r=p(a))==null?void 0:r.textContent)!=null?_:""}),{onItemEnter:v,onItemLeave:h}=W(Me,void 0),t=te(r=>(o("pointermove",r),r.defaultPrevented),qe(r=>{if(e.disabled){h(r);return}const _=r.currentTarget;_===document.activeElement||_.contains(document.activeElement)||(v(r),r.defaultPrevented||_==null||_.focus())})),s=te(r=>(o("pointerleave",r),r.defaultPrevented),qe(h)),b=te(r=>{if(!e.disabled)return o("click",r),r.type!=="keydown"&&r.defaultPrevented},r=>{var _,C,T;if(e.disabled){r.stopImmediatePropagation();return}(_=l==null?void 0:l.hideOnClick)!=null&&_.value&&((C=l.handleClick)==null||C.call(l)),(T=l.commandHandler)==null||T.call(l,e.command,d,r)}),A=B(()=>({...e,...i}));return{handleClick:b,handlePointerMove:t,handlePointerLeave:s,textContent:u,propsAndAttrs:A}}});function pt(e,o,i,l,d,a){var u;const v=R("el-dropdown-item-impl"),h=R("el-roving-focus-item"),t=R("el-dropdown-collection-item");return w(),G(t,{disabled:e.disabled,"text-value":(u=e.textValue)!=null?u:e.textContent},{default:m(()=>[f(h,{focusable:!e.disabled},{default:m(()=>[f(v,be(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:m(()=>[j(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var ko=se(ut,[["render",pt],["__file","dropdown-item.vue"]]);const ft=X({name:"ElDropdownMenu",props:qn,setup(e){const o=Te("dropdown"),{_elDropdownSize:i}=Io(),l=i.value,{focusTrapRef:d,onKeydown:a}=W(Jo,void 0),{contentRef:u,role:v,triggerId:h}=W(Me,void 0),{collectionRef:t,getItems:s}=W(xn,void 0),{rovingFocusGroupRef:b,rovingFocusGroupRootStyle:A,tabIndex:r,onBlur:_,onFocus:C,onMousedown:T}=W(He,void 0),{collectionRef:P}=W(Ue,void 0),N=B(()=>[o.b("menu"),o.bm("menu",l==null?void 0:l.value)]),M=mo(u,t,d,b,P),F=te(V=>{var H;(H=e.onKeydown)==null||H.call(e,V)},V=>{const{currentTarget:H,code:$,target:n}=V;if(H.contains(n),q.tab===$&&V.stopImmediatePropagation(),V.preventDefault(),n!==p(u)||!Xn.includes($))return;const E=s().filter(I=>!I.disabled).map(I=>I.ref);$o.includes($)&&E.reverse(),Ge(E)});return{size:l,rovingFocusGroupRootStyle:A,tabIndex:r,dropdownKls:N,role:v,triggerId:h,dropdownListWrapperRef:M,handleKeydown:V=>{F(V),a(V)},onBlur:_,onFocus:C,onMousedown:T}}});function mt(e,o,i,l,d,a){return w(),D("ul",{ref:e.dropdownListWrapperRef,class:L(e.dropdownKls),style:Le(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:ie(e.handleKeydown,["self"]),onMousedown:ie(e.onMousedown,["self"])},[j(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var So=se(ft,[["render",mt],["__file","dropdown-menu.vue"]]);const vt=io(st,{DropdownItem:ko,DropdownMenu:So}),gt=vo(ko),_t=vo(So),Ae="_trap-focus-children",ce=[],to=e=>{if(ce.length===0)return;const o=ce[ce.length-1][Ae];if(o.length>0&&e.code===q.tab){if(o.length===1){e.preventDefault(),document.activeElement!==o[0]&&o[0].focus();return}const i=e.shiftKey,l=e.target===o[0],d=e.target===o[o.length-1];l&&i&&(e.preventDefault(),o[o.length-1].focus()),d&&!i&&(e.preventDefault(),o[0].focus())}},ht={beforeMount(e){e[Ae]=We(e),ce.push(e),ce.length<=1&&document.addEventListener("keydown",to)},updated(e){fe(()=>{e[Ae]=We(e)})},unmounted(){ce.shift(),ce.length===0&&document.removeEventListener("keydown",to)}},bt=X({name:"ElMessageBox",directives:{TrapFocus:ht},components:{ElButton:Be,ElFocusTrap:ro,ElInput:Ve,ElOverlay:lo,ElIcon:ge,...Yo},inheritAttrs:!1,props:{buttonSize:{type:String,validator:mn},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:o}){const{locale:i,zIndex:l,ns:d,size:a}=jo("message-box",B(()=>e.buttonSize)),{t:u}=i,{nextZIndex:v}=l,h=O(!1),t=ye({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:Re(Xe),cancelButtonLoadingIcon:Re(Xe),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:v()}),s=B(()=>{const c=t.type;return{[d.bm("icon",c)]:c&&Ze[c]}}),b=Se(),A=Se(),r=B(()=>{const c=t.type;return t.icon||c&&Ze[c]||""}),_=B(()=>!!t.message),C=O(),T=O(),P=O(),N=O(),M=O(),F=B(()=>t.confirmButtonClass);ke(()=>t.inputValue,async c=>{await fe(),e.boxType==="prompt"&&c&&I()},{immediate:!0}),ke(()=>h.value,c=>{var S,k;c&&(e.boxType!=="prompt"&&(t.autofocus?P.value=(k=(S=M.value)==null?void 0:S.$el)!=null?k:C.value:P.value=C.value),t.zIndex=v()),e.boxType==="prompt"&&(c?fe().then(()=>{var Q;N.value&&N.value.$el&&(t.autofocus?P.value=(Q=K())!=null?Q:C.value:P.value=C.value)}):(t.editorErrorMessage="",t.validateError=!1))});const z=B(()=>e.draggable),V=B(()=>e.overflow);qo(C,T,z,V),De(async()=>{await fe(),e.closeOnHashChange&&window.addEventListener("hashchange",H)}),ze(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",H)});function H(){h.value&&(h.value=!1,fe(()=>{t.action&&o("action",t.action)}))}const $=()=>{e.closeOnClickModal&&E(t.distinguishCancelAndClose?"close":"cancel")},n=Xo($),g=c=>{if(t.inputType!=="textarea")return c.preventDefault(),E("confirm")},E=c=>{var S;e.boxType==="prompt"&&c==="confirm"&&!I()||(t.action=c,t.beforeClose?(S=t.beforeClose)==null||S.call(t,c,t,H):H())},I=()=>{if(e.boxType==="prompt"){const c=t.inputPattern;if(c&&!c.test(t.inputValue||""))return t.editorErrorMessage=t.inputErrorMessage||u("el.messagebox.error"),t.validateError=!0,!1;const S=t.inputValidator;if(Fe(S)){const k=S(t.inputValue);if(k===!1)return t.editorErrorMessage=t.inputErrorMessage||u("el.messagebox.error"),t.validateError=!0,!1;if(Ke(k))return t.editorErrorMessage=k,t.validateError=!0,!1}}return t.editorErrorMessage="",t.validateError=!1,!0},K=()=>{var c,S;const k=(c=N.value)==null?void 0:c.$refs;return(S=k==null?void 0:k.input)!=null?S:k==null?void 0:k.textarea},ae=()=>{E("close")},Z=()=>{e.closeOnPressEscape&&ae()};return e.lockScroll&&Wo(h),{...Zo(t),ns:d,overlayEvent:n,visible:h,hasMessage:_,typeClass:s,contentId:b,inputId:A,btnSize:a,iconComponent:r,confirmButtonClasses:F,rootRef:C,focusStartRef:P,headerRef:T,inputRef:N,confirmRef:M,doClose:H,handleClose:ae,onCloseRequested:Z,handleWrapperClick:$,handleInputEnter:g,handleAction:E,t:u}}});function yt(e,o,i,l,d,a){const u=R("el-icon"),v=R("el-input"),h=R("el-button"),t=R("el-focus-trap"),s=R("el-overlay");return w(),G(Ne,{name:"fade-in-linear",onAfterLeave:b=>e.$emit("vanish"),persisted:""},{default:m(()=>[ne(f(s,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:m(()=>[y("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:L(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[f(t,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:m(()=>[y("div",{ref:"rootRef",class:L([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:Le(e.customStyle),tabindex:"-1",onClick:ie(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(w(),D("div",{key:0,ref:"headerRef",class:L([e.ns.e("header"),{"show-close":e.showClose}])},[y("div",{class:L(e.ns.e("title"))},[e.iconComponent&&e.center?(w(),G(u,{key:0,class:L([e.ns.e("status"),e.typeClass])},{default:m(()=>[(w(),G(pe(e.iconComponent)))]),_:1},8,["class"])):J("v-if",!0),y("span",null,U(e.title),1)],2),e.showClose?(w(),D("button",{key:0,type:"button",class:L(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:b=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:$e(ie(b=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[f(u,{class:L(e.ns.e("close"))},{default:m(()=>[(w(),G(pe(e.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):J("v-if",!0)],2)):J("v-if",!0),y("div",{id:e.contentId,class:L(e.ns.e("content"))},[y("div",{class:L(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(w(),G(u,{key:0,class:L([e.ns.e("status"),e.typeClass])},{default:m(()=>[(w(),G(pe(e.iconComponent)))]),_:1},8,["class"])):J("v-if",!0),e.hasMessage?(w(),D("div",{key:1,class:L(e.ns.e("message"))},[j(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(w(),G(pe(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(w(),G(pe(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:m(()=>[oe(U(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):J("v-if",!0)],2),ne(y("div",{class:L(e.ns.e("input"))},[f(v,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":b=>e.inputValue=b,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:L({invalid:e.validateError}),onKeydown:$e(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),y("div",{class:L(e.ns.e("errormsg")),style:Le({visibility:e.editorErrorMessage?"visible":"hidden"})},U(e.editorErrorMessage),7)],2),[[Ie,e.showInput]])],10,["id"]),y("div",{class:L(e.ns.e("btns"))},[e.showCancelButton?(w(),G(h,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:L([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:b=>e.handleAction("cancel"),onKeydown:$e(ie(b=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:m(()=>[oe(U(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):J("v-if",!0),ne(f(h,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:L([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:b=>e.handleAction("confirm"),onKeydown:$e(ie(b=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:m(()=>[oe(U(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Ie,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Ie,e.visible]])]),_:3},8,["onAfterLeave"])}var wt=se(bt,[["render",yt],["__file","index.vue"]]);const Ce=new Map,Ct=e=>{let o=document.body;return e.appendTo&&(Ke(e.appendTo)&&(o=document.querySelector(e.appendTo)),xe(e.appendTo)&&(o=e.appendTo),xe(o)||(o=document.body)),o},Et=(e,o,i=null)=>{const l=f(wt,e,Fe(e.message)||go(e.message)?{default:Fe(e.message)?e.message:()=>e.message}:null);return l.appContext=i,_o(l,o),Ct(e).appendChild(o.firstElementChild),l.component},$t=()=>document.createElement("div"),It=(e,o)=>{const i=$t();e.onVanish=()=>{_o(null,i),Ce.delete(d)},e.onAction=a=>{const u=Ce.get(d);let v;e.showInput?v={value:d.inputValue,action:a}:v=a,e.callback?e.callback(v,l.proxy):a==="cancel"||a==="close"?e.distinguishCancelAndClose&&a!=="cancel"?u.reject("close"):u.reject("cancel"):u.resolve(v)};const l=Et(e,i,o),d=l.proxy;for(const a in e)Qe(e,a)&&!Qe(d.$props,a)&&(a==="closeIcon"&&ho(e[a])?d[a]=Re(e[a]):d[a]=e[a]);return d.visible=!0,d};function _e(e,o=null){if(!Qo)return Promise.reject();let i;return Ke(e)||go(e)?e={message:e}:i=e.callback,new Promise((l,d)=>{const a=It(e,o??_e._context);Ce.set(a,{options:e,callback:i,resolve:l,reject:d})})}const kt=["alert","confirm","prompt"],St={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};kt.forEach(e=>{_e[e]=Tt(e)});function Tt(e){return(o,i,l,d)=>{let a="";return ho(i)?(l=i,a=""):xo(i)?a="":a=i,_e(Object.assign({title:a,message:o,type:"",...St[e]},l,{boxType:e}),d)}}_e.close=()=>{Ce.forEach((e,o)=>{o.doClose()}),Ce.clear()};_e._context=null;const re=_e;re.install=e=>{re._context=e._context,e.config.globalProperties.$msgbox=re,e.config.globalProperties.$messageBox=re,e.config.globalProperties.$alert=re.alert,e.config.globalProperties.$confirm=re.confirm,e.config.globalProperties.$prompt=re.prompt};const To=re,Bt={class:"p-5 w-[596px]"},Mt={class:"flex items-center justify-between"},Lt={class:"text-lg text-primary"},Rt={class:"h-[300px] overflow-y-auto mt-5"},Ft={class:"grid grid-cols-2 gap-4"},Ot=["onClick"],At={class:"flex-1 overflow-hidden"},Nt={class:"text-base font-medium text-primary mb-1"},Pt={class:"text-sm text-secondary truncate"},Dt=X({__name:"agent-tooltip",emits:["select"],setup(e,{emit:o}){const i=o,l=en(),d=O(),a=ye({keyword:"",group_id:0}),u=B(()=>{if(a.keyword){const t=a.keyword.toLowerCase().trim();return l.agentList.filter(s=>{const b=s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t);return(a.group_id===0||s.group_id===a.group_id)&&b})}else return a.group_id===0?l.agentList:l.agentList.filter(t=>t.group_id===a.group_id)}),v=()=>{d.value.hide()},h=t=>{i("select",t),v()};return(t,s)=>{const b=ge,A=Ve,r=hn,_=_n,C=vn,T=fn,P=po,N=we("tooltip");return w(),G(P,{ref_key:"tooltipRef",ref:d,effect:"light",trigger:"click","popper-class":"el-popper--plain",placement:"top-start"},{content:m(()=>[y("div",Bt,[y("div",Mt,[y("h4",Lt,U(t.$t("action.find"))+U(t.$t("module.agent")),1),ne((w(),D("div",{class:"size-5 flex-center rounded cursor-pointer hover:bg-[#E1E2E3]",onClick:v},[f(b,null,{default:m(()=>[f(p(Pe))]),_:1})])),[[N,{content:t.$t("action.close")}]])]),f(A,{size:"large",modelValue:a.keyword,"onUpdate:modelValue":s[0]||(s[0]=M=>a.keyword=M),placeholder:t.$t("action.search")+t.$t("module.agent"),"prefix-icon":p(on),class:"mt-4 el-input--main"},null,8,["modelValue","placeholder","prefix-icon"]),f(_,{class:"index-tabs mt-4",modelValue:a.group_id,"onUpdate:modelValue":s[1]||(s[1]=M=>a.group_id=M)},{default:m(()=>[(w(!0),D(ve,null,Oe(p(l).categorys,M=>(w(),G(r,{key:M.group_id,label:M.group_name,name:M.group_id},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),y("div",Rt,[y("div",Ft,[(w(!0),D(ve,null,Oe(u.value,(M,F)=>(w(),D("div",{key:F,class:"flex items-center p-3 bg-[#F8F9FA] rounded-lg cursor-pointer",onClick:z=>h(M)},[f(C,{size:36,src:M.logo,class:"mr-2"},null,8,["src"]),y("div",At,[y("h3",Nt,U(M.name),1),y("p",Pt,U(M.description||"- -"),1)])],8,Ot))),128))]),u.value.length===0?(w(),G(T,{key:0,description:t.$t("common.no_data"),"image-size":100,image:t.$getPublicPath("/images/chat/completion_empty.png")},null,8,["description","image"])):J("",!0)])])]),default:m(()=>[j(t.$slots,"default")]),_:3},512)}}}),zt={class:"flex flex-col gap-2 mt-4"},Vt=["onClick"],Kt={class:"flex items-center gap-2"},Ut={class:"flex-1 text-sm text-primary truncate"},Ht={class:"size-7 flex-center cursor-pointer invisible group-hover:visible"},Gt={class:"text-[#FA5151] flex-center"},Jt={class:"mt-2 text-xs text-secondary"},Yt=X({__name:"history",emits:["new"],setup(e,{expose:o,emit:i}){const l=i,d=bo(),a=B(()=>d.currentConversation),u=O(!1),v=ye({editVisible:!1}),h=ye({conversation_id:0,title:""}),t=()=>{l("new"),u.value=!1},s=async()=>{await d.editConversation(h),v.editVisible=!1},b=async r=>{await To.confirm(window.$t("chat.conversation_confirm_delete"),window.$t("action.del"),{confirmButtonText:window.$t("action.del"),cancelButtonText:window.$t("action.cancel"),type:"warning"}),d.delConversation(r)},A=(r,_)=>{r==="del"?b(_):r==="edit"&&(h.conversation_id=_.conversation_id,h.title=_.title,v.editVisible=!0)};return o({open(){u.value=!0}}),(r,_)=>{const C=Be,T=R("svg-icon"),P=gt,N=_t,M=vt,F=In,z=Ve,V=nn,H=we("trim"),$=we("debounce");return w(),D(ve,null,[f(F,{modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=n=>u.value=n),title:r.$t("chat.history"),size:"300px"},{default:m(()=>[f(C,{class:"w-full border-none -mt-8",type:"primary",size:"large",plain:"",onClick:t},{default:m(()=>[oe(" + "+U(r.$t("chat.new_conversation")),1)]),_:1}),y("div",zt,[(w(!0),D(ve,null,Oe(p(d).conversations,n=>(w(),D("div",{key:n.conversation_id,class:L(["group p-3 rounded cursor-pointer hover:bg-[#F5F6FA]",[a.value.conversation_id===n.conversation_id?"bg-[#F5F6FA]":""]]),onClick:g=>p(d).setCurrentState(n.agent_id,n.conversation_id)},[y("div",Kt,[y("div",Ut,U(n.title),1),f(M,{onCommand:g=>A(g,n)},{dropdown:m(()=>[f(N,null,{default:m(()=>[f(P,{command:"edit"},{default:m(()=>[f(T,{name:"edit",class:"mr-1"}),oe(" "+U(r.$t("action.rename")),1)]),_:1}),f(P,{command:"del"},{default:m(()=>[y("span",Gt,[f(T,{name:"del",class:"mr-1"}),oe(" "+U(r.$t("action.del")),1)])]),_:1})]),_:1})]),default:m(()=>[y("div",Ht,[f(T,{name:"more-h"})])]),_:2},1032,["onCommand"])]),y("div",Jt,U(n.created_at),1)],10,Vt))),128))])]),_:1},8,["modelValue","title"]),f(V,{modelValue:v.editVisible,"onUpdate:modelValue":_[3]||(_[3]=n=>v.editVisible=n),title:r.$t("chat.edit_conversation"),width:"480"},{footer:m(()=>[f(C,{onClick:_[2]||(_[2]=n=>v.editVisible=!1)},{default:m(()=>[oe(U(r.$t("action.cancel")),1)]),_:1}),ne((w(),G(C,{type:"primary",disabled:!h.title.trim(),onClick:s},{default:m(()=>[oe(U(r.$t("action.confirm")),1)]),_:1},8,["disabled"])),[[$]])]),default:m(()=>[ne(f(z,{size:"large",modelValue:h.title,"onUpdate:modelValue":_[1]||(_[1]=n=>h.title=n),placeholder:r.$t("form.input_placeholder"),maxlength:20,"show-word-limit":""},null,8,["modelValue","placeholder"]),[[H]])]),_:1},8,["modelValue","title"])],64)}}}),jt={completions(e,o){return tn.post("/v1/chat/completions",e,o)}},qt={class:"h-full flex bg-white relative overflow-hidden"},Wt={class:"flex-1 flex flex-col"},Xt=["title"],Zt={class:"flex items-center gap-1 text-sm text-secondary"},Qt={class:"size-4"},xt={class:"h-6 px-1 rounded flex-center cursor-pointer hover:bg-[#E1E2E3]"},es={class:"h-6 px-1 rounded flex-center cursor-pointer hover:bg-[#E1E2E3]"},os=["onClick"];const ns={class:"w-4/5 max-w-[800px] mx-auto py-5"},ts={class:"flex gap-2 mb-2.5"},ss={class:"h-8 px-2 rounded-full flex-center gap-1.5 bg-[#F1F2F3] cursor-pointer hover:bg-[#E1E2E3]"},as=["src"],ls={class:"text-sm text-primary"},rs={class:"size-4 flex-center"},is={class:"size-4"},cs={class:"size-4"},ds={key:0,class:"w-2/5 border-l bg-white"},us={class:"h-16 flex-center border-b relative"},ps={class:"text-lg text-primary"},fs=X({__name:"index",setup(e){const o=an(()=>ln(()=>import("./helper-kdzOkexP.js"),__vite__mapDeps([0,1,2,3,4]))),i=bo(),l=O(),d=O(null),a=B(()=>i.currentAgent),u=B(()=>i.currentConversation),v=B(()=>i.currentAgent.custom_config_obj),h=B(()=>{var n,g,E,I;return!!((g=(n=v.value)==null?void 0:n.file_parse)!=null&&g.enable||(I=(E=v.value)==null?void 0:E.image_parse)!=null&&I.enable)}),t=B(()=>{var g,E,I,K;let n="";return(E=(g=v.value)==null?void 0:g.file_parse)!=null&&E.enable&&(n+=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.csv,.txt,.html,.json,.xml,.md"),(K=(I=v.value)==null?void 0:I.image_parse)!=null&&K.enable&&(n+=",image/*"),n}),s=ye({offset:0,limit:10,showHelper:!1,messageList:[],isStreaming:!1,isLoadingMore:!1,hasMore:!0}),b=()=>{var n;(n=l.value)==null||n.open()},A=()=>{s.showHelper=!s.showHelper},r=n=>{i.pushUsualAgent(n),i.setCurrentState(n.agent_id,0)},_=()=>{i.setCurrentState(a.value.agent_id,0)},C=async n=>{try{const g=await gn.upload(n);return{id:g.data.id,url:`${rn}/api/preview/${g.data.preview_key||""}`,size:g.data.size,name:g.data.file_name,mime_type:g.data.mime_type}}catch{return{}}},T=(n,g)=>{var Z,c,S,k,Q,Y,x;const E=s.messageList[s.messageList.length-1];if(!((Z=n.event)!=null&&Z.target))return g;const I=n.event.target.response||"",K=I.substring(g),ae=I.length;try{const de=K.split(`
`).filter(ue=>ue.trim()!==""&&ue.trim()!=="data: [DONE]");for(const ue of de)if(ue.startsWith("data: "))try{const le=JSON.parse(ue.slice(6)),Je=(k=(S=(c=le.choices)==null?void 0:c[0])==null?void 0:S.delta)==null?void 0:k.content,Ye=(x=(Y=(Q=le.choices)==null?void 0:Q[0])==null?void 0:Y.delta)==null?void 0:x.reasoning_content;Je&&(E.answer+=Je),Ye&&(E.reasoning_content+=Ye)}catch(le){console.error("解析JSON失败:",le)}}catch(de){console.error("处理流数据失败:",de)}return ae},P={formatMessage:n=>{var I;const g={...n,query:""},E=JSON.parse(n.message)[0].content;try{const K=JSON.parse(E),ae=(I=K.find(Z=>Z.type==="text"))==null?void 0:I.content;g.query=ae,g.user_files=K.filter(Z=>Z.type==="image")}catch{g.query=E}return g},formatFiles:n=>(n==null?void 0:n.map(g=>({type:"image",content:`file_id:${g.id}`,filename:g.name,size:g.size,mime_type:g.mime_type,url:g.url})))||[],createNewMessage:(n,g,E,I)=>({query:n,answer:"",loading:!0,agent_id:g,conversation_id:E,reasoning_content:"",reasoning_expanded:!0,user_files:I})},N=async(n,g,E)=>{try{const K=(await bn.messasges(n,{offset:g,limit:E})).data.messages.map(P.formatMessage);return{messages:K,hasMore:K.length===E}}catch(I){return console.error("加载消息失败:",I),{messages:[],hasMore:!1}}},M=async n=>{if(s.isLoadingMore||!s.hasMore)return n();const g=u.value.conversation_id;if(g){s.isLoadingMore=!0,s.offset+=s.limit;try{const{messages:E,hasMore:I}=await N(g,s.offset,s.limit);s.hasMore=I,s.messageList.unshift(...E)}catch{s.offset=Math.max(0,s.offset-s.limit)}finally{s.isLoadingMore=!1,n()}}},F=async()=>{const n=u.value.conversation_id;if(n){s.isLoadingMore=!0,s.offset=0,s.hasMore=!0;try{const{messages:g,hasMore:E}=await N(n,s.offset,s.limit);s.hasMore=E,s.messageList=g}finally{s.isLoadingMore=!1}}},z=async(n,g)=>{if(s.isStreaming)return;const E=a.value.agent_id,I=u.value.conversation_id,K=P.createNewMessage(n,E,I,g);s.messageList.push(K);const Z=JSON.parse(a.value.configs||"{}").completion_params||{};s.isStreaming=!0,d.value=new AbortController;let c=0,S=n;g.length>0&&(S=JSON.stringify([{type:"text",content:n},...g]));try{await jt.completions({conversation_id:I,model:"agent-"+E,messages:[{content:S,role:"user"}],frequency_penalty:0,presence_penalty:0,stream:!0,temperature:0,top_p:0,...Z},{responseType:"stream",onDownloadProgress:k=>{c=T(k,c)},signal:d.value.signal})}catch(k){const Q=k.message||"",Y=k.response||{};let x=Y.data||"{}";try{x=JSON.parse(Y.data)}catch{x={}}const{error:{message:de="",type:ue=""}={}}=x;if(Q!=="canceled"){const le=s.messageList[s.messageList.length-1];/Permission denied at app_id/.test(de)?(s.messageList.pop(),To.confirm(window.$t("response_message.model_changed"),window.$t("status.warning"),{type:"warning"}).then(()=>{_()})):le&&!le.answer&&(le.answer=k.response.data||window.$t("response_code.network_error"),console.error(k))}}finally{const k=s.messageList[s.messageList.length-1];k&&(k.loading=!1),s.isStreaming=!1,d.value=null}},V=async(n,g)=>{const E=a.value.agent_id;if(!E)return cn.warning(window.$t("chat.no_available_agent"));if(!u.value.conversation_id)try{const I=await i.createConversation(E,n);i.addConversation({...I,virtual_id:u.value.virtual_id}),i.setCurrentState(I.agent_id,I.conversation_id)}catch(I){console.error("创建对话失败:",I);return}await z(n,P.formatFiles(g))},H=()=>{d.value&&(d.value.abort(),d.value=null),s.isStreaming=!1},$=async n=>{await z(n.query,n.user_files)};return De(()=>{F()}),(n,g)=>{const E=R("svg-icon"),I=R("router-link"),K=ge,ae=R("x-bubble-user"),Z=R("x-bubble-assistant"),c=R("x-bubble-list"),S=R("x-sender"),k=we("tooltip"),Q=we("copy");return w(),D(ve,null,[y("div",qt,[y("div",Wt,[f(un,null,{before_suffix:m(()=>[y("div",{class:"text-base text-primary line-clamp-1",title:u.value.title||a.value.name||""},U(u.value.title||a.value.name||""),9,Xt)]),after_prefix:m(()=>[y("div",Zt,[f(E,{name:"index"}),f(I,{to:{name:"Home"}},{default:m(()=>[oe(U(n.$t("common.back_home")),1)]),_:1})]),g[0]||(g[0]=y("div",{class:"border-r w-px h-3 mx-2"},null,-1))]),after_suffix:m(()=>[ne((w(),D("div",{class:"h-[26px] px-2 rounded-full flex-center gap-1.5 text-sm text-primary cursor-pointer hover:bg-[#E1E2E3]",onClick:A},[y("div",Qt,[f(E,{name:"layout-split",size:"18"})])])),[[k,{content:n.$t("chat.usage_guide")}]])]),_:1}),f(c,{class:"flex-1 mt-5",autoScroll:!0,messages:s.messageList,mainClass:"w-4/5 max-w-[800px] mx-auto",enablePullUp:"",onPullUp:M},{item:m(({message:Y,index:x})=>[f(ae,{content:Y.query,files:Y.user_files},{menu:m(()=>[ne((w(),D("div",xt,[f(K,{color:"#9B9B9B"},{default:m(()=>[f(p(eo))]),_:1})])),[[k,{content:n.$t("action.copy")}],[Q,Y.query]])]),_:2},1032,["content","files"]),f(Z,{content:Y.answer,reasoning:Y.reasoning_content,"reasoning-expanded":Y.reasoning_expanded,streaming:Y.loading,alwaysShowMenu:x===s.messageList.length-1},co({_:2},[Y.loading?void 0:{name:"menu",fn:m(()=>[ne((w(),D("div",es,[f(K,{color:"#9B9B9B"},{default:m(()=>[f(p(eo))]),_:1})])),[[k,{content:n.$t("action.copy")}],[Q,Y.answer]]),ne((w(),D("div",{class:"h-6 px-1 rounded flex-center cursor-pointer hover:bg-[#E1E2E3]",onClick:de=>$(Y)},[f(K,{color:"#9B9B9B"},{default:m(()=>[f(p(sn))]),_:1})],8,os)),[[k,{content:n.$t("chat.regenerate")}]]),J("",!0),J("",!0)]),key:"0"}]),1032,["content","reasoning","reasoning-expanded","streaming","alwaysShowMenu"])]),_:1},8,["messages"]),y("div",ns,[y("div",ts,[f(Dt,{onSelect:r},{default:m(()=>[y("div",ss,[y("img",{class:"size-4 rounded-full",src:a.value.logo,alt:""},null,8,as),y("span",ls,U(a.value.name),1),y("div",rs,[f(K,{color:"#333333"},{default:m(()=>[f(p(uo))]),_:1})])])]),_:1}),J("",!0),g[1]||(g[1]=y("div",{class:"flex-1"},null,-1)),y("div",{class:"h-8 px-2 rounded-full flex-center gap-1.5 bg-[#F1F2F3] text-sm text-primary cursor-pointer hover:bg-[#E1E2E3]",onClick:b},[y("div",is,[f(E,{name:"history"})]),oe(" "+U(n.$t("chat.history")),1)]),y("div",{class:"h-8 px-2 rounded-full flex-center gap-1.5 bg-[#F1F2F3] text-sm text-primary cursor-pointer hover:bg-[#E1E2E3]",onClick:_},[y("div",cs,[f(E,{name:"plus"})]),oe(" "+U(n.$t("chat.new_conversation")),1)])]),f(S,{"http-request":C,"enable-upload":h.value,"accept-types":t.value,loading:s.isStreaming,onSend:V,onStop:H},null,8,["enable-upload","accept-types","loading"])])]),f(Ne,{name:"slide"},{default:m(()=>[s.showHelper?(w(),D("div",ds,[y("div",us,[y("h4",ps,U(n.$t("chat.usage_guide")),1),y("div",{class:"flex-center size-6 absolute right-2 top-1/2 -translate-y-1/2 rounded cursor-pointer hover:bg-[#ECEDEE]",onClick:A},[f(K,null,{default:m(()=>[f(p(Pe))]),_:1})])]),f(p(o),{agent:a.value},null,8,["agent"])])):J("",!0)]),_:1})]),f(Yt,{ref_key:"historyRef",ref:l,onNew:_},null,512)],64)}}}),Ts=dn(fs,[["__scopeId","data-v-825225f9"]]);export{Ts as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/helper-kdzOkexP.js","assets/main-aAIm056l.js","assets/main-CnS8BFte.css","assets/el-empty-D6EjX5es.js","assets/el-empty-BgB1A-Jc.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
