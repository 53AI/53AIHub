import{ai as P,aj as L,N as X,af as Z,B as ee,C as oe,r as z,E as te,G as se,o as ae,k as le,m as re,b as i,c as d,p as F,e as k,d as a,h as E,F as f,t as c,f as l,w as p,J as y,u as x,W as j,Y as ne,$ as M,L as ie,K as de,ad as pe,a0 as $,a8 as ce,a9 as ue,a1 as me,s as N,I as _e,a5 as R,b0 as ge,A as fe}from"./main-BBgPs3nN.js";import{_ as ve,E as he}from"./el-empty-D1WTDJPJ.js";import{b as we,E as ye,a as xe}from"./el-dropdown-item-BbQgf2kh.js";/* empty css                  */import{E as be,a as ke}from"./el-tab-pane-BXYRrgBt.js";const U={async list(){return P.get("/api/prompts",{params:{limit:1e3}}).catch(L)},async approve({prompt_id:m}){return P.patch(`/api/prompts/${m}/like`).catch(L)},async detail({prompt_id:m}){return P.get(`/api/prompts/${m}`).catch(L)}},Ee=5,$e=X("prompt-store",{state:()=>({categorys:[],promptList:[]}),actions:{async loadPromptList(){try{const m=await U.list();return this.promptList=m.data.prompts.map(v=>{try{v.custom_config_obj=v.custom_config?JSON.parse(v.custom_config):{}}catch{v.custom_config_obj={}}return v}),this.promptList}catch{return[]}},async loadCategorys(){const m=await Z.list(Ee);this.categorys=[{group_id:0,group_name:window.$t("common.all")}].concat(m.data)}}}),Ce={key:0,class:"text-sm md:text-base mt-3 line-clamp-2 text-regular"},Pe={class:"text-xl md:text-2xl font-bold",style:{color:"var(--el-text-color-primary, #1d1e1f)"}},Le={class:"text-sm md:text-base mt-3 line-clamp-2 text-regular"},Fe={key:1,class:"flex md:flex-row flex-col-reverse gap-5 items-stretch md:items-center justify-between"},Se={class:"flex-1 md:w-0 flex items-center gap-2"},Ve={class:"flex items-center gap-1 text-regular"},De={class:"w-full md:w-auto flex-none flex md:flex-row-reverse items-center gap-2"},Ie={class:"flex items-center gap-1 text-regular"},Be=["name"],Te={key:1,class:"col-span-full flex flex-col items-center justify-center"},ze={class:"flex-1 overflow-hidden"},je={class:"w-full flex items-center justify-between gap-4"},Me=["title","innerHTML"],Ne=["title"],Re=["title","textContent"],Ue={class:"mt-3 flex items-center justify-end gap-3 text-xs text-regular"},Ae=["onClick"],He={class:"flex items-center gap-1"},Oe=ee({__name:"view",props:{mode:{default:"default"},hideFilter:{type:Boolean},singleRow:{type:Boolean},defaultSort:{default:"default_sort"},showLimit:{},excludeIds:{default:()=>[]},transition:{type:Boolean,default:!0},mainClass:{}},setup(m,{expose:v}){const _=m,A=ce(),b=$e(),H=oe(),O=z(!1),S=[{label:"prompt.default_sort",value:"default_sort"},{label:"prompt.likes_sort",value:"likes_sort"},{label:"prompt.views_sort",value:"views_sort"}],t=te({keyword:"",group_id:0}),C=se(()=>{const e=t.keyword.toLowerCase().trim(),s=b.categorys;let r=b.promptList.map((n={})=>{n.group_ids=n.group_ids||[];const u=s.filter((h={})=>+h.group_id&&n.group_ids.includes(h.group_id));return n.group_names=u.map((h={})=>h.group_name),n});return w.value==="likes_sort"?r=r.sort((n,u)=>u.likes-n.likes):w.value==="views_sort"&&(r=r.sort((n,u)=>u.views-n.views)),t.keyword?r=r.filter(n=>{const u=n.name.toLowerCase().includes(e);return(t.group_id===0||+t.group_id&&n.group_ids.includes(t.group_id))&&u}):(r=t.group_id===0?r:r.filter(n=>+t.group_id&&n.group_ids.includes(t.group_id)),_.mode==="index"&&(r=r.slice(0,_.showLimit||6))),_.showLimit&&(r=r.slice(0,_.showLimit)),_.excludeIds.length&&(r=r.filter(n=>!_.excludeIds.includes(n.prompt_id))),r}),w=z(_.defaultSort),V=e=>{w.value=e},J=e=>{t.group_id=e},K=async(e,s)=>{e.preventDefault(),e.stopPropagation(),await U.approve({prompt_id:s.prompt_id}),s.is_liked=!s.is_liked,s.likes=s.is_liked?s.likes+1:s.likes-1,R.success(window.$t(s.is_liked?"status.approve_success":"status.approve_cancel"))},Y=async(e,s)=>{e.preventDefault(),e.stopPropagation(),await ge(s.content),R.success(window.$t("common.copied"))};return ae(()=>{b.loadCategorys(),b.loadPromptList()}),v({search:e=>{t.keyword=e},sort:e=>{w.value=e}}),(e,s)=>{const r=ke,n=be,u=j("SvgIcon"),h=ne,D=xe,I=ye,B=we,G=ie,W=pe,q=he,Q=me,T=j("router-link");return le((i(),d("div",{class:F(["w-11/12 lg:w-4/5 mx-auto py-6 md:py-8 lg:py-10 box-border",e.mainClass])},[e.mode==="index"?(i(),d(f,{key:0},[t.keyword?(i(),d("p",Ce,c(e.$t("module.prompt")),1)):(i(),d(f,{key:1},[a("h2",Pe,c(e.$t("index.prompt_recommend")),1),a("p",Le,c(e.$t("index.prompt_recommend_desc")),1)],64))],64)):k("",!0),e.hideFilter?k("",!0):(i(),d("div",Fe,[a("div",Se,[l(n,{class:"w-full index-tabs md:mb-0 overflow-hidden",modelValue:t.group_id,"onUpdate:modelValue":s[0]||(s[0]=o=>t.group_id=o),onTabChange:J},{default:p(()=>[(i(!0),d(f,null,y(x(b).categorys,o=>(i(),E(r,{key:o.group_id,label:o.group_name,name:o.group_id},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),l(B,{class:"flex-none md:!hidden",onCommand:V},{dropdown:p(()=>[l(I,null,{default:p(()=>[(i(),d(f,null,y(S,o=>l(D,{key:o.value,command:o.value},{default:p(()=>[$(c(e.$t(o.label)),1)]),_:2},1032,["command"])),64))]),_:1})]),default:p(()=>[a("div",Ve,[l(u,{name:"sort",stroke:""}),a("span",null,c(e.$t(`prompt.${w.value}`)),1),l(h,{size:14,color:"#aaa"},{default:p(()=>[l(x(M))]),_:1})])]),_:1})]),a("div",De,[l(ve,{class:"flex-none hidden md:flex",modelValue:t.keyword,"onUpdate:modelValue":s[1]||(s[1]=o=>t.keyword=o),placeholder:e.$t("action.search")+e.$t("module.prompt")},null,8,["modelValue","placeholder"]),l(G,{modelValue:t.keyword,"onUpdate:modelValue":s[2]||(s[2]=o=>t.keyword=o),size:"large",class:"w-full md:hidden el-input--main",placeholder:e.$t("action.search")+e.$t("module.prompt"),"prefix-icon":x(de)},null,8,["modelValue","placeholder","prefix-icon"]),l(W,{class:"flex-none !mx-0 !hidden md:!block",direction:"vertical"}),l(B,{class:"flex-none !hidden md:!block",onCommand:V},{dropdown:p(()=>[l(I,null,{default:p(()=>[(i(),d(f,null,y(S,o=>l(D,{key:o.value,command:o.value},{default:p(()=>[$(c(e.$t(o.label)),1)]),_:2},1032,["command"])),64))]),_:1})]),default:p(()=>[a("div",Ie,[l(u,{name:"sort",stroke:""}),a("span",null,c(e.$t(`prompt.${w.value}`)),1),l(h,{size:14,color:"#aaa"},{default:p(()=>[l(x(M))]),_:1})])]),_:1})])])),a("div",{name:e.transition?"list":"",tag:"div",class:F(["grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-5 mt-5 md:mt-8",[e.singleRow?"!mt-0 !grid-cols-1":""]])},[O.value?(i(),d(f,{key:0},y(6,o=>a("div",{key:o,class:"flex items-start p-4 bg-[#FFF8FF] rounded-lg animate-pulse"},s[3]||(s[3]=[ue('<div class="w-[70px] h-[70px] bg-gray-200 rounded-full mr-4" data-v-96859e8b></div><div class="flex-1" data-v-96859e8b><div class="h-5 bg-gray-200 rounded w-3/4 mb-2" data-v-96859e8b></div><div class="h-4 bg-gray-200 rounded w-full mb-1" data-v-96859e8b></div><div class="h-4 bg-gray-200 rounded w-2/3 mb-4" data-v-96859e8b></div><div class="h-4 bg-gray-200 rounded w-1/3" data-v-96859e8b></div></div>',2)]))),64)):C.value.length===0?(i(),d("div",Te,[l(q,{description:e.$t("common.no_data"),image:e.$getPublicPath("/images/chat/completion_empty.png")},null,8,["description","image"])])):(i(!0),d(f,{key:2},y(C.value,o=>(i(),E(T,{key:o.prompt_id,to:{name:x(A).path.includes("/index")?"HomePromptDetail":"PromptDetail",params:{prompt_id:o.prompt_id}},class:"group flex items-start p-4 min-h-[166px] box-border rounded overflow-hidden bg-cover cursor-pointer border-[#EFF1F3] hover:shadow-md transition-all duration-300",style:_e({backgroundImage:`url(${e.$getPublicPath("/images/index/card_bg_v4.png")})`,backgroundSize:"100% 100%",backgroundPosition:"center center",backgroundRepeat:"no-repeat"})},{default:p(()=>[a("div",ze,[a("div",je,[a("h3",{class:"text-base font-medium line-clamp-1 text-primary",title:o.name,innerHTML:o.name.replace(t.keyword,`<span class='text-theme'>${t.keyword}</span>`)},null,8,Me),(o.group_ids||[]).some(g=>(x(H).info.group_ids||[]).includes(g))?(i(),E(Q,{key:0,size:"small",class:"invisible group-hover:visible !px-2",onClick:N(g=>Y(g,o),["stop"])},{default:p(()=>[$(c(e.$t("action.copy")),1)]),_:2},1032,["onClick"])):k("",!0)]),o.group_names.length>0?(i(),d("div",{key:0,class:"w-full text-sm text-opacity-60 text-regular mt-3 truncate",title:o.group_names.join(" ")},[(i(!0),d(f,null,y(o.group_names,g=>(i(),d("span",{key:g,class:"px-2 py-1 box-border text-xs text-theme bg-[#ECF1FF] rounded-sm mr-2"},c(g),1))),128))],8,Ne)):k("",!0),a("p",{class:"text-sm text-opacity-60 line-clamp-2 text-placeholder mt-2 min-h-[40px]",title:o.description,textContent:c(o.description)},null,8,Re),a("div",Ue,[a("div",{class:"flex items-center gap-1",onClick:N(g=>K(g,o),["stop"])},[l(u,{class:F(["size-[18px]",[o.is_liked?"text-[#F3AB00]":""]]),name:o.is_liked?"approve-filled":"approve"},null,8,["class","name"]),a("span",null,c(o.likes||0),1)],8,Ae),a("div",He,[l(u,{class:"size-[16px]",name:"view"}),a("span",null,c(o.views||0),1)])])])]),_:2},1032,["to","style"]))),128))],10,Be),e.mode==="index"&&!t.keyword?(i(),E(T,{key:2,class:"block w-[240px] h-[40px] leading-[40px] border border-primary box-border text-center text-theme mt-6 rounded-[24px] mx-auto hover-bg-primary-light-9 transition-all duration-300",to:{path:"/index/prompt"}},{default:p(()=>[$(c(e.$t("action.view_more")),1)]),_:1})):k("",!0)],2)),[[re,e.mode!=="index"||!t.keyword||C.value.length]])}}}),qe=fe(Oe,[["__scopeId","data-v-96859e8b"]]);export{qe as P,U as p,$e as u};
